import{r as Rs,g as $s}from"./phaser-DFK5Ua9d.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var Fs=Rs();const B=$s(Fs),ri=!1;var pi=Array.isArray,Hs=Array.prototype.indexOf,vi=Array.from,_r=Object.defineProperty,nn=Object.getOwnPropertyDescriptor,yr=Object.getOwnPropertyDescriptors,Ns=Object.prototype,Bs=Array.prototype,mi=Object.getPrototypeOf,Fi=Object.isExtensible;const Be=()=>{};function Zs(t){return t()}function kn(t){for(var e=0;e<t.length;e++)t[e]()}function br(){var t,e,n=new Promise((i,r)=>{t=i,e=r});return{promise:n,resolve:t,reject:e}}function Gs(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const n=[];for(const i of t)if(n.push(i),n.length===e)break;return n}const me=2,_i=4,Bn=8,Ws=1<<24,dt=16,ut=32,Ot=64,Zn=128,Ye=512,ge=1024,Ae=2048,Qe=4096,Pe=8192,pt=16384,yi=32768,At=65536,Hi=1<<17,wr=1<<18,zt=1<<19,Sr=1<<20,Tt=32768,si=1<<21,bi=1<<22,vt=1<<23,mt=Symbol("$state"),Ys=Symbol(""),Ht=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function xr(t){return t===this.v}function Er(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Ir(t){return!Er(t,this.v)}function Xs(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ks(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function zs(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Us(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function js(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Vs(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function qs(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Js(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Qs(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function ea(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}let gn=!1,ta=!1;function na(){gn=!0}const ia=1,ra=2,sa=16,aa=1,oa=2,be=Symbol(),la="http://www.w3.org/1999/xhtml";let ne=null;function Zt(t){ne=t}function xe(t,e=!1,n){ne={p:ne,i:!1,c:null,e:null,s:t,x:null,l:gn&&!e?{s:null,u:null,$:[]}:null}}function Ee(t){var e=ne,n=e.e;if(n!==null){e.e=null;for(var i of n)zr(i)}return e.i=!0,ne=e.p,{}}function pn(){return!gn||ne!==null&&ne.l===null}let Nt=[];function ca(){var t=Nt;Nt=[],kn(t)}function vn(t){if(Nt.length===0){var e=Nt;queueMicrotask(()=>{e===Nt&&ca()})}Nt.push(t)}function da(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ua(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function je(t){if(typeof t!="object"||t===null||mt in t)return t;const e=mi(t);if(e!==Ns&&e!==Bs)return t;var n=new Map,i=pi(t),r=z(0),s=kt,a=o=>{if(kt===s)return o();var l=W,c=kt;De(null),Wi(s);var u=o();return De(l),Wi(c),u};return i&&n.set("length",z(t.length)),new Proxy(t,{defineProperty(o,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&qs();var u=n.get(l);return u===void 0?u=a(()=>{var h=z(c.value);return n.set(l,h),h}):H(u,c.value,!0),!0},deleteProperty(o,l){var c=n.get(l);if(c===void 0){if(l in o){const u=a(()=>z(be));n.set(l,u),rn(r)}}else H(c,be),rn(r);return!0},get(o,l,c){if(l===mt)return t;var u=n.get(l),h=l in o;if(u===void 0&&(!h||nn(o,l)?.writable)&&(u=a(()=>{var g=je(h?o[l]:be),p=z(g);return p}),n.set(l,u)),u!==void 0){var f=d(u);return f===be?void 0:f}return Reflect.get(o,l,c)},getOwnPropertyDescriptor(o,l){var c=Reflect.getOwnPropertyDescriptor(o,l);if(c&&"value"in c){var u=n.get(l);u&&(c.value=d(u))}else if(c===void 0){var h=n.get(l),f=h?.v;if(h!==void 0&&f!==be)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return c},has(o,l){if(l===mt)return!0;var c=n.get(l),u=c!==void 0&&c.v!==be||Reflect.has(o,l);if(c!==void 0||K!==null&&(!u||nn(o,l)?.writable)){c===void 0&&(c=a(()=>{var f=u?je(o[l]):be,g=z(f);return g}),n.set(l,c));var h=d(c);if(h===be)return!1}return u},set(o,l,c,u){var h=n.get(l),f=l in o;if(i&&l==="length")for(var g=c;g<h.v;g+=1){var p=n.get(g+"");p!==void 0?H(p,be):g in o&&(p=a(()=>z(be)),n.set(g+"",p))}if(h===void 0)(!f||nn(o,l)?.writable)&&(h=a(()=>z(void 0)),H(h,je(c)),n.set(l,h));else{f=h.v!==be;var x=a(()=>je(c));H(h,x)}var _=Reflect.getOwnPropertyDescriptor(o,l);if(_?.set&&_.set.call(u,c),!f){if(i&&typeof l=="string"){var v=n.get("length"),w=Number(l);Number.isInteger(w)&&w>=v.v&&H(v,w+1)}rn(r)}return!0},ownKeys(o){d(r);var l=Reflect.ownKeys(o).filter(h=>{var f=n.get(h);return f===void 0||f.v!==be});for(var[c,u]of n)u.v!==be&&!(c in o)&&l.push(c);return l},setPrototypeOf(){Js()}})}function Ni(t){try{if(t!==null&&typeof t=="object"&&mt in t)return t[mt]}catch{}return t}function ha(t,e){return Object.is(Ni(t),Ni(e))}var Bi,Cr,Dr,kr,Ar;function fa(){if(Bi===void 0){Bi=window,Cr=document,Dr=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;kr=nn(e,"firstChild").get,Ar=nn(e,"nextSibling").get,Fi(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Fi(n)&&(n.__t=void 0)}}function ct(t=""){return document.createTextNode(t)}function An(t){return kr.call(t)}function mn(t){return Ar.call(t)}function M(t,e){return An(t)}function ae(t,e=!1){{var n=An(t);return n instanceof Comment&&n.data===""?mn(n):n}}function T(t,e=1,n=!1){let i=t;for(;e--;)i=mn(i);return i}function ga(t){t.textContent=""}function Tr(){return!1}function Mr(t){var e=K;if(e===null)return W.f|=vt,t;if((e.f&yi)===0){if((e.f&Zn)===0)throw t;e.b.error(t)}else Gt(t,e)}function Gt(t,e){for(;e!==null;){if((e.f&Zn)!==0)try{e.b.error(t);return}catch(n){t=n}e=e.parent}throw t}const bn=new Set;let te=null,He=null,Ue=[],wi=null,ai=!1;class Ve{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#i=0;#n=0;#l=null;#s=[];#r=[];skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){Ue=[],this.apply();var n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const i of e)this.#a(i,n);this.is_fork||this.#d(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects)):(te=null,Zi(n.render_effects),Zi(n.effects),this.#l?.resolve()),He=null}#a(e,n){e.f^=ge;for(var i=e.first;i!==null;){var r=i.f,s=(r&(ut|Ot))!==0,a=s&&(r&ge)!==0,o=a||(r&Pe)!==0||this.skipped_effects.has(i);if((i.f&Zn)!==0&&i.b?.is_pending()&&(n={parent:n,effect:i,effects:[],render_effects:[],block_effects:[]}),!o&&i.fn!==null){s?i.f^=ge:(r&_i)!==0?n.effects.push(i):jt(i)&&((i.f&dt)!==0&&n.block_effects.push(i),Yt(i));var l=i.first;if(l!==null){i=l;continue}}var c=i.parent;for(i=i.next;i===null&&c!==null;)c===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects),n=n.parent),i=c.next,c=c.parent}}#o(e){for(const n of e)((n.f&Ae)!==0?this.#s:this.#r).push(n),this.#c(n.deps),pe(n,ge)}#c(e){if(e!==null)for(const n of e)(n.f&me)===0||(n.f&Tt)===0||(n.f^=Tt,this.#c(n.deps))}capture(e,n){this.previous.has(e)||this.previous.set(e,n),(e.f&vt)===0&&(this.current.set(e,e.v),He?.set(e,e.v))}activate(){te=this,this.apply()}deactivate(){te===this&&(te=null,He=null)}flush(){if(this.activate(),Ue.length>0){if(pa(),te!==null&&te!==this)return}else this.#i===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#d(){if(this.#n===0){for(const e of this.#e)e();this.#e.clear()}this.#i===0&&this.#u()}#u(){if(bn.size>1){this.previous.clear();var e=He,n=!0,i={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of bn){if(s===this){n=!1;continue}const a=[];for(const[l,c]of this.current){if(s.current.has(l))if(n&&c!==s.current.get(l))s.current.set(l,c);else continue;a.push(l)}if(a.length===0)continue;const o=[...s.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var r=Ue;Ue=[];const l=new Set,c=new Map;for(const u of a)Pr(u,o,l,c);if(Ue.length>0){te=s,s.apply();for(const u of Ue)s.#a(u,i);s.deactivate()}Ue=r}}te=null,He=e}this.committed=!0,bn.delete(this)}increment(e){this.#i+=1,e&&(this.#n+=1)}decrement(e){this.#i-=1,e&&(this.#n-=1),this.revive()}revive(){for(const e of this.#s)pe(e,Ae),Mt(e);for(const e of this.#r)pe(e,Qe),Mt(e);this.#s=[],this.#r=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#l??=br()).promise}static ensure(){if(te===null){const e=te=new Ve;bn.add(te),Ve.enqueue(()=>{te===e&&e.flush()})}return te}static enqueue(e){vn(e)}apply(){}}function pa(){var t=yt;ai=!0;var e=null;try{var n=0;for(Mn(!0);Ue.length>0;){var i=Ve.ensure();if(n++>1e3){var r,s;va()}i.process(Ue),_t.clear()}}finally{ai=!1,Mn(t),wi=null}}function va(){try{Vs()}catch(t){Gt(t,wi)}}let rt=null;function Zi(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var i=t[n++];if((i.f&(pt|Pe))===0&&jt(i)&&(rt=new Set,Yt(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null&&i.ac===null?Vr(i):i.fn=null),rt?.size>0)){_t.clear();for(const r of rt){if((r.f&(pt|Pe))!==0)continue;const s=[r];let a=r.parent;for(;a!==null;)rt.has(a)&&(rt.delete(a),s.push(a)),a=a.parent;for(let o=s.length-1;o>=0;o--){const l=s[o];(l.f&(pt|Pe))===0&&Yt(l)}}rt.clear()}}rt=null}}function Pr(t,e,n,i){if(!n.has(t)&&(n.add(t),t.reactions!==null))for(const r of t.reactions){const s=r.f;(s&me)!==0?Pr(r,e,n,i):(s&(bi|dt))!==0&&(s&Ae)===0&&Lr(r,e,i)&&(pe(r,Ae),Mt(r))}}function Lr(t,e,n){const i=n.get(t);if(i!==void 0)return i;if(t.deps!==null)for(const r of t.deps){if(e.includes(r))return!0;if((r.f&me)!==0&&Lr(r,e,n))return n.set(r,!0),!0}return n.set(t,!1),!1}function Mt(t){for(var e=wi=t;e.parent!==null;){e=e.parent;var n=e.f;if(ai&&e===K&&(n&dt)!==0&&(n&wr)===0)return;if((n&(Ot|ut))!==0){if((n&ge)===0)return;e.f^=ge}}Ue.push(e)}function ma(t){let e=0,n=Lt(0),i;return()=>{cn()&&(d(n),Yn(()=>(e===0&&(i=Rt(()=>t(()=>rn(n)))),e+=1,()=>{vn(()=>{e-=1,e===0&&(i?.(),i=void 0,rn(n))})})))}}var _a=At|zt|Zn;function ya(t,e,n){new ba(t,e,n)}class ba{parent;#e=!1;#t;#i=null;#n;#l;#s;#r=null;#a=null;#o=null;#c=null;#d=null;#u=0;#h=0;#g=!1;#f=null;#y=ma(()=>(this.#f=Lt(this.#u),()=>{this.#f=null}));constructor(e,n,i){this.#t=e,this.#n=n,this.#l=i,this.parent=K.b,this.#e=!!this.#n.pending,this.#s=Xn(()=>{K.b=this;{var r=this.#m();try{this.#r=Fe(()=>i(r))}catch(s){this.error(s)}this.#h>0?this.#v():this.#e=!1}return()=>{this.#d?.remove()}},_a)}#b(){try{this.#r=Fe(()=>this.#l(this.#t))}catch(e){this.error(e)}this.#e=!1}#w(){const e=this.#n.pending;e&&(this.#a=Fe(()=>e(this.#t)),Ve.enqueue(()=>{var n=this.#m();this.#r=this.#p(()=>(Ve.ensure(),Fe(()=>this.#l(n)))),this.#h>0?this.#v():(Bt(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#m(){var e=this.#t;return this.#e&&(this.#d=ct(),this.#t.before(this.#d),e=this.#d),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(e){var n=K,i=W,r=ne;Je(this.#s),De(this.#s),Zt(this.#s.ctx);try{return e()}catch(s){return Mr(s),null}finally{Je(n),De(i),Zt(r)}}#v(){const e=this.#n.pending;this.#r!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#d),Qr(this.#r,this.#c)),this.#a===null&&(this.#a=Fe(()=>e(this.#t)))}#_(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#a&&Bt(this.#a,()=>{this.#a=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(e){this.#_(e),this.#u+=e,this.#f&&on(this.#f,this.#u)}get_effect_pending(){return this.#y(),d(this.#f)}error(e){var n=this.#n.onerror;let i=this.#n.failed;if(this.#g||!n&&!i)throw e;this.#r&&(ke(this.#r),this.#r=null),this.#a&&(ke(this.#a),this.#a=null),this.#o&&(ke(this.#o),this.#o=null);var r=!1,s=!1;const a=()=>{if(r){ua();return}r=!0,s&&ea(),Ve.ensure(),this.#u=0,this.#o!==null&&Bt(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#r=this.#p(()=>(this.#g=!1,Fe(()=>this.#l(this.#t)))),this.#h>0?this.#v():this.#e=!1};var o=W;try{De(null),s=!0,n?.(e,a),s=!1}catch(l){Gt(l,this.#s&&this.#s.parent)}finally{De(o)}i&&vn(()=>{this.#o=this.#p(()=>{Ve.ensure(),this.#g=!0;try{return Fe(()=>{i(this.#t,()=>e,()=>a)})}catch(l){return Gt(l,this.#s.parent),null}finally{this.#g=!1}})})}}function Wt(t,e){return e}function wa(t,e,n){for(var i=[],r=e.length,s=0;s<r;s++)Ii(e[s].e,i,!0);qr(i,()=>{var a=i.length===0&&n!==null;if(a){var o=n,l=o.parentNode;ga(l),l.append(o),t.items.clear(),ze(t,e[0].prev,e[r-1].next)}for(var c=0;c<r;c++){var u=e[c];a||(t.items.delete(u.k),ze(t,u.prev,u.next)),ke(u.e,!a)}t.first===e[0]&&(t.first=e[0].prev)})}function Pt(t,e,n,i,r,s=null){var a=t,o=new Map,l=null;{var c=t;a=c.appendChild(ct())}var u=null,h=Or(()=>{var v=n();return pi(v)?v:v==null?[]:vi(v)}),f,g=!0;function p(){Sa(_,f,a,e,i),u!==null&&(f.length===0?(u.fragment?(a.before(u.fragment),u.fragment=null):Ci(u.effect),x.first=u.effect):Bt(u.effect,()=>{u=null}))}var x=Xn(()=>{f=d(h);for(var v=f.length,w=new Set,b=te,D=null,I=Tr(),E=0;E<v;E+=1){var A=f[E],L=i(A,E),k=g?null:o.get(L);k?(on(k.v,A),k.i=E,I&&b.skipped_effects.delete(k.e)):(k=xa(g?a:null,D,A,L,E,r,e,n),g&&(k.o=!0,D===null?l=k:D.next=k,D=k),o.set(L,k)),w.add(L)}if(v===0&&s&&!u)if(g)u={fragment:null,effect:Fe(()=>s(a))};else{var m=document.createDocumentFragment(),P=ct();m.append(P),u={fragment:m,effect:Fe(()=>s(P))}}if(!g)if(I){for(const[O,y]of o)w.has(O)||b.skipped_effects.add(y.e);b.oncommit(p),b.ondiscard(()=>{})}else p();d(h)}),_={effect:x,items:o,first:l};g=!1}function Sa(t,e,n,i,r){var s=e.length,a=t.items,o=t.first,l,c=null,u=[],h=[],f,g,p,x;for(x=0;x<s;x+=1){if(f=e[x],g=r(f,x),p=a.get(g),t.first??=p,!p.o){p.o=!0;var _=c?c.next:o;ze(t,c,p),ze(t,p,_),Vn(p,_,n),c=p,u=[],h=[],o=c.next;continue}if((p.e.f&Pe)!==0&&Ci(p.e),p!==o){if(l!==void 0&&l.has(p)){if(u.length<h.length){var v=h[0],w;c=v.prev;var b=u[0],D=u[u.length-1];for(w=0;w<u.length;w+=1)Vn(u[w],v,n);for(w=0;w<h.length;w+=1)l.delete(h[w]);ze(t,b.prev,D.next),ze(t,c,b),ze(t,D,v),o=v,c=D,x-=1,u=[],h=[]}else l.delete(p),Vn(p,o,n),ze(t,p.prev,p.next),ze(t,p,c===null?t.first:c.next),ze(t,c,p),c=p;continue}for(u=[],h=[];o!==null&&o.k!==g;)(o.e.f&Pe)===0&&(l??=new Set).add(o),h.push(o),o=o.next;if(o===null)continue;p=o}u.push(p),c=p,o=p.next}if(o!==null||l!==void 0){for(var I=l===void 0?[]:vi(l);o!==null;)(o.e.f&Pe)===0&&I.push(o),o=o.next;var E=I.length;if(E>0){var A=s===0?n:null;wa(t,I,A)}}}function xa(t,e,n,i,r,s,a,o){var l=(a&ia)!==0,c=(a&sa)===0,u=l?c?xi(n,!1,!1):Lt(n):n,h=(a&ra)===0?r:Lt(r),f={i:h,v:u,k:i,a:null,e:null,o:!1,prev:e,next:null};try{if(t===null){var g=document.createDocumentFragment();g.append(t=ct())}return f.e=Fe(()=>s(t,u,h,o)),e!==null&&(e.next=f),f}finally{}}function Vn(t,e,n){for(var i=t.next?t.next.e.nodes_start:n,r=e?e.e.nodes_start:n,s=t.e.nodes_start;s!==null&&s!==i;){var a=mn(s);r.before(s),s=a}}function ze(t,e,n){e===null?(t.first=n,t.effect.first=n&&n.e):(e.e.next&&(e.e.next.prev=null),e.next=n,e.e.next=n&&n.e),n===null?t.effect.last=e&&e.e:(n.e.prev&&(n.e.prev.next=null),n.prev=e,n.e.prev=e&&e.e)}function Ea(t,e,n,i){const r=pn()?Gn:Or;if(n.length===0&&t.length===0){i(e.map(r));return}var s=te,a=K,o=Ia();function l(){Promise.all(n.map(c=>Ca(c))).then(c=>{o();try{i([...e.map(r),...c])}catch(u){(a.f&pt)===0&&Gt(u,a)}s?.deactivate(),Tn()}).catch(c=>{Gt(c,a)})}t.length>0?Promise.all(t).then(()=>{o();try{return l()}finally{s?.deactivate(),Tn()}}):l()}function Ia(){var t=K,e=W,n=ne,i=te;return function(s=!0){Je(t),De(e),Zt(n),s&&i?.activate()}}function Tn(){Je(null),De(null),Zt(null)}function Gn(t){var e=me|Ae,n=W!==null&&(W.f&me)!==0?W:null;return K!==null&&(K.f|=zt),{ctx:ne,deps:null,effects:null,equals:xr,f:e,fn:t,reactions:null,rv:0,v:be,wv:0,parent:n??K,ac:null}}function Ca(t,e){let n=K;n===null&&Ks();var i=n.b,r=void 0,s=Lt(be),a=!W,o=new Map;return Ha(()=>{var l=br();r=l.promise;try{Promise.resolve(t()).then(l.resolve,l.reject).then(()=>{c===te&&c.committed&&c.deactivate(),Tn()})}catch(f){l.reject(f),Tn()}var c=te;if(a){var u=!i.is_pending();i.update_pending_count(1),c.increment(u),o.get(c)?.reject(Ht),o.delete(c),o.set(c,l)}const h=(f,g=void 0)=>{if(c.activate(),g)g!==Ht&&(s.f|=vt,on(s,g));else{(s.f&vt)!==0&&(s.f^=vt),on(s,f);for(const[p,x]of o){if(o.delete(p),p===c)break;x.reject(Ht)}}a&&(i.update_pending_count(-1),c.decrement(u))};l.promise.then(h,f=>h(null,f||"unknown"))}),Wn(()=>{for(const l of o.values())l.reject(Ht)}),new Promise(l=>{function c(u){function h(){u===r?l(s):c(r)}u.then(h,h)}c(r)})}function $(t){const e=Gn(t);return Nr(e),e}function Or(t){const e=Gn(t);return e.equals=Ir,e}function Rr(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)ke(e[n])}}function Da(t){for(var e=t.parent;e!==null;){if((e.f&me)===0)return(e.f&pt)===0?e:null;e=e.parent}return null}function Si(t){var e,n=K;Je(Da(t));try{t.f&=~Tt,Rr(t),e=Wr(t)}finally{Je(n)}return e}function $r(t){var e=Si(t);if(t.equals(e)||(te?.is_fork||(t.v=e),t.wv=Zr()),!Ut)if(He!==null)(cn()||te?.is_fork)&&He.set(t,e);else{var n=(t.f&Ye)===0?Qe:ge;pe(t,n)}}let oi=new Set;const _t=new Map;let Fr=!1;function Lt(t,e){var n={f:0,v:t,reactions:null,equals:xr,rv:0,wv:0};return n}function z(t,e){const n=Lt(t);return Nr(n),n}function xi(t,e=!1,n=!0){const i=Lt(t);return e||(i.equals=Ir),gn&&n&&ne!==null&&ne.l!==null&&(ne.l.s??=[]).push(i),i}function H(t,e,n=!1){W!==null&&(!qe||(W.f&Hi)!==0)&&pn()&&(W.f&(me|dt|bi|Hi))!==0&&!st?.includes(t)&&Qs();let i=n?je(e):e;return on(t,i)}function on(t,e){if(!t.equals(e)){var n=t.v;Ut?_t.set(t,e):_t.set(t,n),t.v=e;var i=Ve.ensure();i.capture(t,n),(t.f&me)!==0&&((t.f&Ae)!==0&&Si(t),pe(t,(t.f&Ye)!==0?ge:Qe)),t.wv=Zr(),Hr(t,Ae),pn()&&K!==null&&(K.f&ge)!==0&&(K.f&(ut|Ot))===0&&($e===null?Aa([t]):$e.push(t)),!i.is_fork&&oi.size>0&&!Fr&&ka()}return e}function ka(){Fr=!1;var t=yt;Mn(!0);const e=Array.from(oi);try{for(const n of e)(n.f&ge)!==0&&pe(n,Qe),jt(n)&&Yt(n)}finally{Mn(t)}oi.clear()}function rn(t){H(t,t.v+1)}function Hr(t,e){var n=t.reactions;if(n!==null)for(var i=pn(),r=n.length,s=0;s<r;s++){var a=n[s],o=a.f;if(!(!i&&a===K)){var l=(o&Ae)===0;if(l&&pe(a,e),(o&me)!==0){var c=a;He?.delete(c),(o&Tt)===0&&(o&Ye&&(a.f|=Tt),Hr(c,Qe))}else l&&((o&dt)!==0&&rt!==null&&rt.add(a),Mt(a))}}}function Ei(t){var e=W,n=K;De(null),Je(null);try{return t()}finally{De(e),Je(n)}}let yt=!1;function Mn(t){yt=t}let Ut=!1;function Gi(t){Ut=t}let W=null,qe=!1;function De(t){W=t}let K=null;function Je(t){K=t}let st=null;function Nr(t){W!==null&&(st===null?st=[t]:st.push(t))}let Se=null,Me=0,$e=null;function Aa(t){$e=t}let Br=1,ln=0,kt=ln;function Wi(t){kt=t}function Zr(){return++Br}function jt(t){var e=t.f;if((e&Ae)!==0)return!0;if(e&me&&(t.f&=~Tt),(e&Qe)!==0){var n=t.deps;if(n!==null)for(var i=n.length,r=0;r<i;r++){var s=n[r];if(jt(s)&&$r(s),s.wv>t.wv)return!0}(e&Ye)!==0&&He===null&&pe(t,ge)}return!1}function Gr(t,e,n=!0){var i=t.reactions;if(i!==null&&!st?.includes(t))for(var r=0;r<i.length;r++){var s=i[r];(s.f&me)!==0?Gr(s,e,!1):e===s&&(n?pe(s,Ae):(s.f&ge)!==0&&pe(s,Qe),Mt(s))}}function Wr(t){var e=Se,n=Me,i=$e,r=W,s=st,a=ne,o=qe,l=kt,c=t.f;Se=null,Me=0,$e=null,W=(c&(ut|Ot))===0?t:null,st=null,Zt(t.ctx),qe=!1,kt=++ln,t.ac!==null&&(Ei(()=>{t.ac.abort(Ht)}),t.ac=null);try{t.f|=si;var u=t.fn,h=u(),f=t.deps;if(Se!==null){var g;if(Pn(t,Me),f!==null&&Me>0)for(f.length=Me+Se.length,g=0;g<Se.length;g++)f[Me+g]=Se[g];else t.deps=f=Se;if(yt&&cn()&&(t.f&Ye)!==0)for(g=Me;g<f.length;g++)(f[g].reactions??=[]).push(t)}else f!==null&&Me<f.length&&(Pn(t,Me),f.length=Me);if(pn()&&$e!==null&&!qe&&f!==null&&(t.f&(me|Qe|Ae))===0)for(g=0;g<$e.length;g++)Gr($e[g],t);return r!==null&&r!==t&&(ln++,$e!==null&&(i===null?i=$e:i.push(...$e))),(t.f&vt)!==0&&(t.f^=vt),h}catch(p){return Mr(p)}finally{t.f^=si,Se=e,Me=n,$e=i,W=r,st=s,Zt(a),qe=o,kt=l}}function Ta(t,e){let n=e.reactions;if(n!==null){var i=Hs.call(n,t);if(i!==-1){var r=n.length-1;r===0?n=e.reactions=null:(n[i]=n[r],n.pop())}}n===null&&(e.f&me)!==0&&(Se===null||!Se.includes(e))&&(pe(e,Qe),(e.f&Ye)!==0&&(e.f^=Ye,e.f&=~Tt),Rr(e),Pn(e,0))}function Pn(t,e){var n=t.deps;if(n!==null)for(var i=e;i<n.length;i++)Ta(t,n[i])}function Yt(t){var e=t.f;if((e&pt)===0){pe(t,ge);var n=K,i=yt;K=t,yt=!0;try{(e&(dt|Ws))!==0?Na(t):jr(t),Ur(t);var r=Wr(t);t.teardown=typeof r=="function"?r:null,t.wv=Br;var s;ri&&ta&&(t.f&Ae)!==0&&t.deps}finally{yt=i,K=n}}}function d(t){var e=t.f,n=(e&me)!==0;if(W!==null&&!qe){var i=K!==null&&(K.f&pt)!==0;if(!i&&!st?.includes(t)){var r=W.deps;if((W.f&si)!==0)t.rv<ln&&(t.rv=ln,Se===null&&r!==null&&r[Me]===t?Me++:Se===null?Se=[t]:Se.includes(t)||Se.push(t));else{(W.deps??=[]).push(t);var s=t.reactions;s===null?t.reactions=[W]:s.includes(W)||s.push(W)}}}if(Ut){if(_t.has(t))return _t.get(t);if(n){var a=t,o=a.v;return((a.f&ge)===0&&a.reactions!==null||Xr(a))&&(o=Si(a)),_t.set(a,o),o}}else n&&(!He?.has(t)||te?.is_fork&&!cn())&&(a=t,jt(a)&&$r(a),yt&&cn()&&(a.f&Ye)===0&&Yr(a));if(He?.has(t))return He.get(t);if((t.f&vt)!==0)throw t.v;return t.v}function Yr(t){if(t.deps!==null){t.f^=Ye;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&me)!==0&&(e.f&Ye)===0&&Yr(e)}}function Xr(t){if(t.v===be)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(_t.has(e)||(e.f&me)!==0&&Xr(e))return!0;return!1}function Rt(t){var e=qe;try{return qe=!0,t()}finally{qe=e}}const Ma=-7169;function pe(t,e){t.f=t.f&Ma|e}function Pa(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(mt in t)li(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&mt in n&&li(n)}}}function li(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let i in t)try{li(t[i],e)}catch{}const n=mi(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const i=yr(n);for(let r in i){const s=i[r].get;if(s)try{s.call(t)}catch{}}}}}function Kr(t){K===null&&(W===null&&js(),Us()),Ut&&zs()}function La(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function et(t,e,n){var i=K;i!==null&&(i.f&Pe)!==0&&(t|=Pe);var r={ctx:ne,deps:null,nodes_start:null,nodes_end:null,f:t|Ae|Ye,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Yt(r),r.f|=yi}catch(o){throw ke(r),o}else e!==null&&Mt(r);var s=r;if(n&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&zt)===0&&(s=s.first,(t&dt)!==0&&(t&At)!==0&&s!==null&&(s.f|=At)),s!==null&&(s.parent=i,i!==null&&La(s,i),W!==null&&(W.f&me)!==0&&(t&Ot)===0)){var a=W;(a.effects??=[]).push(s)}return r}function cn(){return W!==null&&!qe}function Wn(t){const e=et(Bn,null,!1);return pe(e,ge),e.teardown=t,e}function bt(t){Kr();var e=K.f,n=!W&&(e&ut)!==0&&(e&yi)===0;if(n){var i=ne;(i.e??=[]).push(t)}else return zr(t)}function zr(t){return et(_i|Sr,t,!1)}function Oa(t){return Kr(),et(Bn|Sr,t,!0)}function Ra(t){Ve.ensure();const e=et(Ot|zt,t,!0);return(n={})=>new Promise(i=>{n.outro?Bt(e,()=>{ke(e),i(void 0)}):(ke(e),i(void 0))})}function $a(t){return et(_i,t,!1)}function Yi(t,e){var n=ne,i={effect:null,ran:!1,deps:t};n.l.$.push(i),i.effect=Yn(()=>{t(),!i.ran&&(i.ran=!0,Rt(e))})}function Fa(){var t=ne;Yn(()=>{for(var e of t.l.$){e.deps();var n=e.effect;(n.f&ge)!==0&&pe(n,Qe),jt(n)&&Yt(n),e.ran=!1}})}function Ha(t){return et(bi|zt,t,!0)}function Yn(t,e=0){return et(Bn|e,t,!0)}function j(t,e=[],n=[],i=[]){Ea(i,e,n,r=>{et(Bn,()=>t(...r.map(d)),!0)})}function Xn(t,e=0){var n=et(dt|e,t,!0);return n}function Fe(t){return et(ut|zt,t,!0)}function Ur(t){var e=t.teardown;if(e!==null){const n=Ut,i=W;Gi(!0),De(null);try{e.call(null)}finally{Gi(n),De(i)}}}function jr(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){const r=n.ac;r!==null&&Ei(()=>{r.abort(Ht)});var i=n.next;(n.f&Ot)!==0?n.parent=null:ke(n,e),n=i}}function Na(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&ut)===0&&ke(e),e=n}}function ke(t,e=!0){var n=!1;(e||(t.f&wr)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(Ba(t.nodes_start,t.nodes_end),n=!0),jr(t,e&&!n),Pn(t,0),pe(t,pt);var i=t.transitions;if(i!==null)for(const s of i)s.stop();Ur(t);var r=t.parent;r!==null&&r.first!==null&&Vr(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function Ba(t,e){for(;t!==null;){var n=t===e?null:mn(t);t.remove(),t=n}}function Vr(t){var e=t.parent,n=t.prev,i=t.next;n!==null&&(n.next=i),i!==null&&(i.prev=n),e!==null&&(e.first===t&&(e.first=i),e.last===t&&(e.last=n))}function Bt(t,e,n=!0){var i=[];Ii(t,i,!0),qr(i,()=>{n&&ke(t),e&&e()})}function qr(t,e){var n=t.length;if(n>0){var i=()=>--n||e();for(var r of t)r.out(i)}else e()}function Ii(t,e,n){if((t.f&Pe)===0){if(t.f^=Pe,t.transitions!==null)for(const a of t.transitions)(a.is_global||n)&&e.push(a);for(var i=t.first;i!==null;){var r=i.next,s=(i.f&At)!==0||(i.f&ut)!==0&&(t.f&dt)!==0;Ii(i,e,s?n:!1),i=r}}}function Ci(t){Jr(t,!0)}function Jr(t,e){if((t.f&Pe)!==0){t.f^=Pe,(t.f&ge)===0&&(pe(t,Ae),Mt(t));for(var n=t.first;n!==null;){var i=n.next,r=(n.f&At)!==0||(n.f&ut)!==0;Jr(n,r?e:!1),n=i}if(t.transitions!==null)for(const s of t.transitions)(s.is_global||e)&&s.in()}}function Qr(t,e){for(var n=t.nodes_start,i=t.nodes_end;n!==null;){var r=n===i?null:mn(n);e.append(n),n=r}}const Za=["touchstart","touchmove"];function Ga(t){return Za.includes(t)}const es=new Set,ci=new Set;function Wa(t,e,n,i={}){function r(s){if(i.capture||Vt.call(e,s),!s.cancelBubble)return Ei(()=>n?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?vn(()=>{e.addEventListener(t,r,i)}):e.addEventListener(t,r,i),r}function wt(t,e,n,i,r){var s={capture:i,passive:r},a=Wa(t,e,n,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Wn(()=>{e.removeEventListener(t,a,s)})}function tt(t){for(var e=0;e<t.length;e++)es.add(t[e]);for(var n of ci)n(t)}let Xi=null;function Vt(t){var e=this,n=e.ownerDocument,i=t.type,r=t.composedPath?.()||[],s=r[0]||t.target;Xi=t;var a=0,o=Xi===t&&t.__root;if(o){var l=r.indexOf(o);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var c=r.indexOf(e);if(c===-1)return;l<=c&&(a=l)}if(s=r[a]||t.target,s!==e){_r(t,"currentTarget",{configurable:!0,get(){return s||n}});var u=W,h=K;De(null),Je(null);try{for(var f,g=[];s!==null;){var p=s.assignedSlot||s.parentNode||s.host||null;try{var x=s["__"+i];x!=null&&(!s.disabled||t.target===s)&&x.call(s,t)}catch(_){f?g.push(_):f=_}if(t.cancelBubble||p===e||p===null)break;s=p}if(f){for(let _ of g)queueMicrotask(()=>{throw _});throw f}}finally{t.__root=e,delete t.currentTarget,De(u),Je(h)}}}function Ya(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Ln(t,e){var n=K;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function R(t,e){var n=(e&aa)!==0,i=(e&oa)!==0,r,s=!t.startsWith("<!>");return()=>{r===void 0&&(r=Ya(s?t:"<!>"+t),n||(r=An(r)));var a=i||Dr?document.importNode(r,!0):r.cloneNode(!0);if(n){var o=An(a),l=a.lastChild;Ln(o,l)}else Ln(a,a);return a}}function Ie(t=""){{var e=ct(t+"");return Ln(e,e),e}}function Xe(){var t=document.createDocumentFragment(),e=document.createComment(""),n=ct();return t.append(e,n),Ln(e,n),t}function S(t,e){t!==null&&t.before(e)}function he(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??=t.nodeValue)&&(t.__t=n,t.nodeValue=n+"")}function Xa(t,e){return Ka(t,e)}const $t=new Map;function Ka(t,{target:e,anchor:n,props:i={},events:r,context:s,intro:a=!0}){fa();var o=new Set,l=h=>{for(var f=0;f<h.length;f++){var g=h[f];if(!o.has(g)){o.add(g);var p=Ga(g);e.addEventListener(g,Vt,{passive:p});var x=$t.get(g);x===void 0?(document.addEventListener(g,Vt,{passive:p}),$t.set(g,1)):$t.set(g,x+1)}}};l(vi(es)),ci.add(l);var c=void 0,u=Ra(()=>{var h=n??e.appendChild(ct());return ya(h,{pending:()=>{}},f=>{if(s){xe({});var g=ne;g.c=s}r&&(i.$$events=r),c=t(f,i)||{},s&&Ee()}),()=>{for(var f of o){e.removeEventListener(f,Vt);var g=$t.get(f);--g===0?(document.removeEventListener(f,Vt),$t.delete(f)):$t.set(f,g)}ci.delete(l),h!==n&&h.parentNode?.removeChild(h)}});return za.set(c,u),c}let za=new WeakMap;class ts{anchor;#e=new Map;#t=new Map;#i=new Map;#n=new Set;#l=!0;constructor(e,n=!0){this.anchor=e,this.#l=n}#s=()=>{var e=te;if(this.#e.has(e)){var n=this.#e.get(e),i=this.#t.get(n);if(i)Ci(i),this.#n.delete(n);else{var r=this.#i.get(n);r&&(this.#t.set(n,r.effect),this.#i.delete(n),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),i=r.effect)}for(const[s,a]of this.#e){if(this.#e.delete(s),s===e)break;const o=this.#i.get(a);o&&(ke(o.effect),this.#i.delete(a))}for(const[s,a]of this.#t){if(s===n||this.#n.has(s))continue;const o=()=>{if(Array.from(this.#e.values()).includes(s)){var c=document.createDocumentFragment();Qr(a,c),c.append(ct()),this.#i.set(s,{effect:a,fragment:c})}else ke(a);this.#n.delete(s),this.#t.delete(s)};this.#l||!i?(this.#n.add(s),Bt(a,o,!1)):o()}}};#r=e=>{this.#e.delete(e);const n=Array.from(this.#e.values());for(const[i,r]of this.#i)n.includes(i)||(ke(r.effect),this.#i.delete(i))};ensure(e,n){var i=te,r=Tr();if(n&&!this.#t.has(e)&&!this.#i.has(e))if(r){var s=document.createDocumentFragment(),a=ct();s.append(a),this.#i.set(e,{effect:Fe(()=>n(a)),fragment:s})}else this.#t.set(e,Fe(()=>n(this.anchor)));if(this.#e.set(i,e),r){for(const[o,l]of this.#t)o===e?i.skipped_effects.delete(l):i.skipped_effects.add(l);for(const[o,l]of this.#i)o===e?i.skipped_effects.delete(l.effect):i.skipped_effects.add(l.effect);i.oncommit(this.#s),i.ondiscard(this.#r)}else this.#s()}}function U(t,e,n=!1){var i=new ts(t),r=n?At:0;function s(a,o){i.ensure(a,o)}Xn(()=>{var a=!1;e((o,l=!0)=>{a=!0,s(l,o)}),a||s(!1,null)},r)}function Xt(t,e,...n){var i=new ts(t);Xn(()=>{const r=e()??null;i.ensure(r,r&&(s=>r(s,...n)))},At)}const Ki=[...` 	
\r\f \v\uFEFF`];function Ua(t,e,n){var i=t==null?"":""+t;if(e&&(i=i?i+" "+e:e),n){for(var r in n)if(n[r])i=i?i+" "+r:r;else if(i.length)for(var s=r.length,a=0;(a=i.indexOf(r,a))>=0;){var o=a+s;(a===0||Ki.includes(i[a-1]))&&(o===i.length||Ki.includes(i[o]))?i=(a===0?"":i.substring(0,a))+i.substring(o+1):a=o}}return i===""?null:i}function zi(t,e=!1){var n=e?" !important;":";",i="";for(var r in t){var s=t[r];s!=null&&s!==""&&(i+=" "+r+": "+s+n)}return i}function qn(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function ja(t,e){if(e){var n="",i,r;if(Array.isArray(e)?(i=e[0],r=e[1]):i=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,a=0,o=!1,l=[];i&&l.push(...Object.keys(i).map(qn)),r&&l.push(...Object.keys(r).map(qn));var c=0,u=-1;const x=t.length;for(var h=0;h<x;h++){var f=t[h];if(o?f==="/"&&t[h-1]==="*"&&(o=!1):s?s===f&&(s=!1):f==="/"&&t[h+1]==="*"?o=!0:f==='"'||f==="'"?s=f:f==="("?a++:f===")"&&a--,!o&&s===!1&&a===0){if(f===":"&&u===-1)u=h;else if(f===";"||h===x-1){if(u!==-1){var g=qn(t.substring(c,u).trim());if(!l.includes(g)){f!==";"&&h++;var p=t.substring(c,h).trim();n+=" "+p+";"}}c=h+1,u=-1}}}}return i&&(n+=zi(i)),r&&(n+=zi(r,!0)),n=n.trim(),n===""?null:n}return t==null?null:String(t)}function Ze(t,e,n,i,r,s){var a=t.__className;if(a!==n||a===void 0){var o=Ua(n,i,s);o==null?t.removeAttribute("class"):t.className=o,t.__className=n}else if(s&&r!==s)for(var l in s){var c=!!s[l];(r==null||c!==!!r[l])&&t.classList.toggle(l,c)}return s}function Jn(t,e={},n,i){for(var r in n){var s=n[r];e[r]!==s&&(n[r]==null?t.style.removeProperty(r):t.style.setProperty(r,s,i))}}function ve(t,e,n,i){var r=t.__style;if(r!==e){var s=ja(e,i);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}else i&&(Array.isArray(i)?(Jn(t,n?.[0],i[0]),Jn(t,n?.[1],i[1],"important")):Jn(t,n,i));return i}function ns(t,e,n=!1){if(t.multiple){if(e==null)return;if(!pi(e))return da();for(var i of t.options)i.selected=e.includes(Ui(i));return}for(i of t.options){var r=Ui(i);if(ha(r,e)){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Va(t){var e=new MutationObserver(()=>{ns(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Wn(()=>{e.disconnect()})}function Ui(t){return"__value"in t?t.__value:t.value}const qa=Symbol("is custom element"),Ja=Symbol("is html");function On(t,e){var n=is(t);n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function oe(t,e,n,i){var r=is(t);r[e]!==(r[e]=n)&&(e==="loading"&&(t[Ys]=n),n==null?t.removeAttribute(e):typeof n!="string"&&Qa(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function is(t){return t.__attributes??={[qa]:t.nodeName.includes("-"),[Ja]:t.namespaceURI===la}}var ji=new Map;function Qa(t){var e=t.getAttribute("is")||t.nodeName,n=ji.get(e);if(n)return n;ji.set(e,n=[]);for(var i,r=t,s=Element.prototype;s!==r;){i=yr(r);for(var a in i)i[a].set&&n.push(a);r=mi(r)}return n}function Vi(t,e){return t===e||t?.[mt]===e}function Di(t={},e,n,i){return $a(()=>{var r,s;return Yn(()=>{r=s,s=[],Rt(()=>{t!==n(...s)&&(e(t,...s),r&&Vi(n(...r),t)&&e(null,...r))})}),()=>{vn(()=>{s&&Vi(n(...s),t)&&e(null,...s)})}}),t}function eo(t=!1){const e=ne,n=e.l.u;if(!n)return;let i=()=>Pa(e.s);if(t){let r=0,s={};const a=Gn(()=>{let o=!1;const l=e.s;for(const c in l)l[c]!==s[c]&&(s[c]=l[c],o=!0);return o&&r++,r});i=()=>d(a)}n.b.length&&Oa(()=>{qi(e,i),kn(n.b)}),bt(()=>{const r=Rt(()=>n.m.map(Zs));return()=>{for(const s of r)typeof s=="function"&&s()}}),n.a.length&&bt(()=>{qi(e,i),kn(n.a)})}function qi(t,e){if(t.l.s)for(const n of t.l.s)d(n);e()}let di=Symbol();function G(t,e,n){const i=n[e]??={store:null,source:xi(void 0),unsubscribe:Be};if(i.store!==t&&!(di in n))if(i.unsubscribe(),i.store=t??null,t==null)i.source.v=void 0,i.unsubscribe=Be;else{var r=!0;i.unsubscribe=Ai(t,s=>{r?i.source.v=s:H(i.source,s)}),r=!1}return t&&di in n?_n(t):d(i.source)}function ht(){const t={};function e(){Wn(()=>{for(var n in t)t[n].unsubscribe();_r(t,di,{enumerable:!1,value:!0})})}return[t,e]}function J(t,e,n,i){var r=i,s=!0,a=()=>(s&&(s=!1,r=i),r),o;o=t[e],o===void 0&&i!==void 0&&(o=a());var l;return l=()=>{var c=t[e];return c===void 0?a():(s=!0,c)},l}function ki(t){ne===null&&Xs(),gn&&ne.l!==null?to(ne).m.push(t):bt(()=>{const e=Rt(t);if(typeof e=="function")return e})}function to(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}function Ai(t,e,n){if(t==null)return e(void 0),n&&n(void 0),Be;const i=Rt(()=>t.subscribe(e,n));return i.unsubscribe?()=>i.unsubscribe():i}const Ft=[];function no(t,e){return{subscribe:le(t,e).subscribe}}function le(t,e=Be){let n=null;const i=new Set;function r(o){if(Er(t,o)&&(t=o,n)){const l=!Ft.length;for(const c of i)c[1](),Ft.push(c,t);if(l){for(let c=0;c<Ft.length;c+=2)Ft[c][0](Ft[c+1]);Ft.length=0}}}function s(o){r(o(t))}function a(o,l=Be){const c=[o,l];return i.add(c),i.size===1&&(n=e(r,s)||Be),o(t),()=>{i.delete(c),i.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:a}}function Oe(t,e,n){const i=!Array.isArray(t),r=i?[t]:t;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return no(n,(a,o)=>{let l=!1;const c=[];let u=0,h=Be;const f=()=>{if(u)return;h();const p=e(i?c[0]:c,a,o);s?a(p):h=typeof p=="function"?p:Be},g=r.map((p,x)=>Ai(p,_=>{c[x]=_,u&=~(1<<x),l&&f()},()=>{u|=1<<x}));return l=!0,f(),function(){kn(g),h(),l=!1}})}function _n(t){let e;return Ai(t,n=>e=n)(),e}function io(){return`zone_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const ui=["#e74c3c","#e67e22","#f1c40f","#2ecc71","#1abc9c","#3498db","#9b59b6","#e91e8f"];function ro(){return ui[Math.floor(Math.random()*ui.length)]}function so(t,e=200){return{id:io(),x:t,width:e,color:ro(),texts:[{language:"cs",title:"",content:""}]}}function ao(t,e){const n=t.texts.find(i=>i.language===e);return n||t.texts[0]||null}const dn=le("cs"),oo=le("orange"),lo=le("Forest"),hi=le(!1),qt=le(!1),rs=le(!1),ss=le(!1),as=le(null),co=Oe([as,dn],([t,e])=>t?ao(t,e):null);function Qn(t){as.set(t)}const os=le({x:0,y:0});function uo(t,e){os.set({x:t,y:e})}const ls=le({scrollX:0,scrollY:0,zoom:1});function ho(t,e,n=1){ls.set({scrollX:t,scrollY:e,zoom:n})}const fi=le(!1);function fo(){fi.set(!0),setTimeout(()=>fi.set(!1),150)}const Le={BACKGROUND_BASE:-100,BACKGROUND_LAYER_START:-99,GROUND_REFERENCE:-1,ITEMS_BEHIND:5,PLAYER:10,ITEMS_FRONT:15,SELECTION_GRAPHICS:999,GRID_OVERLAY:1e3};function Ti(t){return t==="behind"?Le.ITEMS_BEHIND:Le.ITEMS_FRONT}const it=["orange","white"];class go{currentSkin=it[0];currentIndex=0;setSkin(e){it.includes(e)&&(this.currentSkin=e,this.currentIndex=it.indexOf(e),localStorage.setItem("catSkin",e))}getSkin(){const e=localStorage.getItem("catSkin");return e&&it.includes(e)&&(this.currentSkin=e,this.currentIndex=it.indexOf(e)),this.currentSkin}toggleSkin(){return this.currentIndex=(this.currentIndex+1)%it.length,this.currentSkin=it[this.currentIndex],this.setSkin(this.currentSkin),this.currentSkin}getAllSkins(){return it}}const cs=new go,po={FAST_VELOCITY_THRESHOLD:100,ROTATION_FULL:15,ROTATION_SLIGHT:8};class vo{scene;currentSkin;constructor(e,n="white"){this.scene=e,this.currentSkin=n}createAll(){cs.getAllSkins().forEach(n=>{this.createAnimationsForSkin(n)})}createAnimationsForSkin(e){const n=this.scene;n.anims.exists(`cat-idle-${e}`)||n.anims.create({key:`cat-idle-${e}`,frames:n.anims.generateFrameNumbers(`cat-idle-${e}`,{start:0,end:3}),frameRate:6,repeat:-1}),n.anims.exists(`cat-walk-${e}`)||n.anims.create({key:`cat-walk-${e}`,frames:n.anims.generateFrameNumbers(`cat-walk-${e}`,{start:0,end:5}),frameRate:12,repeat:-1}),[{key:`cat-jump-up-${e}`,frame:2},{key:`cat-jump-peak-up-${e}`,frame:3},{key:`cat-jump-peak-down-${e}`,frame:3},{key:`cat-jump-down-${e}`,frame:4}].forEach(({key:r,frame:s})=>{n.anims.exists(r)||n.anims.create({key:r,frames:[{key:`cat-walk-${e}`,frame:s}],frameRate:1,repeat:0})})}getSkin(){return this.currentSkin}setSkin(e){this.currentSkin=e}getAnimationKey(e){return`cat-${e}-${this.currentSkin}`}play(e,n){const i=this.getAnimationKey(n);e.anims.currentAnim?.key!==i&&e.play(i)}getJumpAnimationState(e){const{FAST_VELOCITY_THRESHOLD:n,ROTATION_FULL:i,ROTATION_SLIGHT:r}=po;return e<-n?{animation:this.getAnimationKey("jump-up"),rotation:i,flipMultiplier:1}:e<-20?{animation:this.getAnimationKey("jump-peak-up"),rotation:r,flipMultiplier:1}:e<=n?{animation:this.getAnimationKey("jump-peak-down"),rotation:r,flipMultiplier:-1}:{animation:this.getAnimationKey("jump-down"),rotation:i,flipMultiplier:-1}}handleSkinChange(e,n){const i=this.currentSkin;this.currentSkin=n;const r=e.anims.currentAnim?.key;if(r){const a=`cat-${r.replace("cat-","").replace(`-${i}`,"")}-${n}`;this.scene.anims.exists(a)&&e.play(a)}}}const It={THRESHOLD_X:20,LANGUAGE_BUTTON:{width:120,height:60},SKIN_BUTTON:{width:120,height:60,yOffset:60}},Ji={SPEED:350,JUMP_STRENGTH:-500};class mo{scene;getPlayerPosition;keyUp;keyLeft;keyRight;keyA;keyD;keyW;keySpace;touchLeft=!1;touchRight=!1;touchJump=!1;touchHandlers;constructor(e){this.scene=e.scene,this.getPlayerPosition=e.getPlayerPosition,this.setupKeyboardControls(),this.setupTouchControls()}setupKeyboardControls(){this.scene.input.keyboard&&(this.keyUp=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.UP,!1),this.keyLeft=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.LEFT,!1),this.keyRight=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.RIGHT,!1),this.keyA=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.A,!1),this.keyD=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.D,!1),this.keyW=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.W,!1),this.keySpace=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.SPACE,!1))}setupTouchControls(){const e=this.scene,n=a=>{if(_n(fi)){this.touchLeft=!1,this.touchRight=!1,this.touchJump=!1;return}const o=a.x,l=a.y,c=e.scale.width;if(o>c-It.LANGUAGE_BUTTON.width&&l<It.LANGUAGE_BUTTON.height||o>c-It.SKIN_BUTTON.width&&l>=It.SKIN_BUTTON.yOffset&&l<It.SKIN_BUTTON.yOffset+It.SKIN_BUTTON.height)return;const u=e.cameras.main,h=this.getPlayerPosition(),f=h.x-u.scrollX,g=h.y-u.scrollY,p=o-f,x=l-g;p<-20?(this.touchLeft=!0,this.touchRight=!1):p>It.THRESHOLD_X?(this.touchRight=!0,this.touchLeft=!1):(this.touchLeft=!1,this.touchRight=!1),this.touchJump=x<-80},i=a=>{n(a)},r=a=>{a.isDown&&n(a)},s=()=>{this.touchLeft=!1,this.touchRight=!1,this.touchJump=!1};e.input.on("pointerdown",i),e.input.on("pointermove",r),e.input.on("pointerup",s),this.touchHandlers={pointerdown:i,pointermove:r,pointerup:s}}getInputState(){const e=this.keyA?.isDown||this.keyLeft?.isDown||this.touchLeft||!1,n=this.keyD?.isDown||this.keyRight?.isDown||this.touchRight||!1,i=this.keySpace?.isDown||this.keyW?.isDown||this.keyUp?.isDown||this.touchJump||!1;return{left:e,right:n,jump:i}}hasAnyInput(){const e=this.getInputState();return e.left||e.right||e.jump}destroy(){this.touchHandlers&&(this.scene.input.off("pointerdown",this.touchHandlers.pointerdown),this.scene.input.off("pointermove",this.touchHandlers.pointermove),this.scene.input.off("pointerup",this.touchHandlers.pointerup),this.touchHandlers=void 0)}}class _o extends B.Physics.Arcade.Sprite{animations;inputController;animState="idle";hasNotifiedMovement=!1;hasReceivedInput=!1;constructor(e,n,i){const r="white";super(e,n,i,`cat-idle-${r}`),e.add.existing(this),e.physics.add.existing(this),this.animations=new vo(e,r),this.animations.createAll(),this.inputController=new mo({scene:e,getPlayerPosition:()=>({x:this.x,y:this.y})}),this.setCollideWorldBounds(!0),this.setBounce(0),this.setSize(16,12),this.setOffset(16,36),this.setScale(5),this.setDepth(Le.PLAYER),this.animations.play(this,"idle")}changeSkin(e){this.animations.handleSkinChange(this,e)}updateJumpAnimation(e){const{animation:n,rotation:i,flipMultiplier:r}=this.animations.getJumpAnimationState(e);this.anims.currentAnim?.key!==n&&this.play(n);const s=this.flipX?i*r:-i*r;this.setAngle(s)}update(){const e=this.inputController.getInputState(),n=this.body,i=n&&(n.blocked.down||n.touching.down);switch(this.inputController.hasAnyInput()&&!this.hasReceivedInput&&(this.hasReceivedInput=!0),this.hasReceivedInput&&this.inputController.hasAnyInput()&&!this.hasNotifiedMovement&&(this.hasNotifiedMovement=!0,ss.set(!0)),e.left?(this.setVelocityX(-350),this.setFlipX(!0),i&&(this.animState="running")):e.right?(this.setVelocityX(Ji.SPEED),this.setFlipX(!1),i&&(this.animState="running")):(this.setVelocityX(0),i&&(this.animState="idle")),e.jump&&i&&(this.setVelocityY(Ji.JUMP_STRENGTH),this.animState="jumping"),!i&&n&&n.velocity.y!==0&&(this.animState="jumping"),this.animState){case"idle":this.animations.play(this,"idle"),this.setAngle(0);break;case"running":this.animations.play(this,"walk"),this.setAngle(0);break;case"jumping":this.updateJumpAnimation(n.velocity.y);break}}destroy(e){this.inputController.destroy(),super.destroy(e)}}const Ct=[{name:"FOREST",folder:"forest",scrollFactors:[1,.8,.85,.9,.95,1]},{name:"FOREST BLUE",folder:"forest_blue",scrollFactors:[1,.8,.85,.9,.95,1]}];class yo{currentIndex=0;constructor(){const e=localStorage.getItem("background");if(e){const n=Ct.findIndex(i=>i.folder===e);n!==-1&&(this.currentIndex=n)}}getBackground(){return Ct[this.currentIndex].folder}getCurrentConfig(){return Ct[this.currentIndex]}setBackground(e){const n=Ct.findIndex(i=>i.folder===e);n!==-1&&(this.currentIndex=n,localStorage.setItem("background",e))}toggleBackground(){this.currentIndex=(this.currentIndex+1)%Ct.length;const e=Ct[this.currentIndex];return localStorage.setItem("background",e.folder),e}getAllBackgrounds(){return Ct}}const Rn=new yo;function ds(t,e){return new Promise(n=>{t.load.image(`bg0-${e.folder}`,`assets/backgrounds/${e.folder}/0.png`);for(let i=0;i<e.scrollFactors.length;i++){const r=i+1;t.load.image(`bg${r}-${e.folder}`,`assets/backgrounds/${e.folder}/${r}.png`)}t.load.once("complete",()=>{n(!0)}),t.load.once("loaderror",i=>{console.error(`Failed to load background asset: ${i.key}`),n(!1)}),t.load.start()})}function us(t,e,n,i){const r=Math.max(n,t.scale.height),s=t.add.tileSprite(0,0,e,r,`bg0-${i.folder}`);s.setOrigin(0,0),s.setScrollFactor(1),s.setDepth(Le.BACKGROUND_BASE),s.tilePositionX=0,s.tilePositionY=0;const a=[];for(let o=0;o<i.scrollFactors.length;o++){const c=`bg${o+1}-${i.folder}`;if(t.textures.exists(c)){const u=t.add.image(0,0,c);u.setOrigin(0,0),u.setScrollFactor(i.scrollFactors[o]),u.setDepth(Le.BACKGROUND_LAYER_START+o),u.setDisplaySize(e,n),a.push(u)}}return{baseLayer:s,bgLayers:a}}function hs(t,e){t&&(t.tilePositionX=e.scrollX)}function bo(t){t.bgLayers.forEach(e=>e.destroy()),t.baseLayer.destroy()}const wo=[{code:"cs",label:"CZ"},{code:"en",label:"EN"}],fs="cs",So={isActive:!1,config:null,selectedItemId:null,itemDepthLayer:"behind",editMode:"items",selectedDialogZoneId:null,selectedFrameId:null},Y=le(So),gs=Oe(Y,t=>t.isActive),xo=Oe(Y,t=>t.config),Kn=le(!0);function Eo(){Kn.update(t=>!t)}const un=le(!1),hn=le(!1);function Io(){un.update(t=>!t)}function Co(){hn.update(t=>!t)}const Mi=le(fs);function Do(t){Mi.set(t)}const ps=Oe(Y,t=>t.selectedItemId),vs=Oe(Y,t=>t.itemDepthLayer),at=Oe(Y,t=>t.editMode),ms=Oe(Y,t=>t.selectedDialogZoneId),Pi=Oe(Y,t=>t.config?.dialogZones||[]),_s=Oe(Y,t=>t.selectedFrameId),ys=Oe(Y,t=>t.config?.placedFrames||[]),Li=le(new Map);function ko(t,e,n){Li.update(i=>{const r=new Map(i);return r.set(t,{x:e,y:n}),r})}function Ao(t){Li.update(e=>{const n=new Map(e);return n.delete(t),n})}const To=Oe(Y,t=>!t.selectedFrameId||!t.config?.placedFrames?null:t.config.placedFrames.find(e=>e.id===t.selectedFrameId)??null),bs=Oe(Y,t=>!t.selectedItemId||!t.config?.placedItems?null:t.config.placedItems.find(e=>e.id===t.selectedItemId)??null),Mo=Oe(bs,t=>t?.physicsEnabled??!1);function Qi(t,e){Y.update(n=>n.config?{...n,config:{...n.config,playerStartX:t,playerStartY:e}}:n)}function Po(t){Y.update(e=>{if(!e.config)return e;const n=e.config.placedItems||[];return{...e,config:{...e.config,placedItems:[...n,t]}}})}function $n(t,e){Y.update(n=>!n.config||!n.config.placedItems?n:{...n,config:{...n.config,placedItems:n.config.placedItems.map(i=>i.id===t?{...i,...e}:i)}})}function ws(t){Y.update(e=>!e.config||!e.config.placedItems?e:{...e,config:{...e.config,placedItems:e.config.placedItems.filter(n=>n.id!==t)},selectedItemId:e.selectedItemId===t?null:e.selectedItemId})}function Fn(t){Y.update(e=>({...e,selectedItemId:t}))}function Oi(){Y.update(t=>({...t,selectedItemId:null}))}function Lo(){Y.update(t=>({...t,itemDepthLayer:t.itemDepthLayer==="behind"?"front":"behind"}))}function Oo(t,e){$n(t,{depth:e})}function Ro(t,e){e?($n(t,{physicsEnabled:e,depth:Ti("behind")}),Y.update(n=>({...n,itemDepthLayer:"behind"}))):$n(t,{physicsEnabled:e})}function $o(t){Y.set({isActive:!0,config:{...t,placedItems:t.placedItems||[],dialogZones:t.dialogZones||[],placedFrames:t.placedFrames||[]},selectedItemId:null,itemDepthLayer:"behind",editMode:"items",selectedDialogZoneId:null,selectedFrameId:null}),yn.set(!1)}function Fo(){Y.update(t=>{const e=t.config?{...t.config,dialogZones:(t.config.dialogZones||[]).filter(n=>n.texts.some(i=>i.title.trim()!==""||i.content.trim()!==""))}:t.config;return{...t,isActive:!1,selectedItemId:null,config:e}}),yn.set(!1)}function Ho(){return _n(Y).config}const yn=le(!1);function er(t){yn.set(t)}const Ri=le({scrollX:0,scrollY:0,viewWidth:0,viewHeight:0,worldWidth:0,worldHeight:0,zoom:1,playerX:0,playerY:0});function No(t){Ri.update(e=>({...e,...t}))}function Jt(t){Y.update(e=>({...e,editMode:t,selectedItemId:t==="items"?e.selectedItemId:null,selectedDialogZoneId:t==="dialogs"?e.selectedDialogZoneId:null,selectedFrameId:t==="frames"?e.selectedFrameId:null}))}function Bo(t){Y.update(e=>{if(!e.config)return e;const n=e.config.dialogZones||[];return{...e,config:{...e.config,dialogZones:[...n,t]}}})}function Qt(t,e){Y.update(n=>!n.config||!n.config.dialogZones?n:{...n,config:{...n.config,dialogZones:n.config.dialogZones.map(i=>i.id===t?{...i,...e}:i)}})}function Zo(t){Y.update(e=>!e.config||!e.config.dialogZones?e:{...e,config:{...e.config,dialogZones:e.config.dialogZones.filter(n=>n.id!==t)},selectedDialogZoneId:e.selectedDialogZoneId===t?null:e.selectedDialogZoneId})}function En(t){Y.update(e=>({...e,selectedDialogZoneId:t}))}function tr(t,e,n){Y.update(i=>!i.config||!i.config.dialogZones?i:{...i,config:{...i.config,dialogZones:i.config.dialogZones.map(r=>{if(r.id!==t)return r;const s=r.texts.findIndex(o=>o.language===e);let a;return s>=0?a=r.texts.map((o,l)=>l===s?{...o,...n}:o):a=[...r.texts,{language:e,title:"",content:"",...n}],{...r,texts:a}})}})}function Go(t){Y.update(e=>{if(!e.config)return e;const n=e.config.placedFrames||[];return{...e,config:{...e.config,placedFrames:[...n,t]}}})}function gt(t,e){Y.update(n=>!n.config||!n.config.placedFrames?n:{...n,config:{...n.config,placedFrames:n.config.placedFrames.map(i=>i.id===t?{...i,...e}:i)}})}function Ss(t){Y.update(e=>!e.config||!e.config.placedFrames?e:{...e,config:{...e.config,placedFrames:e.config.placedFrames.filter(n=>n.id!==t)},selectedFrameId:e.selectedFrameId===t?null:e.selectedFrameId})}function en(t){Y.update(e=>({...e,selectedFrameId:t}))}const $i=[{key:"tent",name:"Tent",path:"assets/ui/tent.png",scale:6,category:"structures"},{key:"lamp",name:"Lamp",path:"assets/ui/lamp.png",scale:8,category:"props"},{key:"sign_left",name:"Sign ←",path:"assets/ui/sign_left.png",scale:7,category:"signs"},{key:"sign_right",name:"Sign →",path:"assets/ui/sign_right.png",scale:7,category:"signs"},{key:"stone_0",name:"Stone 0",path:"assets/ui/stone_0.png",scale:4,category:"nature",supportsPhysics:!0},{key:"stone_1",name:"Stone 1",path:"assets/ui/stone_1.png",scale:5,category:"nature",supportsPhysics:!0},{key:"stone_2",name:"Stone 2",path:"assets/ui/stone_2.png",scale:4,category:"nature",supportsPhysics:!0}];function xs(t){return $i.find(e=>e.key===t)}function Wo(t){return xs(t)?.scale||1}function Yo(t){return xs(t)?.supportsPhysics??!1}class nr{scene;groundY;constructor(e,n){this.scene=e,this.groundY=n}static preloadAssets(e){$i.forEach(n=>{e.load.image(n.key,n.path)})}createSprite(e){const{id:n,assetKey:i,x:r,scale:s=1,depth:a=5,yOffset:o=0}=e,l=this.groundY+o,c=this.scene.add.sprite(r,l,i);return c.setScale(s),c.setDepth(a),c.setData("itemId",n),c}updatePosition(e,n,i){e.x=n,e.y=this.groundY+i}updateScale(e,n){e.setScale(n)}updateDepth(e,n){e.setDepth(n)}applyUpdates(e,n){n.x!==void 0&&(e.x=n.x),n.yOffset!==void 0&&(e.y=this.groundY+n.yOffset),n.scale!==void 0&&e.setScale(n.scale),n.depth!==void 0&&e.setDepth(n.depth)}worldYToOffset(e){return e-this.groundY}getGroundY(){return this.groundY}}const Hn=40,Xo=48,ir=5,Ko=Le.PLAYER,Kt=50,zo=4871528,Uo=.4,jo=1,Es=Le.GRID_OVERLAY,ei=16711680,Vo=2,qo=.6,Jo=.1,Qo=1,el=.2,rr=50,tl=50,nl=10,il=4886754;function sr(t,e){return Math.round(t/e)*e}class rl{scene;groundY;isDragging=!1;callbacks;constructor(e,n,i={}){this.scene=e,this.groundY=n,this.callbacks=i}getIsDragging(){return this.isDragging}makeInteractive(e,n){e.setInteractive({cursor:"pointer"}),this.scene.input.setDraggable(e),e.on("pointerdown",()=>{this.isDragging||Fn(n)}),e.on("dragstart",()=>{this.isDragging=!1,e.setTint(4886754),this.scene.data?.set("isDraggingItem",!0),this.callbacks.onDragStart?.(n)}),e.on("drag",(i,r,s)=>{this.isDragging=!0;const a=_n(Kn),o=a?sr(r,Kt):r,l=a?sr(s,Kt):s;e.setPosition(o,l),this.callbacks.onDrag?.(n,o,l)}),e.on("dragend",()=>{e.clearTint(),this.scene.data?.set("isDraggingItem",!1);const i=Math.round(e.x),s=Math.round(e.y)-this.groundY;$n(n,{x:i,yOffset:s}),this.callbacks.onDragEnd?.(n,i,s),this.scene.time.delayedCall(50,()=>{this.isDragging=!1})})}removeInteractivity(e){!e||!e.scene||(e.removeInteractive(),e.off("pointerdown"),e.off("dragstart"),e.off("drag"),e.off("dragend"))}}const sl={lineWidth:3,lineColor:4886754,lineAlpha:1,handleSize:8,handleColor:4886754,padding:5};class al{scene;graphics;style;selectedId=null;constructor(e,n={}){this.scene=e,this.style={...sl,...n},this.graphics=e.add.graphics(),this.graphics.setDepth(Le.SELECTION_GRAPHICS)}setSelectedId(e){this.selectedId=e}getSelectedId(){return this.selectedId}updateVisuals(e){if(this.graphics.clear(),!e||!this.selectedId)return;const n=e.getBounds(),{lineWidth:i,lineColor:r,lineAlpha:s,handleSize:a,handleColor:o,padding:l}=this.style;this.graphics.lineStyle(i,r,s),this.graphics.strokeRect(n.x-l,n.y-l,n.width+l*2,n.height+l*2),this.graphics.fillStyle(o,1),this.graphics.fillCircle(n.x,n.y,a),this.graphics.fillCircle(n.x+n.width,n.y,a),this.graphics.fillCircle(n.x,n.y+n.height,a),this.graphics.fillCircle(n.x+n.width,n.y+n.height,a)}clearVisuals(){this.graphics.clear(),this.selectedId=null}setupBackgroundDeselect(e){this.scene.input.on("pointerdown",n=>{if(e())return;this.scene.input.hitTestPointer(n).find(r=>r.type==="Sprite"&&r.getData("itemId"))||(Oi(),this.clearVisuals())})}destroy(){this.graphics?.destroy()}}class Nn{scene;items=new Map;isBuilderMode=!1;physicsGroup=null;renderer;dragController;selectionManager;constructor(e,n,i=!1){this.scene=e,this.isBuilderMode=i,this.renderer=new nr(e,n),i||(this.physicsGroup=e.physics.add.staticGroup()),this.isBuilderMode&&(this.dragController=new rl(e,n,{onDrag:()=>this.updateSelectionVisuals()}),this.selectionManager=new al(e))}static preloadAssets(e){nr.preloadAssets(e)}createItems(e){e.forEach(n=>{this.createItem(n)})}createItem(e){const n=this.renderer.createSprite(e),i={sprite:n,data:e};if(!this.isBuilderMode&&e.physicsEnabled&&this.physicsGroup){const r=this.createPhysicsBody(n,e);i.physicsBody=r}this.items.set(e.id,i),this.isBuilderMode&&this.dragController&&(this.dragController.makeInteractive(n,e.id),n.on("pointerdown",()=>{this.dragController?.getIsDragging()||(Fn(e.id),this.updateSelectionVisuals())}))}createPhysicsBody(e,n){const i=e.getBounds(),r=i.width*.5,s=i.height*.8,a=e.x,o=e.y,l=this.scene.add.rectangle(a,o,r,s);return l.setVisible(!1),this.physicsGroup.add(l),l.setData("itemId",n.id),l}updateSelectionVisuals(){if(!this.selectionManager)return;const e=this.scene.data.get("selectedItemId");if(this.selectionManager.setSelectedId(e),!e){this.selectionManager.clearVisuals();return}const n=this.items.get(e);this.selectionManager.updateVisuals(n?.sprite??null)}updateItem(e,n){const i=this.items.get(e);i&&(this.renderer.applyUpdates(i.sprite,n),i.data={...i.data,...n})}removeItem(e){const n=this.items.get(e);n&&(this.dragController&&this.dragController.removeInteractivity(n.sprite),n.physicsBody&&n.physicsBody.destroy(),n.sprite.destroy(),this.items.delete(e))}removeAllItems(){this.items.forEach(e=>{!e.sprite||!e.sprite.scene||(this.dragController&&this.dragController.removeInteractivity(e.sprite),e.physicsBody&&e.physicsBody.destroy(),e.sprite.destroy())}),this.items.clear()}getItem(e){return this.items.get(e)?.data}getAllItems(){return Array.from(this.items.values()).map(e=>e.data)}getPhysicsGroup(){return this.physicsGroup}setInteractiveEnabled(e){!this.isBuilderMode||!this.dragController||(this.items.forEach(({sprite:n,data:i})=>{e?(this.dragController.makeInteractive(n,i.id),n.setAlpha(1),n.on("pointerdown",()=>{this.dragController?.getIsDragging()||(Fn(i.id),this.updateSelectionVisuals())})):(n.disableInteractive(),n.off("pointerdown"),n.setAlpha(.6))}),!e&&this.selectionManager&&this.selectionManager.clearVisuals())}destroy(){this.removeAllItems(),this.selectionManager?.destroy()}setupBackgroundDeselect(){!this.isBuilderMode||!this.selectionManager||this.selectionManager.setupBackgroundDeselect(()=>this.dragController?.getIsDragging()??!1)}}function ol(){return`frame_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const ll=["#ffffff","#f8f8f8","#fffacd","#ffefd5","#ffe4e1","#e6e6fa","#f0fff0","#f5fffa","#fff0f5","#f0f8ff","#2d2d2d","#1a1a2e","#16213e","#1a1a1a","#2d132c","#1e3a3a","#3d1a1a","#1a2f1a","#3d3d1a","#2a1a3d"],cl=["#333333","#000000","#ffffff","#1a1a1a","#666666","#8b4513","#2c3e50","#c0392b","#27ae60","#2980b9","#8e44ad","#f39c12"],dl=[12,14,16,18,20,24,28,32],Is={S:{label:"Small",scale:3},M:{label:"Medium",scale:4},L:{label:"Large",scale:5}};function ul(t){return Is[t].scale}function hl(t){return t<=3?"S":t>=5?"L":"M"}const ot=4,tn="#ffffff",Cs="#333333",In=16,fl=64,gl=96,pl=.06,ar=32,Ds=[{key:"base_1",name:"Frame 1",path:"assets/frames/base 1.png",scale:4},{key:"base_2",name:"Frame 2",path:"assets/frames/base 2.png",scale:4},{key:"base_3",name:"Frame 3",path:"assets/frames/base 3.png",scale:4},{key:"base_4",name:"Frame 4",path:"assets/frames/base 4.png",scale:4},{key:"base_5",name:"Frame 5",path:"assets/frames/base 5.png",scale:4},{key:"base_6",name:"Frame 6",path:"assets/frames/base 6.png",scale:4},{key:"base_7",name:"Frame 7",path:"assets/frames/base 7.png",scale:4},{key:"base_8",name:"Frame 8",path:"assets/frames/base 8.png",scale:4},{key:"base_9",name:"Frame 9",path:"assets/frames/base 9.png",scale:4},{key:"base_10",name:"Frame 10",path:"assets/frames/base 10.png",scale:4},{key:"base_11",name:"Frame 11",path:"assets/frames/base 11.png",scale:4},{key:"base_12",name:"Frame 12",path:"assets/frames/base 12.png",scale:4},{key:"base_13",name:"Frame 13",path:"assets/frames/base 13.png",scale:4},{key:"base_14",name:"Frame 14",path:"assets/frames/base 14.png",scale:4},{key:"base_15",name:"Frame 15",path:"assets/frames/base 15.png",scale:4},{key:"base_16",name:"Frame 16",path:"assets/frames/base 16.png",scale:4},{key:"base_17",name:"Frame 17",path:"assets/frames/base 17.png",scale:4},{key:"base_18",name:"Frame 18",path:"assets/frames/base 18.png",scale:4},{key:"base_19",name:"Frame 19",path:"assets/frames/base 19.png",scale:4},{key:"base_20",name:"Frame 20",path:"assets/frames/base 20.png",scale:4},{key:"base_21",name:"Frame 21",path:"assets/frames/base 21.png",scale:4},{key:"base_22",name:"Frame 22",path:"assets/frames/base 22.png",scale:4},{key:"base_23",name:"Frame 23",path:"assets/frames/base 23.png",scale:4},{key:"base_24",name:"Frame 24",path:"assets/frames/base 24.png",scale:4},{key:"base_25",name:"Frame 25",path:"assets/frames/base 25.png",scale:4}];function vl(t){return Ds.find(e=>e.key===t)}function ml(t){return vl(t)?.scale??ot}function sn(t=ot,e=!1){const n=fl*t,i=gl*t,r=e?i:n,s=e?n:i,a=Math.min(n,i)*pl,o=r-a*2,l=s-a*2,c=o-ar*2,u=l-ar*2;return{frameWidth:r,frameHeight:s,innerWidth:o,innerHeight:l,textWidth:c,textHeight:u}}function Cn(t,e,n,i,r,s,a=4){t.clear();const o=parseInt(s.replace("#",""),16);t.fillStyle(o,1),t.fillRoundedRect(e-i/2,n-r/2,i,r,a)}class _l{lastClickTime=0;lastClickedId=null;threshold;constructor(e=300){this.threshold=e}check(e){const n=Date.now();return this.lastClickedId===e&&n-this.lastClickTime<this.threshold?(this.reset(),!0):(this.lastClickTime=n,this.lastClickedId=e,!1)}reset(){this.lastClickTime=0,this.lastClickedId=null}}class or{scene;frames=new Map;constructor(e){this.scene=e}static preloadAssets(e){for(let n=1;n<=25;n++)e.load.image(`frame_base_${n}`,`assets/frames/base ${n}.png`)}createFrames(e){e.forEach(n=>{this.createFrame(n)})}createFrame(e){const n=`frame_${e.frameKey}`;if(!this.scene.textures.exists(n)){console.warn(`[GameFrameManager] Frame texture not found: ${n}`);return}const i=e.scale??ot,r=e.depth??Le.ITEMS_FRONT,s=(e.rotation??0)*(Math.PI/180),a=e.rotation===90,{innerWidth:o,innerHeight:l}=sn(i,a),c=this.scene.add.graphics();c.setDepth(r-.1),Cn(c,e.x,e.y,o,l,e.backgroundColor||tn);const u=this.scene.add.sprite(e.x,e.y,n);u.setScale(i),u.setDepth(r),u.setOrigin(.5,.5),u.setRotation(s);const h={sprite:u,background:c,data:e};this.frames.set(e.id,h),e.url&&this.makeClickable(h)}makeClickable(e){const{sprite:n,data:i}=e;n.setInteractive({useHandCursor:!0}),n.on("pointerover",()=>{n.setScale((i.scale??ot)*1.05)}),n.on("pointerout",()=>{n.setScale(i.scale??ot)}),n.on("pointerdown",()=>{i.url&&(fo(),window.open(i.url,"_blank","noopener,noreferrer"))})}destroy(){this.frames.forEach(({sprite:e,background:n})=>{e.destroy(),n.destroy()}),this.frames.clear()}}async function lr(){const t=await fetch("./config/map.json");if(!t.ok)throw new Error(`Failed to load map config: ${t.status}`);const e=await t.json();if(!e.worldWidth||!e.worldHeight)throw new Error("Invalid map config structure");return e}const Dn={generateId(){return`item_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},create(t){const{assetKey:e,x:n,yOffset:i=0,depthLayer:r="behind",scale:s}=t;return{id:Dn.generateId(),assetKey:e,x:Math.round(n),y:0,scale:s??Wo(e),depth:Ti(r),yOffset:Math.round(i)}},createAtWorldPosition(t,e,n,i,r="behind"){return Dn.create({assetKey:t,x:e,yOffset:n-i,depthLayer:r})},clone(t,e=50){return{...t,id:Dn.generateId(),x:t.x+e}}},Dt={HEIGHT:40,VISUAL:{COLOR:9139029,ALPHA:.3},PHYSICS:{COLOR:0,ALPHA:0}},fn={getGroundY(t,e=Dt.HEIGHT){return t-e},createVisualGround(t,e){const n=e.height??Dt.HEIGHT,i=fn.getGroundY(e.worldHeight,n),r=t.add.rectangle(0,i,e.worldWidth,n,e.color??Dt.VISUAL.COLOR,e.alpha??Dt.VISUAL.ALPHA);return r.setOrigin(0,0),r.setDepth(e.depth??Le.GROUND_REFERENCE),{ground:r,groundY:i}},createPhysicsGround(t,e){const n=e.height??Dt.HEIGHT,i=fn.getGroundY(e.worldHeight,n),r=t.add.rectangle(0,i,e.worldWidth,n,e.color??Dt.PHYSICS.COLOR,e.alpha??Dt.PHYSICS.ALPHA);return r.setOrigin(0,0),t.physics.add.existing(r,!0),{ground:r,groundY:i}},addPlayerCollision(t,e,n){return t.physics.add.collider(e,n)}},lt={GAME:"GameScene",BUILDER:"BuilderScene"};class yl extends B.Scene{player;mapConfig;parallaxLayers=null;loadedBackgrounds=new Set;itemManager;frameManager;dialogZones=[];currentDialogZone=null;unsubscribers=[];initData;constructor(){super({key:lt.GAME})}init(e){this.initData=e}preload(){it.forEach(e=>{this.load.spritesheet(`cat-idle-${e}`,`assets/sprites/${e}/Idle.png`,{frameWidth:48,frameHeight:48}),this.load.spritesheet(`cat-walk-${e}`,`assets/sprites/${e}/Walk.png`,{frameWidth:48,frameHeight:48})}),Nn.preloadAssets(this),or.preloadAssets(this)}create(){this.initializeScene()}async initializeScene(){hi.set(!0);try{await this.loadMapConfiguration();const e=Rn.getCurrentConfig();await this.loadBackgroundIfNeeded(e),this.createParallaxBackground();const{ground:n,groundY:i}=fn.createPhysicsGround(this,{worldWidth:this.mapConfig.worldWidth,worldHeight:this.mapConfig.worldHeight});this.player=new _o(this,this.mapConfig.playerStartX,this.mapConfig.playerStartY),fn.addPlayerCollision(this,this.player,n),this.itemManager=new Nn(this,i,!1),this.mapConfig.placedItems&&this.mapConfig.placedItems.length>0&&this.itemManager.createItems(this.mapConfig.placedItems);const r=this.itemManager.getPhysicsGroup();r&&this.physics.add.collider(this.player,r),this.frameManager=new or(this),this.mapConfig.placedFrames&&this.mapConfig.placedFrames.length>0&&this.frameManager.createFrames(this.mapConfig.placedFrames),this.dialogZones=this.mapConfig.dialogZones||[];const s=Pi.subscribe(a=>{this.dialogZones=a,this.recheckCurrentZone()});this.unsubscribers.push(s),this.cameras.main.startFollow(this.player,!0,.1,.1),this.cameras.main.setBounds(0,0,this.mapConfig.worldWidth,this.mapConfig.worldHeight),this.physics.world.setBounds(0,0,this.mapConfig.worldWidth,this.mapConfig.worldHeight),this.scale.on("resize",this.handleResize,this)}catch(e){console.error("[GameScene] Failed to initialize scene:",e)}finally{hi.set(!1)}}async loadMapConfiguration(){try{if(this.initData?.useBuilderConfig){const e=Ho();this.mapConfig=e||await lr()}else this.mapConfig=await lr()}catch(e){console.error("[GameScene] Failed to load map configuration:",e),this.mapConfig={worldWidth:3200,worldHeight:600,playerStartX:400,playerStartY:300,placedItems:[]}}}createParallaxBackground(){const e=Rn.getCurrentConfig();this.parallaxLayers=us(this,this.mapConfig.worldWidth,this.mapConfig.worldHeight,e)}async loadBackgroundIfNeeded(e){if(this.loadedBackgrounds.has(e.folder))return!0;const n=await ds(this,e);return n&&this.loadedBackgrounds.add(e.folder),n}handleResize(e){if(!(!this.cameras?.main||!this.mapConfig)&&(this.cameras.main.setBounds(0,0,this.mapConfig.worldWidth,this.mapConfig.worldHeight),this.parallaxLayers?.baseLayer)){const n=Math.max(this.mapConfig.worldHeight,e.height);this.parallaxLayers.baseLayer.setSize(this.mapConfig.worldWidth,n)}}shutdown(){this.scale.off("resize",this.handleResize,this),Qn(null),this.currentDialogZone=null,this.unsubscribers.forEach(e=>e()),this.unsubscribers=[],this.itemManager&&this.itemManager.destroy()}update(){if(!this.player)return;this.player.update();const e=this.cameras.main,n=this.player.x-e.scrollX,i=this.player.y-e.scrollY;uo(n,i),ho(e.scrollX,e.scrollY,e.zoom),this.checkDialogZones(),this.parallaxLayers&&hs(this.parallaxLayers.baseLayer,this.cameras.main)}checkDialogZones(){const e=this.player.x;let n=null;for(const i of this.dialogZones)if(e>=i.x&&e<=i.x+i.width){n=i;break}n?.id!==this.currentDialogZone?.id&&(this.currentDialogZone=n,Qn(n))}recheckCurrentZone(){if(!this.currentDialogZone)return;const e=this.dialogZones.find(n=>n.id===this.currentDialogZone?.id);e&&(this.currentDialogZone=e,Qn(e))}}let ks=!1;function wn(t){ks=t}function cr(){return ks}function an(){const t=document.activeElement;if(!t)return!1;const e=t.tagName.toUpperCase();return e==="INPUT"||e==="TEXTAREA"||t.getAttribute("contenteditable")==="true"}const bl=.05,wl=1,Sn=400;class Sl{scene;camera;worldWidth;worldHeight;isPanning=!1;panStartX=0;cameraDragStartX=0;isDraggingToScroll=!1;dragScrollStartX=0;dragScrollStartY=0;dragScrollCameraStartX=0;dragScrollCameraStartY=0;isZoomedOut=!1;isAnimating=!1;savedScrollX=0;savedScrollY=0;constructor(e,n,i){this.scene=e,this.camera=e.cameras.main,this.worldWidth=n,this.worldHeight=i}setup(){this.setupCamera(),this.setupMouseControls(),this.setupKeyboardControls()}setupCamera(){this.camera.setBounds(0,0,this.worldWidth,this.worldHeight),this.camera.setZoom(1)}centerOn(e,n){this.camera.centerOn(e,n)}setupMouseControls(){this.scene.input.on("wheel",(e,n,i,r)=>{if(this.isZoomedOut)return;const s=i!==0?i:r,a=this.camera.scrollX+s;this.camera.setScroll(B.Math.Clamp(a,0,this.worldWidth-this.camera.width),this.camera.scrollY)}),this.scene.input.on("pointerdown",e=>{this.isZoomedOut||cr()||(e.rightButtonDown()||e.middleButtonDown()?(this.isPanning=!0,this.panStartX=e.x,this.cameraDragStartX=this.camera.scrollX):e.leftButtonDown()&&!this.isDraggingObject()&&(this.scene.data.get("isDraggingItem")===!0||(this.dragScrollStartX=e.x,this.dragScrollStartY=e.y,this.dragScrollCameraStartX=this.camera.scrollX,this.dragScrollCameraStartY=this.camera.scrollY)))}),this.scene.input.on("pointermove",e=>{if(!(this.isZoomedOut||cr())){if(this.isPanning){const n=e.x-this.panStartX,i=this.cameraDragStartX-n;this.camera.setScroll(B.Math.Clamp(i,0,this.worldWidth-this.camera.width),this.camera.scrollY)}else if(e.leftButtonDown()&&!this.isDraggingToScroll&&!this.isDraggingObject()&&!(this.scene.data.get("isDraggingItem")===!0)){const i=Math.abs(e.x-this.dragScrollStartX),r=Math.abs(e.y-this.dragScrollStartY);Math.sqrt(i*i+r*r)>10&&(this.isDraggingToScroll=!0,this.scene.input.setDefaultCursor("grabbing"))}if(this.isDraggingToScroll){const n=e.x-this.dragScrollStartX,i=e.y-this.dragScrollStartY,r=this.dragScrollCameraStartX-n,s=this.dragScrollCameraStartY-i;this.camera.setScroll(B.Math.Clamp(r,0,this.worldWidth-this.camera.width),B.Math.Clamp(s,0,this.worldHeight-this.camera.height))}}}),this.scene.input.on("pointerup",e=>{!e.rightButtonDown()&&!e.middleButtonDown()&&(this.isPanning=!1),this.isDraggingToScroll&&(this.isDraggingToScroll=!1,this.scene.input.setDefaultCursor("default"))})}setupKeyboardControls(){const e={up:this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.UP,!1),down:this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.DOWN,!1),left:this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.LEFT,!1),right:this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.RIGHT,!1)},n={w:this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.W,!1),a:this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.A,!1),s:this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.S,!1),d:this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.D,!1)};this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.SPACE,!1).on("down",()=>{an()||this.isZoomedOut||this.centerOnPlayer()}),this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.F,!1).on("down",()=>{an()||this.toggleZoomToFit()}),this.scene.events.on("update",()=>{if(this.isZoomedOut||an())return;const s=10;e.left.isDown||n.a.isDown?this.camera.scrollX=Math.max(0,this.camera.scrollX-s):(e.right.isDown||n.d.isDown)&&(this.camera.scrollX=Math.min(this.worldWidth-this.camera.width,this.camera.scrollX+s)),e.up.isDown||n.w.isDown?this.camera.scrollY=Math.max(0,this.camera.scrollY-s):(e.down.isDown||n.s.isDown)&&(this.camera.scrollY=Math.min(this.worldHeight-this.camera.height,this.camera.scrollY+s))})}centerOnPlayer(){const e=this.scene.data.get("playerSprite");e&&this.camera.centerOn(e.x,e.y)}isDraggingObject(){return this.scene.data.get("isDraggingObject")===!0}getIsZoomedOut(){return this.isZoomedOut}toggleZoomToFit(){this.isZoomedOut?this.resetZoom():this.zoomToFit()}zoomToFit(){if(this.isZoomedOut||this.isAnimating)return;this.savedScrollX=this.camera.scrollX,this.savedScrollY=this.camera.scrollY,this.isZoomedOut=!0,this.isAnimating=!0,er(!0);const e=this.camera.width/this.worldWidth,n=this.camera.height/this.worldHeight;let i=Math.min(e,n);i=Math.max(i,bl);const r=this.worldWidth/2,s=this.worldHeight/2;this.camera.removeBounds(),this.camera.pan(r,s,Sn,"Sine.easeInOut"),this.camera.zoomTo(i,Sn,"Sine.easeInOut",!1,(a,o)=>{o===1&&(this.isAnimating=!1)})}resetZoom(){if(!this.isZoomedOut||this.isAnimating)return;this.isZoomedOut=!1,this.isAnimating=!0,er(!1);const e=this.savedScrollX+this.camera.width/2,n=this.savedScrollY+this.camera.height/2;this.camera.pan(e,n,Sn,"Sine.easeInOut"),this.camera.zoomTo(wl,Sn,"Sine.easeInOut",!1,(i,r)=>{r===1&&(this.camera.setBounds(0,0,this.worldWidth,this.worldHeight),this.isAnimating=!1)})}destroy(){}}class xl{scene;player;worldWidth;worldHeight;groundY;unsubscribers=[];constructor(e,n,i){this.scene=e,this.worldWidth=n,this.worldHeight=i,this.groundY=i-Hn}create(e,n){this.player=this.scene.add.sprite(e,n,"cat-idle-white",0),this.player.setScale(ir),this.player.setDepth(Ko);const i=new B.Geom.Rectangle(8,4,32,40);return this.player.setInteractive({hitArea:i,hitAreaCallback:B.Geom.Rectangle.Contains,draggable:!0,cursor:"grab"}),this.scene.data.set("playerSprite",this.player),this.setupDragHandlers(),this.setupEditModeSubscription(),this.player}setupEditModeSubscription(){const e=at.subscribe(n=>{if(n==="dialogs")this.player.disableInteractive(),this.player.setAlpha(.6);else{const i=new B.Geom.Rectangle(8,4,32,40);this.player.setInteractive({hitArea:i,hitAreaCallback:B.Geom.Rectangle.Contains,draggable:!0,cursor:"grab"}),this.player.setAlpha(1)}});this.unsubscribers.push(e)}setupDragHandlers(){this.player.on("dragstart",()=>{this.player.setTint(il),this.scene.data.set("isDraggingObject",!0)}),this.player.on("drag",(e,n,i)=>{const r=B.Math.Clamp(n,rr,this.worldWidth-rr),s=B.Math.Clamp(i,tl,this.worldHeight-nl);this.player.setPosition(r,s),Qi(Math.round(r),Math.round(s))}),this.player.on("dragend",()=>{this.player.clearTint(),this.scene.data.set("isDraggingObject",!1);let e=this.player.y;const n=Xo*ir;this.player.y+n/2>this.groundY&&(e=this.groundY-n/2,this.player.setY(e)),Qi(Math.round(this.player.x),Math.round(e))})}getSprite(){return this.player}destroy(){this.unsubscribers.forEach(e=>e()),this.unsubscribers=[],this.player&&this.player.destroy()}}class El{scene;graphics;worldWidth;worldHeight;constructor(e,n,i){this.scene=e,this.worldWidth=n,this.worldHeight=i}create(){return this.graphics=this.scene.add.graphics(),this.graphics.setDepth(Es),this.draw(),this.graphics}draw(){this.graphics.clear(),this.graphics.lineStyle(jo,zo,Uo);const e=Math.max(this.worldHeight,this.scene.scale.height);for(let i=0;i<=this.worldWidth;i+=Kt)this.graphics.beginPath(),this.graphics.moveTo(i,0),this.graphics.lineTo(i,e),this.graphics.strokePath();for(let i=0;i<=e;i+=Kt)this.graphics.beginPath(),this.graphics.moveTo(0,i),this.graphics.lineTo(this.worldWidth,i),this.graphics.strokePath();const n=this.worldHeight-Hn;this.graphics.lineStyle(Vo,ei,qo),this.graphics.beginPath(),this.graphics.moveTo(0,n),this.graphics.lineTo(this.worldWidth,n),this.graphics.strokePath(),this.graphics.lineStyle(Qo,ei,el),this.graphics.fillStyle(ei,Jo),this.graphics.fillRect(0,n,this.worldWidth,e-n)}getGraphics(){return this.graphics}redraw(){this.draw()}destroy(){this.graphics&&this.graphics.destroy()}}class Il{listeners=new Map;on(e,n){this.listeners.has(e)||this.listeners.set(e,new Set);const i=this.listeners.get(e);return i.add(n),{unsubscribe:()=>{i.delete(n),i.size===0&&this.listeners.delete(e)}}}once(e,n){const i=this.on(e,r=>{i.unsubscribe(),n(r)});return i}emit(e,n){const i=this.listeners.get(e);i&&i.forEach(r=>{try{r(n)}catch(s){console.error(`[EventBus] Error in listener for "${e}":`,s)}})}off(e){this.listeners.delete(e)}clear(){this.listeners.clear()}listenerCount(e){return this.listeners.get(e)?.size??0}}const St=new Il,xt={ASSET_DROPPED:"asset:dropped",FRAME_DROPPED:"frame:dropped",MINIMAP_NAVIGATE:"minimap:navigate",DIALOG_ZONE_CREATE:"dialogZone:create"};class Cl{scene;groundY;itemManager;unsubscribers=[];constructor(e,n){this.scene=e,this.groundY=n}create(e){return this.itemManager=new Nn(this.scene,this.groundY,!0),e&&e.length>0&&this.itemManager.createItems(e),this.setupBackgroundDeselect(),this.setupStoreSubscriptions(),this.setupAssetDropListener(),this.setupDeleteKeys(),this.itemManager}setupBackgroundDeselect(){this.itemManager.setupBackgroundDeselect()}setupStoreSubscriptions(){const e=ps.subscribe(s=>{this.scene.data.set("selectedItemId",s),this.itemManager.updateSelectionVisuals()});this.unsubscribers.push(e);const n=at.subscribe(s=>{s==="dialogs"?(Oi(),this.itemManager.setInteractiveEnabled(!1)):this.itemManager.setInteractiveEnabled(!0)});this.unsubscribers.push(n);let i=[];const r=xo.subscribe(s=>{if(!s?.placedItems)return;const a=s.placedItems;i.forEach(o=>{a.find(c=>c.id===o.id)||this.itemManager.removeItem(o.id)}),a.forEach(o=>{const l=i.find(c=>c.id===o.id);l&&JSON.stringify(l)!==JSON.stringify(o)&&this.itemManager.updateItem(o.id,o)}),i=a.map(o=>({...o}))});this.unsubscribers.push(r)}setupAssetDropListener(){const e=St.on(xt.ASSET_DROPPED,n=>{const{assetKey:i,canvasX:r,canvasY:s}=n,o=this.scene.cameras.main.getWorldPoint(r,s),l=o.x,c=o.y;let u="behind";vs.subscribe(g=>{u=g})();const f=Dn.createAtWorldPosition(i,l,c,this.groundY,u);Po(f),this.itemManager.createItem(f),Fn(f.id)});this.unsubscribers.push(()=>e.unsubscribe())}setupDeleteKeys(){const e=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.DELETE,!1),n=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.BACKSPACE,!1),i=()=>{if(an())return;const r=this.scene.data.get("selectedItemId");r&&ws(r)};e.on("down",i),n.on("down",i)}getManager(){return this.itemManager}destroy(){this.unsubscribers.forEach(e=>e()),this.unsubscribers=[],this.itemManager&&this.itemManager.destroy()}}function dr(t,e){return Math.round(t/e)*e}class ur{scene;frames=new Map;unsubscribers=[];selectionGraphics=null;isDragging=!1;dragStartX=0;dragStartY=0;doubleClickDetector=new _l;constructor(e){this.scene=e}static preloadAssets(e){for(let n=1;n<=25;n++)e.load.image(`frame_base_${n}`,`assets/frames/base ${n}.png`)}create(e){this.selectionGraphics=this.scene.add.graphics(),this.selectionGraphics.setDepth(Le.SELECTION_GRAPHICS),e&&e.length>0&&e.forEach(n=>this.createFrame(n)),this.setupBackgroundDeselect(),this.setupStoreSubscriptions(),this.setupFrameDropListener(),this.setupDeleteKeys()}createFrame(e){const n=`frame_${e.frameKey}`;if(!this.scene.textures.exists(n)){console.warn(`Frame texture not found: ${n}`);return}const i=e.scale??ot,r=e.depth??Le.ITEMS_FRONT,s=(e.rotation??0)*(Math.PI/180),a=e.rotation===90,{innerWidth:o,innerHeight:l}=sn(i,a),c=this.scene.add.graphics();c.setDepth(r-.1),Cn(c,e.x,e.y,o,l,e.backgroundColor||tn);const u=this.scene.add.sprite(e.x,e.y,n);u.setScale(i),u.setDepth(r),u.setOrigin(.5,.5),u.setRotation(s);const h={sprite:u,background:c,data:e};this.frames.set(e.id,h),this.makeInteractive(h,e.id)}updateFrameVisuals(e){const{sprite:n,background:i,data:r}=e,s=r.scale??ot;n.setScale(s);const a=(r.rotation??0)*(Math.PI/180);n.setRotation(a);const o=r.rotation===90,{innerWidth:l,innerHeight:c}=sn(s,o);Cn(i,n.x,n.y,l,c,r.backgroundColor||tn)}moveContainer(e,n,i){const{sprite:r,background:s,data:a}=e;r.setPosition(n,i);const o=a.scale??ot,l=a.rotation===90,{innerWidth:c,innerHeight:u}=sn(o,l);Cn(s,n,i,c,u,a.backgroundColor||tn)}makeInteractive(e,n){const{sprite:i}=e;i.setInteractive({draggable:!0,useHandCursor:!0}),i.on("pointerdown",r=>{if(!this.isDragging){if(en(n),this.updateSelectionVisuals(),this.doubleClickDetector.check(n)){Jt("frames");return}this.isDragging=!0,this.scene.data.set("isDraggingItem",!0),this.dragStartX=i.x-r.worldX,this.dragStartY=i.y-r.worldY}}),i.on("pointermove",r=>{if(!this.isDragging)return;if(!r.isDown){this.isDragging=!1;return}let s=r.worldX+this.dragStartX,a=r.worldY+this.dragStartY;_n(Kn)&&(s=dr(s,Kt),a=dr(a,Kt)),this.moveContainer(e,s,a),this.updateSelectionVisuals(),ko(n,s,a)}),i.on("pointerup",()=>{this.isDragging&&(this.isDragging=!1,this.scene.data.set("isDraggingItem",!1),Ao(n),e.data.x=Math.round(i.x),e.data.y=Math.round(i.y),gt(n,{x:e.data.x,y:e.data.y}))})}setupBackgroundDeselect(){this.scene.input.on("pointerdown",e=>{let n="items";if(at.subscribe(a=>n=a)(),n!=="frames")return;!this.scene.input.hitTestPointer(e).some(a=>{for(const[o,l]of this.frames)if(l.sprite===a)return!0;return!1})&&!this.isDragging&&(en(null),this.updateSelectionVisuals())})}setupStoreSubscriptions(){const e=_s.subscribe(s=>{this.scene.data.set("selectedFrameId",s),this.updateSelectionVisuals()});this.unsubscribers.push(e);const n=at.subscribe(s=>{s==="dialogs"?(en(null),this.setInteractiveEnabled(!1)):this.setInteractiveEnabled(!0)});this.unsubscribers.push(n);let i=[];const r=ys.subscribe(s=>{i.forEach(a=>{s.find(l=>l.id===a.id)||this.removeFrame(a.id)}),s.forEach(a=>{const o=i.find(c=>c.id===a.id),l=this.frames.get(a.id);if(l&&o){const c=o.backgroundColor!==a.backgroundColor,u=o.textColor!==a.textColor,h=o.textSize!==a.textSize,f=JSON.stringify(o.texts)!==JSON.stringify(a.texts),g=o.rotation!==a.rotation,p=o.scale!==a.scale;l.data=a,(c||u||h||f||g||p)&&(this.updateFrameVisuals(l),this.scene.data.get("selectedFrameId")===a.id&&this.updateSelectionVisuals())}}),i=s.map(a=>({...a}))});this.unsubscribers.push(r)}setupFrameDropListener(){const e=St.on(xt.FRAME_DROPPED,n=>{const{frameKey:i,canvasX:r,canvasY:s}=n,o=this.scene.cameras.main.getWorldPoint(r,s),l={id:ol(),frameKey:i,x:Math.round(o.x),y:Math.round(o.y),scale:ml(i),depth:Le.ITEMS_FRONT,rotation:90,backgroundColor:tn,textColor:"#333333",textSize:16,texts:[{language:"cs",text:""},{language:"en",text:""}]};Go(l),this.createFrame(l),en(l.id)});this.unsubscribers.push(()=>e.unsubscribe())}setupDeleteKeys(){const e=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.DELETE,!1),n=this.scene.input.keyboard.addKey(B.Input.Keyboard.KeyCodes.BACKSPACE,!1),i=()=>{if(an())return;let r="items";if(at.subscribe(o=>r=o)(),r!=="frames")return;const a=this.scene.data.get("selectedFrameId");a&&Ss(a)};e.on("down",i),n.on("down",i)}updateSelectionVisuals(){if(!this.selectionGraphics)return;this.selectionGraphics.clear();const e=this.scene.data.get("selectedFrameId");if(!e)return;const n=this.frames.get(e);if(!n)return;const r=n.sprite.getBounds();this.selectionGraphics.lineStyle(3,10181046,1),this.selectionGraphics.strokeRect(r.x-4,r.y-4,r.width+8,r.height+8);const s=8;this.selectionGraphics.fillStyle(10181046,1),this.selectionGraphics.fillRect(r.x-4-s/2,r.y-4-s/2,s,s),this.selectionGraphics.fillRect(r.right+4-s/2,r.y-4-s/2,s,s),this.selectionGraphics.fillRect(r.x-4-s/2,r.bottom+4-s/2,s,s),this.selectionGraphics.fillRect(r.right+4-s/2,r.bottom+4-s/2,s,s)}removeFrame(e){const n=this.frames.get(e);n&&(n.sprite.destroy(),n.background.destroy(),this.frames.delete(e)),this.updateSelectionVisuals()}setInteractiveEnabled(e){this.frames.forEach(({sprite:n,background:i})=>{e?(n.setInteractive({draggable:!0,useHandCursor:!0}),n.setAlpha(1),i.setAlpha(1)):(n.disableInteractive(),n.setAlpha(.6),i.setAlpha(.6))}),!e&&this.selectionGraphics&&this.selectionGraphics.clear()}destroy(){this.unsubscribers.forEach(e=>e()),this.unsubscribers=[],this.frames.forEach(({sprite:e,background:n})=>{e.destroy(),n.destroy()}),this.frames.clear(),this.selectionGraphics&&(this.selectionGraphics.destroy(),this.selectionGraphics=null)}}const xn=Es-1,ft=50,hr=150,Dl=.3,kl=.5,ti=16,fr=16777215,gr=.6,pr=0;class Al{scene;worldWidth;worldHeight;graphics=null;zoneAreas=new Map;leftHandles=new Map;rightHandles=new Map;dragging=null;unsubscribers=[];createZoneSubscription;currentEditMode="items";currentZones=[];currentSelectedId=null;constructor(e,n,i){this.scene=e,this.worldWidth=n,this.worldHeight=i}create(){this.graphics=this.scene.add.graphics(),this.graphics.setDepth(xn);const e=at.subscribe(r=>{this.currentEditMode=r,this.render()});this.unsubscribers.push(e);const n=Pi.subscribe(r=>{this.currentZones=r,this.render()});this.unsubscribers.push(n);const i=ms.subscribe(r=>{this.currentSelectedId=r,this.render()});this.unsubscribers.push(i),this.scene.input.on("pointermove",this.handlePointerMove,this),this.scene.input.on("pointerup",this.handlePointerUp,this),this.scene.input.on("pointerdown",this.handlePointerDown,this),this.createZoneSubscription=St.on(xt.DIALOG_ZONE_CREATE,()=>{this.createNewZone()}),this.render()}clearVisuals(){this.graphics&&this.graphics.clear(),this.zoneAreas.forEach(e=>e.destroy()),this.zoneAreas.clear(),this.leftHandles.forEach(e=>e.destroy()),this.leftHandles.clear(),this.rightHandles.forEach(e=>e.destroy()),this.rightHandles.clear()}render(){if(this.clearVisuals(),this.currentEditMode==="dialogs")for(const e of this.currentZones)this.renderZone(e,e.id===this.currentSelectedId)}renderZone(e,n){if(!this.graphics)return;const i=B.Display.Color.HexStringToColor(e.color).color,r=n?kl:Dl;this.graphics.fillStyle(i,r),this.graphics.fillRect(e.x,0,e.width,this.worldHeight),this.graphics.lineStyle(2,i,.8),this.graphics.strokeRect(e.x,0,e.width,this.worldHeight);const s=this.scene.add.rectangle(e.x+e.width/2,this.worldHeight/2,e.width-ti*2,this.worldHeight);s.setOrigin(.5,.5),s.setInteractive({cursor:n?"grab":"pointer"}),s.setDepth(xn+.1),s.setAlpha(.001),s.setData("zoneId",e.id),s.on("pointerdown",a=>{this.scene.data.set("isDraggingItem",!0),this.currentSelectedId===e.id?this.startDrag(e.id,"move",a.worldX):(En(e.id),this.scene.data.set("isDraggingItem",!1))}),this.zoneAreas.set(e.id,s),n&&this.createHandles(e)}createHandles(e){const n=this.scene.add.rectangle(e.x,this.worldHeight/2,ti,this.worldHeight);n.setOrigin(.5,.5),n.setInteractive({cursor:"ew-resize"}),n.setDepth(xn+.2),n.setFillStyle(fr,gr),n.setData("zoneId",e.id),n.setData("type","left"),n.on("pointerdown",r=>{this.startDrag(e.id,"left",r.worldX)}),this.leftHandles.set(e.id,n);const i=this.scene.add.rectangle(e.x+e.width,this.worldHeight/2,ti,this.worldHeight);i.setOrigin(.5,.5),i.setInteractive({cursor:"ew-resize"}),i.setDepth(xn+.2),i.setFillStyle(fr,gr),i.setData("zoneId",e.id),i.setData("type","right"),i.on("pointerdown",r=>{this.startDrag(e.id,"right",r.worldX)}),this.rightHandles.set(e.id,i)}startDrag(e,n,i){const r=this.currentZones.find(s=>s.id===e);r&&(this.scene.data.set("isDraggingItem",!0),this.dragging={zoneId:e,type:n,startX:i,originalX:r.x,originalWidth:r.width})}getZoneBounds(e){let n=0,i=this.worldWidth;for(const r of this.currentZones){if(r.id===e)continue;const s=r.x+r.width,a=this.currentZones.find(o=>o.id===e);a&&(s<=a.x+a.width/2&&(n=Math.max(n,s+pr)),r.x>=a.x+a.width/2&&(i=Math.min(i,r.x-pr)))}return{minX:n,maxX:i-ft,maxRight:i}}wouldOverlap(e,n,i){const r=n+i;for(const s of this.currentZones){if(s.id===e)continue;const a=s.x,o=s.x+s.width;if(n<o&&r>a)return!0}return!1}handlePointerMove(e){if(!this.dragging)return;e.event?.stopPropagation?.();const n=e.worldX-this.dragging.startX,i=this.currentZones.find(s=>s.id===this.dragging?.zoneId);if(!i)return;const r=this.getZoneBounds(i.id);if(this.dragging.type==="left"){let s=this.dragging.originalX+n,a=this.dragging.originalWidth-n;if(s<0&&(a+=s,s=0),a<ft&&(s=this.dragging.originalX+this.dragging.originalWidth-ft,a=ft),s<r.minX){const o=r.minX-s;s=r.minX,a-=o}a>=ft&&!this.wouldOverlap(i.id,s,a)&&Qt(i.id,{x:s,width:a})}else if(this.dragging.type==="right"){let s=this.dragging.originalWidth+n;s<ft&&(s=ft),i.x+s>this.worldWidth&&(s=this.worldWidth-i.x),i.x+s>r.maxRight&&(s=r.maxRight-i.x),s>=ft&&!this.wouldOverlap(i.id,i.x,s)&&Qt(i.id,{width:s})}else if(this.dragging.type==="move"){let s=this.dragging.originalX+n;const a=i.width;if(s<0&&(s=0),s+a>this.worldWidth&&(s=this.worldWidth-a),!this.wouldOverlap(i.id,s,a))Qt(i.id,{x:s});else{const o=this.findNonOverlappingPosition(i.id,s,a);o!==null&&Qt(i.id,{x:o})}}}findNonOverlappingPosition(e,n,i){const r=this.currentZones.filter(u=>u.id!==e).sort((u,h)=>u.x-h.x);if(r.length===0)return Math.max(0,Math.min(n,this.worldWidth-i));let s=n,a=1/0;const o=r[0];if(o.x>=i){const u=o.x-i,h=Math.max(0,Math.min(n,u)),f=Math.abs(h-n);f<a&&(a=f,s=h)}for(let u=0;u<r.length-1;u++){const h=r[u],f=r[u+1],g=h.x+h.width,p=f.x;if(p-g>=i){const _=g,v=p-i,w=Math.max(_,Math.min(n,v)),b=Math.abs(w-n);b<a&&(a=b,s=w)}}const l=r[r.length-1],c=l.x+l.width;if(this.worldWidth-c>=i){const u=c,h=this.worldWidth-i,f=Math.max(u,Math.min(n,h)),g=Math.abs(f-n);g<a&&(a=g,s=f)}return a<1/0&&!this.wouldOverlap(e,s,i)?s:null}handlePointerUp(){this.dragging&&this.scene.data.set("isDraggingItem",!1),this.dragging=null}handlePointerDown(e){if(this.currentEditMode!=="dialogs"||this.dragging)return;const n=e.downElement;if(n&&n.tagName?.toUpperCase()!=="CANVAS")return;const i=e.worldX;for(const r of this.currentZones)if(i>=r.x&&i<=r.x+r.width)return;this.currentSelectedId&&En(null)}createNewZone(){const e=this.scene.cameras.main;let i=e.scrollX+e.width/2-hr/2;const r=hr;if(i=Math.max(0,Math.min(this.worldWidth-r,i)),this.wouldOverlap("",i,r)){const a=this.findNonOverlappingPosition("",i,r);if(a===null){console.warn("No room for a new dialog zone");return}i=a}const s=so(i,r);s.x=i,Bo(s),En(s.id)}destroy(){for(const e of this.unsubscribers)e();this.unsubscribers=[],this.createZoneSubscription&&this.createZoneSubscription.unsubscribe(),this.scene.input.off("pointerdown",this.handlePointerDown,this),this.scene.input.off("pointermove",this.handlePointerMove,this),this.scene.input.off("pointerup",this.handlePointerUp,this),this.clearVisuals(),this.graphics&&(this.graphics.destroy(),this.graphics=null),this.dragging=null}}class Tl extends B.Scene{parallaxLayers=null;cameraController;playerController;gridOverlay;itemsController;framesController;dialogZoneRenderer;config;minimapSubscription;isShuttingDown=!1;get itemManager(){return this.itemsController?.getManager()}toggleZoom(){this.cameraController?.toggleZoomToFit()}constructor(){super({key:lt.BUILDER})}init(e){this.config=e.config}preload(){this.load.spritesheet("cat-idle-white","assets/sprites/white/Idle.png",{frameWidth:48,frameHeight:48}),Nn.preloadAssets(this),ur.preloadAssets(this)}create(){this.isShuttingDown=!1,this.physics.world.setBounds(0,0,this.config.worldWidth,this.config.worldHeight);const e=this.config.worldHeight-Hn;this.cameraController=new Sl(this,this.config.worldWidth,this.config.worldHeight),this.playerController=new xl(this,this.config.worldWidth,this.config.worldHeight),this.gridOverlay=new El(this,this.config.worldWidth,this.config.worldHeight),this.itemsController=new Cl(this,e),this.framesController=new ur(this),this.dialogZoneRenderer=new Al(this,this.config.worldWidth,this.config.worldHeight),this.createBackground(),this.gridOverlay.create(),this.createGroundReference(),this.playerController.create(this.config.playerStartX,this.config.playerStartY),this.itemsController.create(this.config.placedItems||[]),this.framesController.create(this.config.placedFrames||[]),this.dialogZoneRenderer.create(),this.cameraController.setup(),this.cameraController.centerOn(this.config.playerStartX,this.config.playerStartY),this.minimapSubscription=St.on(xt.MINIMAP_NAVIGATE,n=>{this.navigateToPosition(n.worldX,n.worldY)}),this.scale.on("resize",this.handleResize,this),this.events.on("shutdown",this.shutdown,this)}async createBackground(){const e=Rn.getCurrentConfig();try{await ds(this,e)}catch(n){console.error("Failed to load background:",n);return}this.parallaxLayers&&(bo(this.parallaxLayers),this.parallaxLayers=null),this.parallaxLayers=us(this,this.config.worldWidth,this.config.worldHeight,e)}createGroundReference(){fn.createVisualGround(this,{worldWidth:this.config.worldWidth,worldHeight:this.config.worldHeight,height:Hn})}update(){this.parallaxLayers&&hs(this.parallaxLayers.baseLayer,this.cameras.main);const e=this.cameras.main,n=this.data.get("playerSprite");No({scrollX:e.worldView.x,scrollY:e.worldView.y,viewWidth:e.width,viewHeight:e.height,worldWidth:this.config.worldWidth,worldHeight:this.config.worldHeight,zoom:e.zoom,playerX:n?.x??this.config.playerStartX,playerY:n?.y??this.config.playerStartY})}navigateToPosition(e,n){this.cameraController.getIsZoomedOut()||this.cameraController.centerOn(e,n)}handleResize(e){if(!(!this.cameras?.main||!this.config)){if(this.cameraController?.getIsZoomedOut()||this.cameras.main.setBounds(0,0,this.config.worldWidth,this.config.worldHeight),this.parallaxLayers?.baseLayer){const n=Math.max(this.config.worldHeight,e.height);this.parallaxLayers.baseLayer.setSize(this.config.worldWidth,n)}this.gridOverlay&&this.gridOverlay.redraw()}}shutdown(){this.isShuttingDown||(this.isShuttingDown=!0,this.scale.off("resize",this.handleResize,this),this.minimapSubscription&&this.minimapSubscription.unsubscribe(),this.cameraController&&this.cameraController.destroy(),this.playerController&&this.playerController.destroy(),this.gridOverlay&&this.gridOverlay.destroy(),this.itemsController&&this.itemsController.destroy(),this.framesController&&this.framesController.destroy(),this.dialogZoneRenderer&&this.dialogZoneRenderer.destroy())}}const Ml="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Ml);na();class Pl{currentLanguage="cs";setLanguage(e){this.currentLanguage=e,localStorage.setItem("language",e)}getLanguage(){const e=localStorage.getItem("language");return(e==="cs"||e==="en")&&(this.currentLanguage=e),this.currentLanguage}toggleLanguage(){return this.currentLanguage=this.currentLanguage==="cs"?"en":"cs",this.setLanguage(this.currentLanguage),this.currentLanguage}}const As=new Pl;let Ne=null;function Ll(t){Ne=t}function Ol(){if(!Ne)return console.error("Scene manager not initialized"),null;try{return Ne.scene.getScene(lt.GAME)?.mapConfig||null}catch(t){return console.error("Failed to get map config:",t),null}}function Rl(t){if(!Ne)return console.error("Scene manager not initialized"),!1;try{return Ne.scene.getScene(lt.GAME)?(Ne.scene.stop(lt.GAME),$o(t),Ne.scene.start(lt.BUILDER,{config:t}),!0):(console.error("GameScene not found"),!1)}catch(e){return console.error("Failed to switch to builder:",e),!1}}function $l(){if(!Ne)return console.error("Scene manager not initialized"),!1;try{return Ne.scene.stop(lt.BUILDER),Fo(),Ne.scene.start(lt.GAME,{useBuilderConfig:!0}),!0}catch(t){return console.error("Failed to switch to game:",t),!1}}function Fl(){if(Ne)try{Ne.scene.getScene(lt.BUILDER)?.toggleZoom()}catch(t){console.error("Failed to toggle zoom:",t)}}var Hl=R('<button class="close-btn svelte-yrmttr" title="Close">×</button>'),Nl=R('<div class="resize-handle resize-handle-sw svelte-yrmttr"><svg width="10" height="10" viewBox="0 0 10 10" class="svelte-yrmttr"><path d="M1 1L9 9M1 5L5 9M1 9L1 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></div> <div class="resize-handle resize-handle-se svelte-yrmttr"><svg width="10" height="10" viewBox="0 0 10 10" class="svelte-yrmttr"><path d="M9 1L1 9M9 5L5 9M9 9L9 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></div>',1),Bl=R("<div><!></div> <!>",1),Zl=R('<div><div class="panel-header svelte-yrmttr"><span class="panel-title svelte-yrmttr"> </span> <!> <div class="header-buttons svelte-yrmttr"><button class="minimize-btn svelte-yrmttr"> </button> <!></div></div> <!></div>');function zn(t,e){xe(e,!0);let n=J(e,"initialRight",3,10),i=J(e,"initialTop",3,60),r=J(e,"width",3,280),s=J(e,"minWidth",3,200),a=J(e,"minHeight",3,100),o=J(e,"maxWidth",3,600),l=J(e,"maxHeight",3,800),c=J(e,"resizable",3,!1),u=J(e,"startMinimized",3,!1),h=J(e,"showClose",3,!1),f=z(je(u())),g=z(je({x:0,y:0})),p=z(je({width:r(),height:e.height??0})),x=z(!1),_=z(!1),v=z("se"),w=z(je({x:0,y:0})),b=z(null),D=z(!1);bt(()=>{if(typeof window>"u")return;const C=localStorage.getItem(`panel-state-${e.panelId}`);if(C)try{const Z=JSON.parse(C);H(g,{x:Z.x,y:Z.y},!0),c()&&Z.width&&Z.height&&H(p,{width:Z.width,height:Z.height},!0)}catch{H(g,{x:window.innerWidth-r()-n(),y:i()},!0)}else H(g,{x:window.innerWidth-r()-n(),y:i()},!0);H(D,!0)}),bt(()=>{if(!d(D))return;const C=c()?{...d(g),width:d(p).width,height:d(p).height}:d(g);localStorage.setItem(`panel-state-${e.panelId}`,JSON.stringify(C))}),bt(()=>{if(!d(D))return;function C(){if(!d(b))return;const Z=c()?d(p).width:r();let X=d(g).x,_e=d(g).y,ce=!1;const ee=window.innerWidth-Z;d(g).x>ee&&(X=Math.max(10,ee),ce=!0);const ye=window.innerHeight-40;d(g).y>ye&&(_e=Math.max(10,ye),ce=!0),d(g).x<0&&(X=10,ce=!0),d(g).y<0&&(_e=10,ce=!0),ce&&H(g,{x:X,y:_e},!0)}return window.addEventListener("resize",C),C(),()=>{window.removeEventListener("resize",C)}});function I(){H(f,!d(f))}function E(){e.onclose?.()}function A(C){C.target.closest("button")||(H(x,!0),H(w,{x:C.clientX-d(g).x,y:C.clientY-d(g).y},!0),C.currentTarget.setPointerCapture(C.pointerId),C.preventDefault())}function L(C){if(!d(x))return;const Z=C.clientX-d(w).x,X=C.clientY-d(w).y,_e=window.innerWidth-(d(b)?.offsetWidth??r()),ce=window.innerHeight-40;H(g,{x:Math.max(0,Math.min(Z,_e)),y:Math.max(0,Math.min(X,ce))},!0)}function k(C){d(x)&&(H(x,!1),C.currentTarget.releasePointerCapture(C.pointerId))}function m(C){return Z=>{c()&&(H(_,!0),H(v,C,!0),Z.currentTarget.setPointerCapture(Z.pointerId),Z.preventDefault(),Z.stopPropagation())}}function P(C){if(!d(_)||!d(b))return;const Z=d(b).getBoundingClientRect();let X,_e=C.clientY-Z.top,ce=d(g).x;d(v)==="se"?X=C.clientX-Z.left:(X=Z.right-C.clientX,ce=C.clientX);const ee=Math.max(s(),Math.min(o(),X)),ye=Math.max(a(),Math.min(l(),_e));d(v)==="sw"&&(ce=Z.right-ee,ce<0&&(ce=0));const we=d(v)==="se"?window.innerWidth-d(g).x-10:Z.right-10,Ke=window.innerHeight-d(g).y-10,Re=Math.min(ee,we),nt=Math.min(ye,Ke);H(p,{width:Re,height:nt},!0),d(v)==="sw"&&X>=s()&&H(g,{...d(g),x:Math.max(0,ce)},!0)}function O(C){d(_)&&(H(_,!1),C.currentTarget.releasePointerCapture(C.pointerId))}function y(C){C.stopPropagation()}var F=Zl();let V;F.__pointerdown=y,F.__click=y;var N=M(F);N.__pointerdown=A,N.__pointermove=L,N.__pointerup=k;var de=M(N),Ge=M(de),We=T(de,2);{var Te=C=>{var Z=Xe(),X=ae(Z);Xt(X,()=>e.headerExtra),S(C,Z)};U(We,C=>{e.headerExtra&&C(Te)})}var ie=T(We,2),ue=M(ie);ue.__click=I;var fe=M(ue),re=T(ue,2);{var se=C=>{var Z=Hl();Z.__click=E,S(C,Z)};U(re,C=>{h()&&C(se)})}var q=T(N,2);{var Q=C=>{var Z=Bl(),X=ae(Z);let _e;var ce=M(X);Xt(ce,()=>e.children);var ee=T(X,2);{var ye=we=>{var Ke=Nl(),Re=ae(Ke),nt=$(()=>m("sw"));Re.__pointerdown=function(...jn){d(nt)?.apply(this,jn)},Re.__pointermove=P,Re.__pointerup=O;var Et=T(Re,2),Un=$(()=>m("se"));Et.__pointerdown=function(...jn){d(Un)?.apply(this,jn)},Et.__pointermove=P,Et.__pointerup=O,wt("pointercancel",Re,O),wt("pointercancel",Et,O),S(we,Ke)};U(ee,we=>{c()&&we(ye)})}j(()=>_e=Ze(X,1,"panel-body svelte-yrmttr",null,_e,{"has-fixed-height":c()&&d(p).height>0})),S(C,Z)};U(q,C=>{d(f)||C(Q)})}Di(F,C=>H(b,C),()=>d(b)),j(()=>{V=Ze(F,1,"draggable-panel svelte-yrmttr",null,V,{minimized:d(f),dragging:d(x),resizing:d(_),resizable:c()}),ve(F,`left: ${d(g).x??""}px; top: ${d(g).y??""}px; width: ${d(f)?"auto":`${c()?d(p).width:r()}px`}; ${c()&&d(p).height>0&&!d(f)?`height: ${d(p).height}px;`:""}`),he(Ge,e.title),oe(ue,"title",d(f)?"Expand":"Minimize"),he(fe,d(f)?"▲":"▼")}),wt("pointercancel",N,k),S(t,F),Ee()}tt(["pointerdown","click","pointermove","pointerup"]);function Ts(t,e,n){const{previewSize:i,borderColor:r,dataKey:s,eventName:a}=t,o=i/2;function l(v,w){if(!v.dataTransfer)return;n({draggedKey:w}),wn(!0),v.dataTransfer.effectAllowed="copy",v.dataTransfer.setData(s,w);const D=v.target.querySelector("img")?.cloneNode(!0);D&&(D.style.position="absolute",D.style.top="-1000px",document.body.appendChild(D),v.dataTransfer.setDragImage(D,o,o),setTimeout(()=>D.remove(),0))}function c(){n({draggedKey:null}),wn(!1)}function u(v,w){if(v.touches.length!==1)return;const b=v.touches[0];n({draggedKey:w}),wn(!0);const I=v.currentTarget.querySelector("img");if(I){const E=document.createElement("div");E.className="touch-drag-preview",E.innerHTML=`<img src="${I.src}" alt="" />`,E.style.cssText=`
        position: fixed;
        top: ${b.clientY-o}px;
        left: ${b.clientX-o}px;
        width: ${i}px;
        height: ${i}px;
        pointer-events: none;
        z-index: 10000;
        opacity: 0.9;
        image-rendering: pixelated;
        filter: drop-shadow(3px 3px 0 rgba(0, 0, 0, 0.5));
        border: 2px solid ${r};
        background: rgba(26, 26, 46, 0.9);
      `,E.querySelector("img").style.cssText=`
        width: 100%;
        height: 100%;
        object-fit: contain;
        image-rendering: pixelated;
      `,document.body.appendChild(E),n({touchDragElement:E})}}function h(v){const w=e();if(!w.draggedKey||!w.touchDragElement)return;const b=v.touches[0];w.touchDragElement.style.top=`${b.clientY-o}px`,w.touchDragElement.style.left=`${b.clientX-o}px`,v.preventDefault()}function f(v){const w=e();if(!w.draggedKey)return;const b=v.changedTouches[0],D=document.querySelector("canvas");if(w.touchDragElement&&(w.touchDragElement.remove(),n({touchDragElement:null})),D){const I=D.getBoundingClientRect(),E=b.clientX,A=b.clientY;if(E>=I.left&&E<=I.right&&A>=I.top&&A<=I.bottom){const L=E-I.left,k=A-I.top;St.emit(a,{[s]:w.draggedKey,canvasX:L,canvasY:k})}}n({draggedKey:null}),wn(!1)}function g(v){v.preventDefault(),v.dataTransfer&&(v.dataTransfer.dropEffect="copy")}function p(v){v.preventDefault();const w=v.dataTransfer?.getData(s);if(!w)return;const D=v.target.getBoundingClientRect(),I=v.clientX-D.left,E=v.clientY-D.top;St.emit(a,{[s]:w,canvasX:I,canvasY:E})}function x(){const v=document.querySelector("canvas");return v?(v.addEventListener("dragover",g),v.addEventListener("drop",p),()=>{v.removeEventListener("dragover",g),v.removeEventListener("drop",p)}):()=>{}}function _(){return document.addEventListener("touchmove",h,{passive:!1}),document.addEventListener("touchend",f),document.addEventListener("touchcancel",f),()=>{document.removeEventListener("touchmove",h),document.removeEventListener("touchend",f),document.removeEventListener("touchcancel",f)}}return{onDragStart:l,onDragEnd:c,onTouchStart:u,onTouchMove:h,onTouchEnd:f,setupCanvasListeners:x,setupTouchListeners:_}}var Gl=R('<span class="palette-hint svelte-1ahretz">Drag to place</span>'),Wl=R('<div draggable="true" role="button" tabindex="0"><img class="item-preview svelte-1ahretz"/> <span class="item-name svelte-1ahretz"> </span></div>'),Yl=R('<div class="palette-content svelte-1ahretz" role="toolbar" tabindex="-1"><div class="palette-grid svelte-1ahretz"></div></div>');function Xl(t,e){xe(e,!0);const n=()=>G(un,"$isAssetPaletteOpen",r),i=()=>G(at,"$builderEditMode",r),[r,s]=ht(),a="#4a90e2",o=$i;let l=z(null),c=z(null);const u=Ts({previewSize:48,borderColor:a,dataKey:"assetKey",eventName:xt.ASSET_DROPPED},()=>({draggedKey:d(l),touchDragElement:d(c)}),_=>{"draggedKey"in _&&H(l,_.draggedKey??null,!0),"touchDragElement"in _&&H(c,_.touchDragElement??null,!0)});function h(_){_.stopPropagation()}function f(){un.set(!1)}ki(()=>u.setupCanvasListeners()),bt(()=>u.setupTouchListeners());var g=Xe(),p=ae(g);{var x=_=>{zn(_,{panelId:"asset-palette",title:"Assets",initialRight:10,initialTop:60,width:280,height:400,minWidth:200,minHeight:160,maxWidth:500,maxHeight:600,resizable:!0,showClose:!0,onclose:f,headerExtra:w=>{var b=Gl();S(w,b)},children:(w,b)=>{var D=Yl();D.__pointerdown=h;var I=M(D);Pt(I,21,()=>o,Wt,(E,A)=>{var L=Wl();let k;L.__touchstart=y=>u.onTouchStart(y,d(A).key),ve(L,"",{},{"--accent-color":a});var m=M(L),P=T(m,2),O=M(P);j(()=>{k=Ze(L,1,"palette-item svelte-1ahretz",null,k,{dragging:d(l)===d(A).key}),oe(L,"title",d(A).name),oe(m,"src",d(A).path),oe(m,"alt",d(A).name),he(O,d(A).name)}),wt("dragstart",L,y=>u.onDragStart(y,d(A).key)),wt("dragend",L,function(...y){u.onDragEnd?.apply(this,y)}),S(E,L)}),S(w,D)},$$slots:{headerExtra:!0,default:!0}})};U(p,_=>{n()&&i()==="items"&&_(x)})}S(t,g),Ee(),s()}tt(["pointerdown","touchstart"]);var Kl=R('<span class="palette-hint svelte-jnw59q">Drag to place</span>'),zl=R('<div draggable="true" role="button" tabindex="0"><img class="item-preview item-preview--landscape svelte-jnw59q"/> <span class="item-name svelte-jnw59q"> </span></div>'),Ul=R('<div class="palette-content svelte-jnw59q" role="toolbar" tabindex="-1"><div class="palette-grid svelte-jnw59q"></div></div>');function jl(t,e){xe(e,!0);const n=()=>G(hn,"$isFramePaletteOpen",r),i=()=>G(at,"$builderEditMode",r),[r,s]=ht(),a="#9b59b6",o=Ds;let l=z(null),c=z(null);const u=Ts({previewSize:64,borderColor:a,dataKey:"frameKey",eventName:xt.FRAME_DROPPED},()=>({draggedKey:d(l),touchDragElement:d(c)}),_=>{"draggedKey"in _&&H(l,_.draggedKey??null,!0),"touchDragElement"in _&&H(c,_.touchDragElement??null,!0)});function h(_){_.stopPropagation()}function f(){hn.set(!1)}ki(()=>u.setupCanvasListeners()),bt(()=>u.setupTouchListeners());var g=Xe(),p=ae(g);{var x=_=>{zn(_,{panelId:"frame-palette",title:"Frames",initialRight:10,initialTop:60,width:320,height:400,minWidth:220,minHeight:200,maxWidth:600,maxHeight:600,resizable:!0,showClose:!0,onclose:f,headerExtra:w=>{var b=Kl();S(w,b)},children:(w,b)=>{var D=Ul();D.__pointerdown=h;var I=M(D);Pt(I,21,()=>o,Wt,(E,A)=>{var L=zl();let k;L.__touchstart=y=>u.onTouchStart(y,d(A).key),ve(L,"",{},{"--accent-color":a});var m=M(L),P=T(m,2),O=M(P);j(()=>{k=Ze(L,1,"palette-item svelte-jnw59q",null,k,{dragging:d(l)===d(A).key}),oe(L,"title",d(A).name),oe(m,"src",d(A).path),oe(m,"alt",d(A).name),he(O,d(A).name)}),wt("dragstart",L,y=>u.onDragStart(y,d(A).key)),wt("dragend",L,function(...y){u.onDragEnd?.apply(this,y)}),S(E,L)}),S(w,D)},$$slots:{headerExtra:!0,default:!0}})};U(p,_=>{n()&&i()==="frames"&&_(x)})}S(t,g),Ee(),s()}tt(["pointerdown","touchstart"]);var Vl=R("<button><!></button>");function Ce(t,e){let n=J(e,"variant",3,"default"),i=J(e,"disabled",3,!1),r=J(e,"title",3,"");const s={default:{base:"#4a90e2",hover:"#357abd",active:"#2a5f8f"},green:{base:"#27ae60",hover:"#229954",active:"#1e8449"},blue:{base:"#3498db",hover:"#2980b9",active:"#21618c"},orange:{base:"#ffa500",hover:"#ff8c00",active:"#e67e00"},red:{base:"#e74c3c",hover:"#c0392b",active:"#a02e22"},purple:{base:"#9b59b6",hover:"#8e44ad",active:"#7d3c98"},cyan:{base:"#17a2b8",hover:"#138496",active:"#0f6674"}},a=$(()=>s[n()]),o=$(()=>e.width?`--btn-width: ${e.width};`:"");var l=Vl();let c;l.__click=function(...h){e.onclick?.apply(this,h)};var u=M(l);Xt(u,()=>e.children??Be),j(()=>{c=Ze(l,1,"pixel-btn svelte-lwc0vq",null,c,{disabled:i()}),ve(l,`${d(o)??""} --color-base: ${d(a).base??""}; --color-hover: ${d(a).hover??""}; --color-active: ${d(a).active??""}`),l.disabled=i(),oe(l,"title",r())}),S(t,l)}tt(["click"]);var ql=R('<div><div class="minimap-bg svelte-1ycb7lo"></div> <div class="viewport-indicator svelte-1ycb7lo"></div> <div class="player-marker svelte-1ycb7lo"></div> <div class="minimap-frame svelte-1ycb7lo"></div></div>');function Jl(t,e){xe(e,!0);const n=()=>G(Ri,"$builderCameraInfo",r),i=()=>G(yn,"$isBuilderZoomedOut",r),[r,s]=ht(),a=120,o=60,l=200,c=100;let u=z(!1),h=z(null),f=$(()=>d(u)?l:a),g=$(()=>d(u)?c:o),p=$(()=>{const m=n();if(!m||m.worldWidth===0)return"display: none;";const P=d(f)/m.worldWidth,O=d(g)/m.worldHeight,y=m.viewWidth/m.zoom*P,F=m.viewHeight/m.zoom*O,V=m.scrollX*P,N=m.scrollY*O;return`
      left: ${Math.max(0,V)}px;
      top: ${Math.max(0,N)}px;
      width: ${Math.min(y,d(f)-V)}px;
      height: ${Math.min(F,d(g)-N)}px;
    `}),x=$(()=>{const m=n();if(!m||m.worldWidth===0)return"display: none;";const P=d(f)/m.worldWidth,O=d(g)/m.worldHeight,y=m.playerX*P,F=m.playerY*O;return`
      left: ${y}px;
      top: ${F}px;
    `});function _(m,P){const O=n();if(!O||O.worldWidth===0||!d(h))return;const y=d(h).getBoundingClientRect(),F=m-y.left,V=P-y.top,N=F/d(f)*O.worldWidth,de=V/d(g)*O.worldHeight;St.emit(xt.MINIMAP_NAVIGATE,{worldX:N,worldY:de})}function v(m){m.stopPropagation(),m.preventDefault(),H(u,!0),_(m.clientX,m.clientY),window.addEventListener("mousemove",w),window.addEventListener("mouseup",b)}function w(m){d(u)&&(m.preventDefault(),_(m.clientX,m.clientY))}function b(){H(u,!1),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",b)}function D(m){m.stopPropagation(),m.preventDefault(),H(u,!0);const P=m.touches[0];_(P.clientX,P.clientY),window.addEventListener("touchmove",I,{passive:!1}),window.addEventListener("touchend",E)}function I(m){if(!d(u))return;m.preventDefault();const P=m.touches[0];_(P.clientX,P.clientY)}function E(){H(u,!1),window.removeEventListener("touchmove",I),window.removeEventListener("touchend",E)}var A=Xe(),L=ae(A);{var k=m=>{var P=ql();let O;P.__mousedown=v,P.__touchstart=D;var y=T(M(P),2),F=T(y,2);Di(P,V=>H(h,V),()=>d(h)),j(()=>{O=Ze(P,1,"minimap-container svelte-1ycb7lo",null,O,{enlarged:d(u)}),ve(P,`width: ${d(f)??""}px; height: ${d(g)??""}px;`),ve(y,d(p)),ve(F,d(x))}),S(m,P)};U(L,m=>{i()||m(k)})}S(t,A),Ee(),s()}tt(["mousedown","touchstart"]);var Ql=R('<div class="landscape-hint svelte-ugg786"><div class="hint-content svelte-ugg786"><div class="rotate-icon svelte-ugg786">📱↻</div> <p class="hint-text svelte-ugg786">Rotate your phone for a better experience</p> <button class="dismiss-btn svelte-ugg786">OK</button></div></div>');function ec(t,e){xe(e,!0);let n=z(!0),i=z(!1);const r="landscapeHintDismissed";ki(()=>{sessionStorage.getItem(r)||(H(i,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window&&window.innerWidth<=768,!0),d(i)&&H(n,!1))});function s(){H(n,!0),sessionStorage.setItem(r,"true")}var a=Xe(),o=ae(a);{var l=c=>{var u=Ql(),h=M(u),f=T(M(h),4);f.__click=s,S(c,u)};U(o,c=>{!d(n)&&d(i)&&c(l)})}S(t,a),Ee()}tt(["click"]);var tc=R("<button> </button>"),nc=R('<div class="language-tabs svelte-ng6pis"></div>');function Ms(t,e){xe(e,!0);let n=J(e,"accentColor",3,"#88ddff");var i=nc();Pt(i,21,()=>wo,Wt,(r,s)=>{var a=tc();let o;a.__click=()=>e.onselect(d(s).code);let l;var c=M(a);j(()=>{o=Ze(a,1,"lang-tab svelte-ng6pis",null,o,{active:e.selectedLanguage===d(s).code}),l=ve(a,"",l,{"--accent-color":n()}),he(c,d(s).label)}),S(r,a)}),S(t,i),Ee()}tt(["click"]);var ic=R("<button></button>"),rc=R('<div class="color-picker svelte-1jc3e0j"></div>'),sc=R('<div class="color-section svelte-1jc3e0j"><span class="color-label-title svelte-1jc3e0j"> </span> <button class="color-button svelte-1jc3e0j" title="Change color"><span class="color-preview svelte-1jc3e0j"></span> <span class="color-label svelte-1jc3e0j">Change</span></button> <!></div>');function gi(t,e){xe(e,!0);let n=J(e,"label",3,"Color"),i=J(e,"accentColor",3,"#88ddff"),r=z(!1);function s(_){e.onselect(_),H(r,!1)}function a(){H(r,!d(r))}var o=sc(),l=M(o),c=M(l),u=T(l,2);u.__click=a;let h;var f=M(u);let g;var p=T(u,2);{var x=_=>{var v=rc();Pt(v,21,()=>e.colors,Wt,(w,b)=>{var D=ic();let I;D.__click=()=>s(d(b));let E;j(()=>{I=Ze(D,1,"color-swatch svelte-1jc3e0j",null,I,{selected:e.selectedColor===d(b)}),oe(D,"title",d(b)),E=ve(D,"",E,{background:d(b),"--accent-color":i()})}),S(w,D)}),S(_,v)};U(p,_=>{d(r)&&_(x)})}j(()=>{he(c,n()),h=ve(u,"",h,{"--accent-color":i()}),g=ve(f,"",g,{background:e.selectedColor})}),S(t,o),Ee()}tt(["click"]);const vr=50,mr=400,ac=400,oc=70;var lc=R('<div class="form-section svelte-jhtkop"><div class="form-group svelte-jhtkop"><label class="svelte-jhtkop"> </label> <input type="text" class="svelte-jhtkop"/></div> <div class="form-group svelte-jhtkop"><label class="svelte-jhtkop"> </label> <textarea rows="6" class="svelte-jhtkop"></textarea></div></div>');function cc(t,e){xe(e,!0);let n=J(e,"titlePlaceholder",3,"Enter title..."),i=J(e,"contentPlaceholder",3,"Enter text..."),r=J(e,"idPrefix",3,"text-form"),s=J(e,"accentColor",3,"#88ddff");function a(w){const b=w.target;e.ontitlechange(b.value)}function o(w){const b=w.target;e.oncontentchange(b.value)}var l=lc();let c;var u=M(l),h=M(u),f=M(h),g=T(h,2);g.__input=a;var p=T(u,2),x=M(p),_=M(x),v=T(x,2);v.__input=o,j(()=>{c=ve(l,"",c,{"--accent-color":s()}),oe(h,"for",`${r()??""}-title`),he(f,`Title (max ${vr} chars)`),oe(g,"id",`${r()??""}-title`),On(g,e.title),oe(g,"placeholder",n()),oe(g,"maxlength",vr),oe(x,"for",`${r()??""}-content`),he(_,`Content (max ${mr} chars)`),oe(v,"id",`${r()??""}-content`),On(v,e.content),oe(v,"placeholder",i()),oe(v,"maxlength",mr)}),S(t,l),Ee()}tt(["input"]);var dc=R('<div class="panel-content svelte-zzlycq"><!> <!> <div class="panel-extras svelte-zzlycq"><!></div> <div class="panel-footer svelte-zzlycq"><!></div></div>');function uc(t,e){xe(e,!0);const n=()=>G(Pi,"$dialogZones",r),i=()=>G(ms,"$selectedDialogZoneId",r),[r,s]=ht(),a="#88ddff";let o=z(je(fs)),l=$(()=>n().find(b=>b.id===i())??null),c=$(()=>d(l)?.texts.find(b=>b.language===d(o))??null);function u(b){i()&&tr(i(),d(o),{title:b})}function h(b){i()&&tr(i(),d(o),{content:b})}function f(){i()&&Zo(i())}function g(){En(null)}function p(b){i()&&Qt(i(),{color:b})}function x(b){H(o,b,!0)}var _=Xe(),v=ae(_);{var w=b=>{zn(b,{panelId:"dialog-zone-panel",title:"Dialog Zone",initialRight:10,initialTop:160,width:280,height:450,minWidth:250,minHeight:370,maxWidth:500,maxHeight:700,resizable:!0,showClose:!0,onclose:g,children:(D,I)=>{var E=dc(),A=M(E);Ms(A,{get selectedLanguage(){return d(o)},onselect:x,accentColor:a});var L=T(A,2);{let y=$(()=>d(c)?.title??""),F=$(()=>d(c)?.content??"");cc(L,{get title(){return d(y)},get content(){return d(F)},ontitlechange:u,oncontentchange:h,titlePlaceholder:"Enter title...",contentPlaceholder:"Enter dialog text...",idPrefix:"dialog",accentColor:a})}var k=T(L,2),m=M(k);gi(m,{get colors(){return ui},get selectedColor(){return d(l).color},onselect:p,label:"Zone Color",accentColor:a});var P=T(k,2),O=M(P);Ce(O,{variant:"red",onclick:f,children:(y,F)=>{var V=Ie("DELETE ZONE");S(y,V)},$$slots:{default:!0}}),S(D,E)},$$slots:{default:!0}})};U(v,b=>{d(l)&&b(w)})}S(t,_),Ee(),s()}var hc=R("<button> </button>"),fc=R("<option> </option>"),gc=R('<a target="_blank" rel="noopener noreferrer" class="url-preview svelte-ds1z4d">Test link ↗</a>'),pc=R('<div class="panel-content svelte-ds1z4d"><!> <div class="frame-size-row svelte-ds1z4d"><div class="frame-size-section svelte-ds1z4d"><span class="section-label svelte-ds1z4d">Frame Size</span> <div class="size-buttons svelte-ds1z4d"></div></div> <button class="rotate-btn svelte-ds1z4d"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ds1z4d"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button></div> <div class="text-section svelte-ds1z4d"><label for="frame-text" class="svelte-ds1z4d">Text</label> <textarea id="frame-text" placeholder="Enter text..." rows="3" class="svelte-ds1z4d"></textarea></div> <div class="panel-extras svelte-ds1z4d"><div class="size-rotation-row svelte-ds1z4d"><div class="size-section svelte-ds1z4d"><label for="text-size" class="svelte-ds1z4d">Text Size</label> <select id="text-size" class="svelte-ds1z4d"></select></div></div> <div class="url-section svelte-ds1z4d"><label for="frame-url" class="svelte-ds1z4d">Link URL (opens on click)</label> <input id="frame-url" type="url" placeholder="https://example.com" class="svelte-ds1z4d"/> <!></div> <!> <!></div> <div class="panel-footer svelte-ds1z4d"><!></div></div>');function vc(t,e){xe(e,!0);const n=()=>G(Mi,"$builderPreviewLanguage",s),i=()=>G(To,"$selectedFrame",s),r=()=>G(_s,"$selectedFrameId",s),[s,a]=ht(),o="#9b59b6";let l=$(n),c=$(i),u=$(()=>d(c)?.texts.find(k=>k.language===d(l))??null),h=$(()=>d(c)?hl(d(c).scale??4):"M");function f(k){const m=k.target;if(!r()||!d(c))return;const P=d(c).texts.map(O=>O.language===d(l)?{...O,text:m.value}:O);P.some(O=>O.language===d(l))||P.push({language:d(l),text:m.value}),gt(r(),{texts:P})}function g(k){const m=k.target;r()&&gt(r(),{url:m.value||void 0})}function p(k){r()&&gt(r(),{backgroundColor:k})}function x(k){r()&&gt(r(),{textColor:k})}function _(k){const m=k.target;r()&&gt(r(),{textSize:parseInt(m.value,10)})}function v(k){r()&&gt(r(),{scale:ul(k)})}function w(){if(!r()||!d(c))return;const m=(d(c).rotation??0)===0?90:0;gt(r(),{rotation:m})}function b(){r()&&Ss(r())}function D(){en(null)}function I(k){Do(k)}var E=Xe(),A=ae(E);{var L=k=>{zn(k,{panelId:"frame-panel",title:"Edit Frame",initialRight:10,initialTop:160,width:280,height:520,minWidth:250,minHeight:450,maxWidth:500,maxHeight:700,resizable:!0,showClose:!0,onclose:D,children:(m,P)=>{var O=pc(),y=M(O);Ms(y,{get selectedLanguage(){return d(l)},onselect:I,accentColor:o});var F=T(y,2),V=M(F),N=T(M(V),2);Pt(N,21,()=>Object.entries(Is),Wt,(ee,ye)=>{var we=$(()=>Gs(d(ye),2));let Ke=()=>d(we)[0],Re=()=>d(we)[1].label;var nt=hc();let Et;nt.__click=()=>v(Ke());var Un=M(nt);j(()=>{Et=Ze(nt,1,"size-btn svelte-ds1z4d",null,Et,{active:d(h)===Ke()}),oe(nt,"title",Re()),he(Un,Ke())}),S(ee,nt)});var de=T(V,2);de.__click=w;var Ge=T(F,2),We=T(M(Ge),2);We.__input=f;var Te=T(Ge,2),ie=M(Te),ue=M(ie),fe=T(M(ue),2);fe.__change=_,Pt(fe,21,()=>dl,Wt,(ee,ye)=>{var we=fc(),Ke=M(we),Re={};j(()=>{he(Ke,`${d(ye)??""}px`),Re!==(Re=d(ye))&&(we.value=(we.__value=d(ye))??"")}),S(ee,we)});var re;Va(fe);var se=T(ie,2),q=T(M(se),2);q.__input=g;var Q=T(q,2);{var C=ee=>{var ye=gc();j(()=>oe(ye,"href",d(c).url)),S(ee,ye)};U(Q,ee=>{d(c).url&&ee(C)})}var Z=T(se,2);{let ee=$(()=>d(c).textColor??Cs);gi(Z,{get colors(){return cl},get selectedColor(){return d(ee)},onselect:x,label:"Text Color",accentColor:o})}var X=T(Z,2);gi(X,{get colors(){return ll},get selectedColor(){return d(c).backgroundColor},onselect:p,label:"Background Color",accentColor:o});var _e=T(Te,2),ce=M(_e);Ce(ce,{variant:"red",onclick:b,children:(ee,ye)=>{var we=Ie("DELETE FRAME");S(ee,we)},$$slots:{default:!0}}),j(()=>{oe(de,"title",d(c).rotation===90?"Portrait (click to rotate)":"Landscape (click to rotate)"),On(We,d(u)?.text??""),re!==(re=d(c).textSize??In)&&(fe.value=(fe.__value=d(c).textSize??In)??"",ns(fe,d(c).textSize??In)),On(q,d(c).url??"")}),S(m,O)},$$slots:{default:!0}})};U(A,k=>{d(c)&&k(L)})}S(t,E),Ee(),a()}tt(["click","input","change"]);var mc=R('<div class="frame-text svelte-1vp2oo0"> </div>'),_c=R('<div class="frame-content-layer svelte-1vp2oo0"></div>');function Ps(t,e){xe(e,!0);const n=()=>G(ys,"$placedFrames",c),i=()=>G(gs,"$isBuilderMode",c),r=()=>G(Ri,"$builderCameraInfo",c),s=()=>G(ls,"$gameCameraInfo",c),a=()=>G(Mi,"$builderPreviewLanguage",c),o=()=>G(dn,"$currentLanguage",c),l=()=>G(Li,"$draggingFramePositions",c),[c,u]=ht();let h=$(n),f=$(()=>i()?r().scrollX:s().scrollX),g=$(()=>i()?r().scrollY:s().scrollY),p=$(()=>i()?r().zoom:s().zoom),x=$(()=>i()?a():o()),_=$(l);function v(I){const E=d(_).get(I.id);return E||{x:I.x,y:I.y}}function w(I){const E=I.scale??ot,A=I.rotation===90,{textWidth:L,textHeight:k}=sn(E,A),m=v(I),P=(m.x-d(f))*d(p),O=(m.y-d(g))*d(p);return{x:P,y:O,width:L*d(p),height:k*d(p)}}function b(I){return(I.texts.find(A=>A.language===d(x))||I.texts[0]||{text:""}).text||""}var D=_c();Pt(D,21,()=>d(h),I=>I.id,(I,E)=>{const A=$(()=>w(d(E))),L=$(()=>b(d(E))),k=$(()=>(d(E).textSize??In)*d(p)),m=$(()=>d(E).textColor??Cs);var P=Xe(),O=ae(P);{var y=F=>{var V=mc(),N=M(V);j(()=>{ve(V,`
          left: ${d(A).x??""}px;
          top: ${d(A).y??""}px;
          width: ${d(A).width??""}px;
          height: ${d(A).height??""}px;
          font-size: ${d(k)??""}px;
          color: ${d(m)??""};
        `),he(N,d(L))}),S(F,V)};U(O,F=>{d(L)&&F(y)})}S(I,P)}),S(t,D),Ee(),u()}var yc=R('<div class="hstack svelte-8vtf35"><!></div>');function ni(t,e){let n=J(e,"gap",3,"10px"),i=J(e,"align",3,"center");var r=yc(),s=M(r);Xt(s,()=>e.children??Be),j(()=>ve(r,`gap: ${n()??""}; align-items: ${(i()==="start"?"flex-start":i()==="end"?"flex-end":i())??""};`)),S(t,r)}var bc=R('<div class="vstack svelte-1y4dqnf"><!></div>');function wc(t,e){let n=J(e,"gap",3,"10px"),i=J(e,"align",3,"stretch");var r=bc(),s=M(r);Xt(s,()=>e.children??Be),j(()=>ve(r,`gap: ${n()??""}; align-items: ${(i()==="start"?"flex-start":i()==="end"?"flex-end":i())??""};`)),S(t,r)}var Sc=R("<div><!></div>");function ii(t,e){let n=J(e,"padding",3,"10px");var i=Sc(),r=M(i);Xt(r,()=>e.children??Be),j(()=>{Ze(i,1,`fixed fixed--${e.position??""}`,"svelte-vwlo0e"),ve(i,`--padding: ${n()??""};`)}),S(t,i)}var xc=R("<!> <!>",1),Ec=R("<!> <!> <!>",1),Ic=R("<!> <!>",1),Cc=R("<!> <!> <!>",1),Dc=R("<!> <!> <!>",1),kc=R("<!> <!> <!> <!> <!> <!> <!>",1);function Ac(t,e){xe(e,!0);const n=()=>G(bs,"$selectedItem",h),i=()=>G(ps,"$selectedItemId",h),r=()=>G(vs,"$itemDepthLayer",h),s=()=>G(Mo,"$selectedItemPhysicsEnabled",h),a=()=>G(at,"$builderEditMode",h),o=()=>G(yn,"$isBuilderZoomedOut",h),l=()=>G(Kn,"$gridSnappingEnabled",h),c=()=>G(un,"$isAssetPaletteOpen",h),u=()=>G(hn,"$isFramePaletteOpen",h),[h,f]=ht();let g=$(()=>n()?Yo(n().assetKey):!1);function p(){$l()}function x(){Fl()}function _(){if(!i())return;const N=r()==="behind"?"front":"behind",de=Ti(N);Lo(),Oo(i(),de)}function v(){i()&&Ro(i(),!s())}function w(){i()&&(ws(i()),Oi())}function b(){Eo()}function D(){St.emit(xt.DIALOG_ZONE_CREATE)}var I=kc(),E=ae(I);{var A=N=>{Xl(N,{})},L=N=>{var de=Xe(),Ge=ae(de);{var We=ie=>{uc(ie,{})},Te=ie=>{var ue=Xe(),fe=ae(ue);{var re=se=>{var q=xc(),Q=ae(q);jl(Q,{});var C=T(Q,2);vc(C,{}),S(se,q)};U(fe,se=>{a()==="frames"&&se(re)},!0)}S(ie,ue)};U(Ge,ie=>{a()==="dialogs"?ie(We):ie(Te,!1)},!0)}S(N,de)};U(E,N=>{a()==="items"?N(A):N(L,!1)})}var k=T(E,2);Ps(k,{});var m=T(k,2);Jl(m,{});var P=T(m,2);ec(P,{});var O=T(P,2);ii(O,{position:"top-left",children:(N,de)=>{ni(N,{children:(Ge,We)=>{var Te=Ec(),ie=ae(Te);Ce(ie,{variant:"green",width:"100px",onclick:p,children:(re,se)=>{var q=Ie("SAVE");S(re,q)},$$slots:{default:!0}});var ue=T(ie,2);{let re=$(()=>o()?"orange":"blue");Ce(ue,{get variant(){return d(re)},width:"80px",onclick:x,title:"Toggle zoom (F)",children:(se,q)=>{var Q=Ie();j(()=>he(Q,o()?"1:1":"FIT")),S(se,Q)},$$slots:{default:!0}})}var fe=T(ue,2);{let re=$(()=>l()?"orange":"blue");Ce(fe,{get variant(){return d(re)},width:"80px",onclick:b,title:"Toggle grid snapping",children:(se,q)=>{var Q=Ie();j(()=>he(Q,l()?"SNAP":"FREE")),S(se,Q)},$$slots:{default:!0}})}S(Ge,Te)},$$slots:{default:!0}})},$$slots:{default:!0}});var y=T(O,2);ii(y,{position:"top-right",children:(N,de)=>{wc(N,{align:"end",children:(Ge,We)=>{var Te=Cc(),ie=ae(Te);{let re=$(()=>a()==="items"&&c()?"orange":"blue");Ce(ie,{get variant(){return d(re)},onclick:()=>{a()==="items"?Io():(Jt("items"),un.set(!0))},title:"Edit assets/items",children:(se,q)=>{var Q=Ie("ASSETS");S(se,Q)},$$slots:{default:!0}})}var ue=T(ie,2);{let re=$(()=>a()==="frames"&&u()?"orange":"purple");Ce(ue,{get variant(){return d(re)},onclick:()=>{a()==="frames"?Co():(Jt("frames"),hn.set(!0))},title:"Edit text frames",children:(se,q)=>{var Q=Ie("FRAMES");S(se,Q)},$$slots:{default:!0}})}var fe=T(ue,2);ni(fe,{children:(re,se)=>{var q=Ic(),Q=ae(q);{var C=X=>{Ce(X,{variant:"cyan",width:"100px",onclick:D,title:"Create new dialog zone at center of view",children:(_e,ce)=>{var ee=Ie("+ ZONE");S(_e,ee)},$$slots:{default:!0}})};U(Q,X=>{a()==="dialogs"&&X(C)})}var Z=T(Q,2);{let X=$(()=>a()==="dialogs"?"orange":"cyan");Ce(Z,{get variant(){return d(X)},onclick:()=>{a()==="dialogs"?Jt("items"):Jt("dialogs")},title:"Edit dialog zones",children:(_e,ce)=>{var ee=Ie("DIALOGS");S(_e,ee)},$$slots:{default:!0}})}S(re,q)},$$slots:{default:!0}}),S(Ge,Te)},$$slots:{default:!0}})},$$slots:{default:!0}});var F=T(y,2);{var V=N=>{ii(N,{position:"top-center",children:(de,Ge)=>{ni(de,{children:(We,Te)=>{var ie=Dc(),ue=ae(ie);{let q=$(()=>r()==="behind"?"blue":"orange"),Q=$(()=>s()?"Solid items must be behind player":"Toggle item depth: behind or in front of player");Ce(ue,{get variant(){return d(q)},get title(){return d(Q)},onclick:_,get disabled(){return s()},children:(C,Z)=>{var X=Ie();j(()=>he(X,r()==="behind"?"Behind":"Front")),S(C,X)},$$slots:{default:!0}})}var fe=T(ue,2);{var re=q=>{{let Q=$(()=>s()?"orange":"blue");Ce(q,{get variant(){return d(Q)},title:"Toggle physics: item will block player movement",onclick:v,children:(C,Z)=>{var X=Ie();j(()=>he(X,s()?"Solid":"Ghost")),S(C,X)},$$slots:{default:!0}})}};U(fe,q=>{d(g)&&q(re)})}var se=T(fe,2);Ce(se,{variant:"red",title:"Delete selected item",onclick:w,children:(q,Q)=>{var C=Ie("DELETE");S(q,C)},$$slots:{default:!0}}),S(We,ie)},$$slots:{default:!0}})},$$slots:{default:!0}})};U(F,N=>{a()==="items"&&i()&&N(V)})}S(t,I),Ee(),f()}var Tc=R("<div> </div>"),Mc=R('<div class="dialog-content svelte-1jd14ss"> </div>'),Pc=R("<div><!> <!></div>");function Lc(t,e){xe(e,!0);const n=()=>G(co,"$activeDialogText",r),i=()=>G(os,"$playerScreenPosition",r),[r,s]=ht();let a=$(()=>n()?.title&&n()?.content),o=$(()=>Math.max(10,window.innerHeight-i().y+oc)),l=$(()=>window.innerWidth<=ac),c=$(()=>d(l)?50:i().x),u=$(()=>d(l)?"percent":"px");var h=Xe(),f=ae(h);{var g=p=>{var x=Pc();let _;var v=M(x);{var w=I=>{var E=Tc();let A;var L=M(E);j(()=>{A=Ze(E,1,"dialog-title svelte-1jd14ss",null,A,{"has-divider":d(a)}),he(L,n().title)}),S(I,E)};U(v,I=>{n().title&&I(w)})}var b=T(v,2);{var D=I=>{var E=Mc(),A=M(E);j(()=>he(A,n().content)),S(I,E)};U(b,I=>{n().content&&I(D)})}j(()=>{_=Ze(x,1,"dialog-bubble svelte-1jd14ss",null,_,{narrow:d(l)}),ve(x,`bottom: ${d(o)??""}px; left: ${d(c)??""}${d(u)??""};`)}),S(p,x)};U(f,p=>{n()&&p(g)})}S(t,h),Ee(),s()}var Oc=R("<!> <!>",1),Rc=R('<div class="touch-controls"><p class="touch-text">Tap and hold<br/>where you want<br/>to move</p></div>'),$c=R('<div class="desktop-controls"><div class="key-row"><div class="pixel-key">A</div> <div class="pixel-key">W</div> <div class="pixel-key">D</div></div> <p class="or-text">or</p> <div class="key-row"><div class="pixel-key">←</div> <div class="pixel-key">↑</div> <div class="pixel-key">→</div></div></div>'),Fc=R('<div class="loader-overlay"><div class="pixel-loader"></div></div>'),Hc=R('<div class="game-ui-wrapper svelte-13dvmla"><!> <!> <!> <dialog class="pixel-dialog"><h1>CONTROLS</h1> <div class="controls-content"><!></div></dialog> <!></div>');function Nc(t,e){xe(e,!1);const n=()=>G(qt,"$showControlsDialog",l),i=()=>G(ss,"$hasPlayerMoved",l),r=()=>G(gs,"$isBuilderMode",l),s=()=>G(dn,"$currentLanguage",l),a=()=>G(rs,"$isTouchDevice",l),o=()=>G(hi,"$isLoading",l),[l,c]=ht();let u=xi();function h(){const y=As.toggleLanguage();dn.set(y)}function f(y){!d(u)?.open||y.target.closest(".pixel-button")||qt.set(!1)}function g(){const y=Ol();if(!y){console.error("Cannot enter builder mode: map config not found");return}Rl(y)}Yi(()=>(d(u),n()),()=>{d(u)&&(n()?d(u).showModal():d(u).close())}),Yi(()=>(i(),d(u),qt),()=>{i()&&d(u)?.open&&qt.set(!1)}),Fa(),eo();var p=Hc();wt("pointerdown",Cr,f);var x=M(p);{var _=y=>{Ac(y,{})},v=y=>{var F=Oc(),V=ae(F);Lc(V,{});var N=T(V,2);Ps(N,{}),S(y,F)};U(x,y=>{r()?y(_):y(v,!1)})}var w=T(x,2);{var b=y=>{Ce(y,{position:"top-left",variant:"green",width:"120px",onclick:g,title:"Toggle Builder Mode",children:(F,V)=>{var N=Ie("BUILD");S(F,N)},$$slots:{default:!0}})};U(w,y=>{r()||y(b)})}var D=T(w,2);{var I=y=>{Ce(y,{position:"top-right",variant:"default",width:"100px",onclick:h,title:"Toggle Language (L)",children:(F,V)=>{var N=Ie();j(de=>he(N,de),[()=>(s(),Rt(()=>s().toUpperCase()))]),S(F,N)},$$slots:{default:!0}})};U(D,y=>{r()||y(I)})}var E=T(D,2),A=T(M(E),2),L=M(A);{var k=y=>{var F=Rc();S(y,F)},m=y=>{var F=$c();S(y,F)};U(L,y=>{a()?y(k):y(m,!1)})}Di(E,y=>H(u,y),()=>d(u));var P=T(E,2);{var O=y=>{var F=Fc();S(y,F)};U(P,y=>{o()&&y(O)})}S(t,p),Ee(),c()}const Ls=document.getElementById("game-ui");if(!Ls)throw new Error("game-ui element not found!");Xa(Nc,{target:Ls});dn.set(As.getLanguage());oo.set(cs.getSkin());lo.set(Rn.getCurrentConfig().name);const Bc={type:B.AUTO,width:800,height:600,parent:"game-container",backgroundColor:"#000000",pixelArt:!0,roundPixels:!0,scale:{mode:B.Scale.RESIZE,autoCenter:B.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{y:1e3,x:0},debug:!1}},audio:{noAudio:!0},scene:[yl,Tl]},Os=new B.Game(Bc);Ll(Os);const Zc=Os.device.input.touch;rs.set(Zc);const Gc=performance.getEntriesByType("navigation")[0]&&performance.getEntriesByType("navigation")[0].type==="reload",Wc=sessionStorage.getItem("hasSeenControlsHint");(!Wc||Gc)&&(sessionStorage.setItem("hasSeenControlsHint","true"),qt.set(!0));
//# sourceMappingURL=index-psKXOD07.js.map
