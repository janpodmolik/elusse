import{r as zr,g as Vr}from"./phaser-DFK5Ua9d.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var jr=zr();const x=Vr(jr),zt=!1;var Fn=Array.isArray,Zr=Array.prototype.indexOf,rn=Array.from,Kn=Object.defineProperty,at=Object.getOwnPropertyDescriptor,Wn=Object.getOwnPropertyDescriptors,qr=Object.prototype,Jr=Array.prototype,sn=Object.getPrototypeOf,Sn=Object.isExtensible;const _e=()=>{};function Qr(t){return t()}function Ct(t){for(var e=0;e<t.length;e++)t[e]()}function Xn(){var t,e,n=new Promise((r,i)=>{t=r,e=i});return{promise:n,resolve:t,reject:e}}const G=2,an=4,Bt=8,ei=1<<24,Ie=16,Ee=32,Ye=64,$t=128,se=512,$=1024,U=2048,he=4096,q=8192,Ae=16384,on=32768,Re=65536,In=1<<17,Un=1<<18,Je=1<<19,zn=1<<20,Ne=32768,Vt=1<<21,ln=1<<22,De=1<<23,ze=Symbol("$state"),ti=Symbol(""),Xe=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Vn(t){return t===this.v}function jn(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Zn(t){return!jn(t,this.v)}function ni(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ri(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function ii(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function si(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ai(t){throw new Error("https://svelte.dev/e/effect_orphan")}function oi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function li(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ci(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ui(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function fi(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}let pt=!1,hi=!1;function di(){pt=!0}const gi=1,pi=2,vi=16,mi=1,_i=2,F=Symbol(),yi="http://www.w3.org/1999/xhtml";let P=null;function je(t){P=t}function vt(t,e=!1,n){P={p:P,i:!1,c:null,e:null,s:t,x:null,l:pt&&!e?{s:null,u:null,$:[]}:null}}function mt(t){var e=P,n=e.e;if(n!==null){e.e=null;for(var r of n)mr(r)}return e.i=!0,P=e.p,{}}function _t(){return!pt||P!==null&&P.l===null}let Ue=[];function wi(){var t=Ue;Ue=[],Ct(t)}function yt(t){if(Ue.length===0){var e=Ue;queueMicrotask(()=>{e===Ue&&wi()})}Ue.push(t)}function bi(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function nt(t){if(typeof t!="object"||t===null||ze in t)return t;const e=sn(t);if(e!==qr&&e!==Jr)return t;var n=new Map,r=Fn(t),i=j(0),s=Pe,a=o=>{if(Pe===s)return o();var l=E,c=Pe;W(null),Cn(s);var u=o();return W(l),Cn(c),u};return r&&n.set("length",j(t.length)),new Proxy(t,{defineProperty(o,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&li();var u=n.get(l);return u===void 0?u=a(()=>{var h=j(c.value);return n.set(l,h),h}):N(u,c.value,!0),!0},deleteProperty(o,l){var c=n.get(l);if(c===void 0){if(l in o){const u=a(()=>j(F));n.set(l,u),ot(i)}}else N(c,F),ot(i);return!0},get(o,l,c){if(l===ze)return t;var u=n.get(l),h=l in o;if(u===void 0&&(!h||at(o,l)?.writable)&&(u=a(()=>{var d=nt(h?o[l]:F),g=j(d);return g}),n.set(l,u)),u!==void 0){var f=p(u);return f===F?void 0:f}return Reflect.get(o,l,c)},getOwnPropertyDescriptor(o,l){var c=Reflect.getOwnPropertyDescriptor(o,l);if(c&&"value"in c){var u=n.get(l);u&&(c.value=p(u))}else if(c===void 0){var h=n.get(l),f=h?.v;if(h!==void 0&&f!==F)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return c},has(o,l){if(l===ze)return!0;var c=n.get(l),u=c!==void 0&&c.v!==F||Reflect.has(o,l);if(c!==void 0||C!==null&&(!u||at(o,l)?.writable)){c===void 0&&(c=a(()=>{var f=u?nt(o[l]):F,d=j(f);return d}),n.set(l,c));var h=p(c);if(h===F)return!1}return u},set(o,l,c,u){var h=n.get(l),f=l in o;if(r&&l==="length")for(var d=c;d<h.v;d+=1){var g=n.get(d+"");g!==void 0?N(g,F):d in o&&(g=a(()=>j(F)),n.set(d+"",g))}if(h===void 0)(!f||at(o,l)?.writable)&&(h=a(()=>j(void 0)),N(h,nt(c)),n.set(l,h));else{f=h.v!==F;var b=a(()=>nt(c));N(h,b)}var T=Reflect.getOwnPropertyDescriptor(o,l);if(T?.set&&T.set.call(u,c),!f){if(r&&typeof l=="string"){var L=n.get("length"),O=Number(l);Number.isInteger(O)&&O>=L.v&&N(L,O+1)}ot(i)}return!0},ownKeys(o){p(i);var l=Reflect.ownKeys(o).filter(h=>{var f=n.get(h);return f===void 0||f.v!==F});for(var[c,u]of n)u.v!==F&&!(c in o)&&l.push(c);return l},setPrototypeOf(){ci()}})}var En,qn,Jn,Qn,er;function Si(){if(En===void 0){En=window,qn=document,Jn=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;Qn=at(e,"firstChild").get,er=at(e,"nextSibling").get,Sn(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Sn(n)&&(n.__t=void 0)}}function be(t=""){return document.createTextNode(t)}function Tt(t){return Qn.call(t)}function wt(t){return er.call(t)}function Z(t,e){return Tt(t)}function cn(t,e=!1){{var n=Tt(t);return n instanceof Comment&&n.data===""?wt(n):n}}function B(t,e=1,n=!1){let r=t;for(;e--;)r=wt(r);return r}function Ii(t){t.textContent=""}function tr(){return!1}function nr(t){var e=C;if(e===null)return E.f|=De,t;if((e.f&on)===0){if((e.f&$t)===0)throw t;e.b.error(t)}else Ze(t,e)}function Ze(t,e){for(;e!==null;){if((e.f&$t)!==0)try{e.b.error(t);return}catch(n){t=n}e=e.parent}throw t}const St=new Set;let M=null,ee=null,le=[],un=null,jt=!1;class ce{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#s=[];#i=[];skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){le=[],this.apply();var n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#a(r,n);this.is_fork||this.#u(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects)):(M=null,An(n.render_effects),An(n.effects),this.#l?.resolve()),ee=null}#a(e,n){e.f^=$;for(var r=e.first;r!==null;){var i=r.f,s=(i&(Ee|Ye))!==0,a=s&&(i&$)!==0,o=a||(i&q)!==0||this.skipped_effects.has(r);if((r.f&$t)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[],block_effects:[]}),!o&&r.fn!==null){s?r.f^=$:(i&an)!==0?n.effects.push(r):et(r)&&((r.f&Ie)!==0&&n.block_effects.push(r),qe(r));var l=r.first;if(l!==null){r=l;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)c===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects),n=n.parent),r=c.next,c=c.parent}}#o(e){for(const n of e)((n.f&U)!==0?this.#s:this.#i).push(n),this.#c(n.deps),Y(n,$)}#c(e){if(e!==null)for(const n of e)(n.f&G)===0||(n.f&Ne)===0||(n.f^=Ne,this.#c(n.deps))}capture(e,n){this.previous.has(e)||this.previous.set(e,n),(e.f&De)===0&&(this.current.set(e,e.v),ee?.set(e,e.v))}activate(){M=this,this.apply()}deactivate(){M===this&&(M=null,ee=null)}flush(){if(this.activate(),le.length>0){if(Ei(),M!==null&&M!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#n===0){for(const e of this.#e)e();this.#e.clear()}this.#r===0&&this.#f()}#f(){if(St.size>1){this.previous.clear();var e=ee,n=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of St){if(s===this){n=!1;continue}const a=[];for(const[l,c]of this.current){if(s.current.has(l))if(n&&c!==s.current.get(l))s.current.set(l,c);else continue;a.push(l)}if(a.length===0)continue;const o=[...s.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var i=le;le=[];const l=new Set,c=new Map;for(const u of a)rr(u,o,l,c);if(le.length>0){M=s,s.apply();for(const u of le)s.#a(u,r);s.deactivate()}le=i}}M=null,ee=e}this.committed=!0,St.delete(this)}increment(e){this.#r+=1,e&&(this.#n+=1)}decrement(e){this.#r-=1,e&&(this.#n-=1),this.revive()}revive(){for(const e of this.#s)Y(e,U),He(e);for(const e of this.#i)Y(e,he),He(e);this.#s=[],this.#i=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#l??=Xn()).promise}static ensure(){if(M===null){const e=M=new ce;St.add(M),ce.enqueue(()=>{M===e&&e.flush()})}return M}static enqueue(e){yt(e)}apply(){}}function Ei(){var t=Te;jt=!0;var e=null;try{var n=0;for(Lt(!0);le.length>0;){var r=ce.ensure();if(n++>1e3){var i,s;Ai()}r.process(le),Ce.clear()}}finally{jt=!1,Lt(t),un=null}}function Ai(){try{oi()}catch(t){Ze(t,un)}}let ve=null;function An(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var r=t[n++];if((r.f&(Ae|q))===0&&et(r)&&(ve=new Set,qe(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?wr(r):r.fn=null),ve?.size>0)){Ce.clear();for(const i of ve){if((i.f&(Ae|q))!==0)continue;const s=[i];let a=i.parent;for(;a!==null;)ve.has(a)&&(ve.delete(a),s.push(a)),a=a.parent;for(let o=s.length-1;o>=0;o--){const l=s[o];(l.f&(Ae|q))===0&&qe(l)}}ve.clear()}}ve=null}}function rr(t,e,n,r){if(!n.has(t)&&(n.add(t),t.reactions!==null))for(const i of t.reactions){const s=i.f;(s&G)!==0?rr(i,e,n,r):(s&(ln|Ie))!==0&&(s&U)===0&&ir(i,e,r)&&(Y(i,U),He(i))}}function ir(t,e,n){const r=n.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const i of t.deps){if(e.includes(i))return!0;if((i.f&G)!==0&&ir(i,e,n))return n.set(i,!0),!0}return n.set(t,!1),!1}function He(t){for(var e=un=t;e.parent!==null;){e=e.parent;var n=e.f;if(jt&&e===C&&(n&Ie)!==0&&(n&Un)===0)return;if((n&(Ye|Ee))!==0){if((n&$)===0)return;e.f^=$}}le.push(e)}function Di(t){let e=0,n=Be(0),r;return()=>{ut()&&(p(n),Gt(()=>(e===0&&(r=Ge(()=>t(()=>ot(n)))),e+=1,()=>{yt(()=>{e-=1,e===0&&(r?.(),r=void 0,ot(n))})})))}}var Ci=Re|Je|$t;function Ti(t,e,n){new xi(t,e,n)}class xi{parent;#e=!1;#t;#r=null;#n;#l;#s;#i=null;#a=null;#o=null;#c=null;#u=null;#f=0;#h=0;#g=!1;#d=null;#y=Di(()=>(this.#d=Be(this.#f),()=>{this.#d=null}));constructor(e,n,r){this.#t=e,this.#n=n,this.#l=r,this.parent=C.b,this.#e=!!this.#n.pending,this.#s=Ft(()=>{C.b=this;{var i=this.#m();try{this.#i=Q(()=>r(i))}catch(s){this.error(s)}this.#h>0?this.#v():this.#e=!1}return()=>{this.#u?.remove()}},Ci)}#w(){try{this.#i=Q(()=>this.#l(this.#t))}catch(e){this.error(e)}this.#e=!1}#b(){const e=this.#n.pending;e&&(this.#a=Q(()=>e(this.#t)),ce.enqueue(()=>{var n=this.#m();this.#i=this.#p(()=>(ce.ensure(),Q(()=>this.#l(n)))),this.#h>0?this.#v():(Ve(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#m(){var e=this.#t;return this.#e&&(this.#u=be(),this.#t.before(this.#u),e=this.#u),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(e){var n=C,r=E,i=P;fe(this.#s),W(this.#s),je(this.#s.ctx);try{return e()}catch(s){return nr(s),null}finally{fe(n),W(r),je(i)}}#v(){const e=this.#n.pending;this.#i!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),Ir(this.#i,this.#c)),this.#a===null&&(this.#a=Q(()=>e(this.#t)))}#_(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#a&&Ve(this.#a,()=>{this.#a=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(e){this.#_(e),this.#f+=e,this.#d&&lt(this.#d,this.#f)}get_effect_pending(){return this.#y(),p(this.#d)}error(e){var n=this.#n.onerror;let r=this.#n.failed;if(this.#g||!n&&!r)throw e;this.#i&&(X(this.#i),this.#i=null),this.#a&&(X(this.#a),this.#a=null),this.#o&&(X(this.#o),this.#o=null);var i=!1,s=!1;const a=()=>{if(i){bi();return}i=!0,s&&fi(),ce.ensure(),this.#f=0,this.#o!==null&&Ve(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#i=this.#p(()=>(this.#g=!1,Q(()=>this.#l(this.#t)))),this.#h>0?this.#v():this.#e=!1};var o=E;try{W(null),s=!0,n?.(e,a),s=!1}catch(l){Ze(l,this.#s&&this.#s.parent)}finally{W(o)}r&&yt(()=>{this.#o=this.#p(()=>{ce.ensure(),this.#g=!0;try{return Q(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return Ze(l,this.#s.parent),null}finally{this.#g=!1}})})}}function ki(t,e){return e}function Li(t,e,n){for(var r=[],i=e.length,s=0;s<i;s++)pn(e[s].e,r,!0);br(r,()=>{var a=r.length===0&&n!==null;if(a){var o=n,l=o.parentNode;Ii(l),l.append(o),t.items.clear(),oe(t,e[0].prev,e[i-1].next)}for(var c=0;c<i;c++){var u=e[c];a||(t.items.delete(u.k),oe(t,u.prev,u.next)),X(u.e,!a)}t.first===e[0]&&(t.first=e[0].prev)})}function Oi(t,e,n,r,i,s=null){var a=t,o=new Map,l=null;{var c=t;a=c.appendChild(be())}var u=null,h=kt(()=>{var L=n();return Fn(L)?L:L==null?[]:rn(L)}),f,d=!0;function g(){Mi(T,f,a,e,r),u!==null&&(f.length===0?(u.fragment?(a.before(u.fragment),u.fragment=null):vn(u.effect),b.first=u.effect):Ve(u.effect,()=>{u=null}))}var b=Ft(()=>{f=p(h);for(var L=f.length,O=new Set,v=M,y=null,S=tr(),w=0;w<L;w+=1){var A=f[w],I=r(A,w),R=d?null:o.get(I);R?(lt(R.v,A),R.i=w,S&&v.skipped_effects.delete(R.e)):(R=Pi(d?a:null,y,A,I,w,i,e,n),d&&(R.o=!0,y===null?l=R:y.next=R,y=R),o.set(I,R)),O.add(I)}if(L===0&&s&&!u)if(d)u={fragment:null,effect:Q(()=>s(a))};else{var m=document.createDocumentFragment(),D=be();m.append(D),u={fragment:m,effect:Q(()=>s(D))}}if(!d)if(S){for(const[_,k]of o)O.has(_)||v.skipped_effects.add(k.e);v.oncommit(g),v.ondiscard(()=>{})}else g();p(h)}),T={effect:b,items:o,first:l};d=!1}function Mi(t,e,n,r,i){var s=e.length,a=t.items,o=t.first,l,c=null,u=[],h=[],f,d,g,b;for(b=0;b<s;b+=1){if(f=e[b],d=i(f,b),g=a.get(d),t.first??=g,!g.o){g.o=!0;var T=c?c.next:o;oe(t,c,g),oe(t,g,T),Xt(g,T,n),c=g,u=[],h=[],o=c.next;continue}if((g.e.f&q)!==0&&vn(g.e),g!==o){if(l!==void 0&&l.has(g)){if(u.length<h.length){var L=h[0],O;c=L.prev;var v=u[0],y=u[u.length-1];for(O=0;O<u.length;O+=1)Xt(u[O],L,n);for(O=0;O<h.length;O+=1)l.delete(h[O]);oe(t,v.prev,y.next),oe(t,c,v),oe(t,y,L),o=L,c=y,b-=1,u=[],h=[]}else l.delete(g),Xt(g,o,n),oe(t,g.prev,g.next),oe(t,g,c===null?t.first:c.next),oe(t,c,g),c=g;continue}for(u=[],h=[];o!==null&&o.k!==d;)(o.e.f&q)===0&&(l??=new Set).add(o),h.push(o),o=o.next;if(o===null)continue;g=o}u.push(g),c=g,o=g.next}if(o!==null||l!==void 0){for(var S=l===void 0?[]:rn(l);o!==null;)(o.e.f&q)===0&&S.push(o),o=o.next;var w=S.length;if(w>0){var A=s===0?n:null;Li(t,S,A)}}}function Pi(t,e,n,r,i,s,a,o){var l=(a&gi)!==0,c=(a&vi)===0,u=l?c?hn(n,!1,!1):Be(n):n,h=(a&pi)===0?i:Be(i),f={i:h,v:u,k:r,a:null,e:null,o:!1,prev:e,next:null};try{if(t===null){var d=document.createDocumentFragment();d.append(t=be())}return f.e=Q(()=>s(t,u,h,o)),e!==null&&(e.next=f),f}finally{}}function Xt(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,s=t.e.nodes_start;s!==null&&s!==r;){var a=wt(s);i.before(s),s=a}}function oe(t,e,n){e===null?(t.first=n,t.effect.first=n&&n.e):(e.e.next&&(e.e.next.prev=null),e.next=n,e.e.next=n&&n.e),n===null?t.effect.last=e&&e.e:(n.e.prev&&(n.e.prev.next=null),n.prev=e,n.e.prev=e&&e.e)}function Ri(t,e,n,r){const i=_t()?Yt:kt;if(n.length===0&&t.length===0){r(e.map(i));return}var s=M,a=C,o=Ni();function l(){Promise.all(n.map(c=>Hi(c))).then(c=>{o();try{r([...e.map(i),...c])}catch(u){(a.f&Ae)===0&&Ze(u,a)}s?.deactivate(),xt()}).catch(c=>{Ze(c,a)})}t.length>0?Promise.all(t).then(()=>{o();try{return l()}finally{s?.deactivate(),xt()}}):l()}function Ni(){var t=C,e=E,n=P,r=M;return function(s=!0){fe(t),W(e),je(n),s&&r?.activate()}}function xt(){fe(null),W(null),je(null)}function Yt(t){var e=G|U,n=E!==null&&(E.f&G)!==0?E:null;return C!==null&&(C.f|=Je),{ctx:P,deps:null,effects:null,equals:Vn,f:e,fn:t,reactions:null,rv:0,v:F,wv:0,parent:n??C,ac:null}}function Hi(t,e){let n=C;n===null&&ri();var r=n.b,i=void 0,s=Be(F),a=!E,o=new Map;return ji(()=>{var l=Xn();i=l.promise;try{Promise.resolve(t()).then(l.resolve,l.reject).then(()=>{c===M&&c.committed&&c.deactivate(),xt()})}catch(f){l.reject(f),xt()}var c=M;if(a){var u=!r.is_pending();r.update_pending_count(1),c.increment(u),o.get(c)?.reject(Xe),o.delete(c),o.set(c,l)}const h=(f,d=void 0)=>{if(c.activate(),d)d!==Xe&&(s.f|=De,lt(s,d));else{(s.f&De)!==0&&(s.f^=De),lt(s,f);for(const[g,b]of o){if(o.delete(g),g===c)break;b.reject(Xe)}}a&&(r.update_pending_count(-1),c.decrement(u))};l.promise.then(h,f=>h(null,f||"unknown"))}),gn(()=>{for(const l of o.values())l.reject(Xe)}),new Promise(l=>{function c(u){function h(){u===i?l(s):c(i)}u.then(h,h)}c(i)})}function rt(t){const e=Yt(t);return cr(e),e}function kt(t){const e=Yt(t);return e.equals=Zn,e}function sr(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)X(e[n])}}function Bi(t){for(var e=t.parent;e!==null;){if((e.f&G)===0)return(e.f&Ae)===0?e:null;e=e.parent}return null}function fn(t){var e,n=C;fe(Bi(t));try{t.f&=~Ne,sr(t),e=dr(t)}finally{fe(n)}return e}function ar(t){var e=fn(t);if(t.equals(e)||(M?.is_fork||(t.v=e),t.wv=fr()),!Qe)if(ee!==null)(ut()||M?.is_fork)&&ee.set(t,e);else{var n=(t.f&se)===0?he:$;Y(t,n)}}let Zt=new Set;const Ce=new Map;let or=!1;function Be(t,e){var n={f:0,v:t,reactions:null,equals:Vn,rv:0,wv:0};return n}function j(t,e){const n=Be(t);return cr(n),n}function hn(t,e=!1,n=!0){const r=Be(t);return e||(r.equals=Zn),pt&&n&&P!==null&&P.l!==null&&(P.l.s??=[]).push(r),r}function N(t,e,n=!1){E!==null&&(!ue||(E.f&In)!==0)&&_t()&&(E.f&(G|Ie|ln|In))!==0&&!ye?.includes(t)&&ui();let r=n?nt(e):e;return lt(t,r)}function lt(t,e){if(!t.equals(e)){var n=t.v;Qe?Ce.set(t,e):Ce.set(t,n),t.v=e;var r=ce.ensure();r.capture(t,n),(t.f&G)!==0&&((t.f&U)!==0&&fn(t),Y(t,(t.f&se)!==0?$:he)),t.wv=fr(),lr(t,U),_t()&&C!==null&&(C.f&$)!==0&&(C.f&(Ee|Ye))===0&&(J===null?Yi([t]):J.push(t)),!r.is_fork&&Zt.size>0&&!or&&$i()}return e}function $i(){or=!1;var t=Te;Lt(!0);const e=Array.from(Zt);try{for(const n of e)(n.f&$)!==0&&Y(n,he),et(n)&&qe(n)}finally{Lt(t)}Zt.clear()}function ot(t){N(t,t.v+1)}function lr(t,e){var n=t.reactions;if(n!==null)for(var r=_t(),i=n.length,s=0;s<i;s++){var a=n[s],o=a.f;if(!(!r&&a===C)){var l=(o&U)===0;if(l&&Y(a,e),(o&G)!==0){var c=a;ee?.delete(c),(o&Ne)===0&&(o&se&&(a.f|=Ne),lr(c,he))}else l&&((o&Ie)!==0&&ve!==null&&ve.add(a),He(a))}}}function dn(t){var e=E,n=C;W(null),fe(null);try{return t()}finally{W(e),fe(n)}}let Te=!1;function Lt(t){Te=t}let Qe=!1;function Dn(t){Qe=t}let E=null,ue=!1;function W(t){E=t}let C=null;function fe(t){C=t}let ye=null;function cr(t){E!==null&&(ye===null?ye=[t]:ye.push(t))}let K=null,V=0,J=null;function Yi(t){J=t}let ur=1,ct=0,Pe=ct;function Cn(t){Pe=t}function fr(){return++ur}function et(t){var e=t.f;if((e&U)!==0)return!0;if(e&G&&(t.f&=~Ne),(e&he)!==0){var n=t.deps;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i];if(et(s)&&ar(s),s.wv>t.wv)return!0}(e&se)!==0&&ee===null&&Y(t,$)}return!1}function hr(t,e,n=!0){var r=t.reactions;if(r!==null&&!ye?.includes(t))for(var i=0;i<r.length;i++){var s=r[i];(s.f&G)!==0?hr(s,e,!1):e===s&&(n?Y(s,U):(s.f&$)!==0&&Y(s,he),He(s))}}function dr(t){var e=K,n=V,r=J,i=E,s=ye,a=P,o=ue,l=Pe,c=t.f;K=null,V=0,J=null,E=(c&(Ee|Ye))===0?t:null,ye=null,je(t.ctx),ue=!1,Pe=++ct,t.ac!==null&&(dn(()=>{t.ac.abort(Xe)}),t.ac=null);try{t.f|=Vt;var u=t.fn,h=u(),f=t.deps;if(K!==null){var d;if(Ot(t,V),f!==null&&V>0)for(f.length=V+K.length,d=0;d<K.length;d++)f[V+d]=K[d];else t.deps=f=K;if(Te&&ut()&&(t.f&se)!==0)for(d=V;d<f.length;d++)(f[d].reactions??=[]).push(t)}else f!==null&&V<f.length&&(Ot(t,V),f.length=V);if(_t()&&J!==null&&!ue&&f!==null&&(t.f&(G|he|U))===0)for(d=0;d<J.length;d++)hr(J[d],t);return i!==null&&i!==t&&(ct++,J!==null&&(r===null?r=J:r.push(...J))),(t.f&De)!==0&&(t.f^=De),h}catch(g){return nr(g)}finally{t.f^=Vt,K=e,V=n,J=r,E=i,ye=s,je(a),ue=o,Pe=l}}function Gi(t,e){let n=e.reactions;if(n!==null){var r=Zr.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&G)!==0&&(K===null||!K.includes(e))&&(Y(e,he),(e.f&se)!==0&&(e.f^=se,e.f&=~Ne),sr(e),Ot(e,0))}function Ot(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)Gi(t,n[r])}function qe(t){var e=t.f;if((e&Ae)===0){Y(t,$);var n=C,r=Te;C=t,Te=!0;try{(e&(Ie|ei))!==0?Zi(t):yr(t),_r(t);var i=dr(t);t.teardown=typeof i=="function"?i:null,t.wv=ur;var s;zt&&hi&&(t.f&U)!==0&&t.deps}finally{Te=r,C=n}}}function p(t){var e=t.f,n=(e&G)!==0;if(E!==null&&!ue){var r=C!==null&&(C.f&Ae)!==0;if(!r&&!ye?.includes(t)){var i=E.deps;if((E.f&Vt)!==0)t.rv<ct&&(t.rv=ct,K===null&&i!==null&&i[V]===t?V++:K===null?K=[t]:K.includes(t)||K.push(t));else{(E.deps??=[]).push(t);var s=t.reactions;s===null?t.reactions=[E]:s.includes(E)||s.push(E)}}}if(Qe){if(Ce.has(t))return Ce.get(t);if(n){var a=t,o=a.v;return((a.f&$)===0&&a.reactions!==null||pr(a))&&(o=fn(a)),Ce.set(a,o),o}}else n&&(!ee?.has(t)||M?.is_fork&&!ut())&&(a=t,et(a)&&ar(a),Te&&ut()&&(a.f&se)===0&&gr(a));if(ee?.has(t))return ee.get(t);if((t.f&De)!==0)throw t.v;return t.v}function gr(t){if(t.deps!==null){t.f^=se;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&G)!==0&&(e.f&se)===0&&gr(e)}}function pr(t){if(t.v===F)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Ce.has(e)||(e.f&G)!==0&&pr(e))return!0;return!1}function Ge(t){var e=ue;try{return ue=!0,t()}finally{ue=e}}const Fi=-7169;function Y(t,e){t.f=t.f&Fi|e}function Ki(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ze in t)qt(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&ze in n&&qt(n)}}}function qt(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{qt(t[r],e)}catch{}const n=sn(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=Wn(n);for(let i in r){const s=r[i].get;if(s)try{s.call(t)}catch{}}}}}function vr(t){C===null&&(E===null&&ai(),si()),Qe&&ii()}function Wi(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function de(t,e,n){var r=C;r!==null&&(r.f&q)!==0&&(t|=q);var i={ctx:P,deps:null,nodes_start:null,nodes_end:null,f:t|U|se,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{qe(i),i.f|=on}catch(o){throw X(i),o}else e!==null&&He(i);var s=i;if(n&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&Je)===0&&(s=s.first,(t&Ie)!==0&&(t&Re)!==0&&s!==null&&(s.f|=Re)),s!==null&&(s.parent=r,r!==null&&Wi(s,r),E!==null&&(E.f&G)!==0&&(t&Ye)===0)){var a=E;(a.effects??=[]).push(s)}return i}function ut(){return E!==null&&!ue}function gn(t){const e=de(Bt,null,!1);return Y(e,$),e.teardown=t,e}function Mt(t){vr();var e=C.f,n=!E&&(e&Ee)!==0&&(e&on)===0;if(n){var r=P;(r.e??=[]).push(t)}else return mr(t)}function mr(t){return de(an|zn,t,!1)}function Xi(t){return vr(),de(Bt|zn,t,!0)}function Ui(t){ce.ensure();const e=de(Ye|Je,t,!0);return(n={})=>new Promise(r=>{n.outro?Ve(e,()=>{X(e),r(void 0)}):(X(e),r(void 0))})}function zi(t){return de(an,t,!1)}function Tn(t,e){var n=P,r={effect:null,ran:!1,deps:t};n.l.$.push(r),r.effect=Gt(()=>{t(),!r.ran&&(r.ran=!0,Ge(e))})}function Vi(){var t=P;Gt(()=>{for(var e of t.l.$){e.deps();var n=e.effect;(n.f&$)!==0&&Y(n,he),et(n)&&qe(n),e.ran=!1}})}function ji(t){return de(ln|Je,t,!0)}function Gt(t,e=0){return de(Bt|e,t,!0)}function $e(t,e=[],n=[],r=[]){Ri(r,e,n,i=>{de(Bt,()=>t(...i.map(p)),!0)})}function Ft(t,e=0){var n=de(Ie|e,t,!0);return n}function Q(t){return de(Ee|Je,t,!0)}function _r(t){var e=t.teardown;if(e!==null){const n=Qe,r=E;Dn(!0),W(null);try{e.call(null)}finally{Dn(n),W(r)}}}function yr(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){const i=n.ac;i!==null&&dn(()=>{i.abort(Xe)});var r=n.next;(n.f&Ye)!==0?n.parent=null:X(n,e),n=r}}function Zi(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&Ee)===0&&X(e),e=n}}function X(t,e=!0){var n=!1;(e||(t.f&Un)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(qi(t.nodes_start,t.nodes_end),n=!0),yr(t,e&&!n),Ot(t,0),Y(t,Ae);var r=t.transitions;if(r!==null)for(const s of r)s.stop();_r(t);var i=t.parent;i!==null&&i.first!==null&&wr(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function qi(t,e){for(;t!==null;){var n=t===e?null:wt(t);t.remove(),t=n}}function wr(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Ve(t,e,n=!0){var r=[];pn(t,r,!0),br(r,()=>{n&&X(t),e&&e()})}function br(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function pn(t,e,n){if((t.f&q)===0){if(t.f^=q,t.transitions!==null)for(const a of t.transitions)(a.is_global||n)&&e.push(a);for(var r=t.first;r!==null;){var i=r.next,s=(r.f&Re)!==0||(r.f&Ee)!==0&&(t.f&Ie)!==0;pn(r,e,s?n:!1),r=i}}}function vn(t){Sr(t,!0)}function Sr(t,e){if((t.f&q)!==0){t.f^=q,(t.f&$)===0&&(Y(t,U),He(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&Re)!==0||(n.f&Ee)!==0;Sr(n,i?e:!1),n=r}if(t.transitions!==null)for(const s of t.transitions)(s.is_global||e)&&s.in()}}function Ir(t,e){for(var n=t.nodes_start,r=t.nodes_end;n!==null;){var i=n===r?null:wt(n);e.append(n),n=i}}const Ji=["touchstart","touchmove"];function Qi(t){return Ji.includes(t)}const Er=new Set,Jt=new Set;function es(t,e,n,r={}){function i(s){if(r.capture||it.call(e,s),!s.cancelBubble)return dn(()=>n?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?yt(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function Qt(t,e,n,r,i){var s={capture:r,passive:i},a=es(t,e,n,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&gn(()=>{e.removeEventListener(t,a,s)})}function Kt(t){for(var e=0;e<t.length;e++)Er.add(t[e]);for(var n of Jt)n(t)}let xn=null;function it(t){var e=this,n=e.ownerDocument,r=t.type,i=t.composedPath?.()||[],s=i[0]||t.target;xn=t;var a=0,o=xn===t&&t.__root;if(o){var l=i.indexOf(o);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var c=i.indexOf(e);if(c===-1)return;l<=c&&(a=l)}if(s=i[a]||t.target,s!==e){Kn(t,"currentTarget",{configurable:!0,get(){return s||n}});var u=E,h=C;W(null),fe(null);try{for(var f,d=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var b=s["__"+r];b!=null&&(!s.disabled||t.target===s)&&b.call(s,t)}catch(T){f?d.push(T):f=T}if(t.cancelBubble||g===e||g===null)break;s=g}if(f){for(let T of d)queueMicrotask(()=>{throw T});throw f}}finally{t.__root=e,delete t.currentTarget,W(u),fe(h)}}}function ts(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Pt(t,e){var n=C;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function ne(t,e){var n=(e&mi)!==0,r=(e&_i)!==0,i,s=!t.startsWith("<!>");return()=>{i===void 0&&(i=ts(s?t:"<!>"+t),n||(i=Tt(i)));var a=r||Jn?document.importNode(i,!0):i.cloneNode(!0);if(n){var o=Tt(a),l=a.lastChild;Pt(o,l)}else Pt(a,a);return a}}function Oe(t=""){{var e=be(t+"");return Pt(e,e),e}}function Ar(){var t=document.createDocumentFragment(),e=document.createComment(""),n=be();return t.append(e,n),Pt(e,n),t}function H(t,e){t!==null&&t.before(e)}function ft(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??=t.nodeValue)&&(t.__t=n,t.nodeValue=n+"")}function ns(t,e){return rs(t,e)}const Ke=new Map;function rs(t,{target:e,anchor:n,props:r={},events:i,context:s,intro:a=!0}){Si();var o=new Set,l=h=>{for(var f=0;f<h.length;f++){var d=h[f];if(!o.has(d)){o.add(d);var g=Qi(d);e.addEventListener(d,it,{passive:g});var b=Ke.get(d);b===void 0?(document.addEventListener(d,it,{passive:g}),Ke.set(d,1)):Ke.set(d,b+1)}}};l(rn(Er)),Jt.add(l);var c=void 0,u=Ui(()=>{var h=n??e.appendChild(be());return Ti(h,{pending:()=>{}},f=>{if(s){vt({});var d=P;d.c=s}i&&(r.$$events=i),c=t(f,r)||{},s&&mt()}),()=>{for(var f of o){e.removeEventListener(f,it);var d=Ke.get(f);--d===0?(document.removeEventListener(f,it),Ke.delete(f)):Ke.set(f,d)}Jt.delete(l),h!==n&&h.parentNode?.removeChild(h)}});return is.set(c,u),c}let is=new WeakMap;class Dr{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(e,n=!0){this.anchor=e,this.#l=n}#s=()=>{var e=M;if(this.#e.has(e)){var n=this.#e.get(e),r=this.#t.get(n);if(r)vn(r),this.#n.delete(n);else{var i=this.#r.get(n);i&&(this.#t.set(n,i.effect),this.#r.delete(n),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),r=i.effect)}for(const[s,a]of this.#e){if(this.#e.delete(s),s===e)break;const o=this.#r.get(a);o&&(X(o.effect),this.#r.delete(a))}for(const[s,a]of this.#t){if(s===n||this.#n.has(s))continue;const o=()=>{if(Array.from(this.#e.values()).includes(s)){var c=document.createDocumentFragment();Ir(a,c),c.append(be()),this.#r.set(s,{effect:a,fragment:c})}else X(a);this.#n.delete(s),this.#t.delete(s)};this.#l||!r?(this.#n.add(s),Ve(a,o,!1)):o()}}};#i=e=>{this.#e.delete(e);const n=Array.from(this.#e.values());for(const[r,i]of this.#r)n.includes(r)||(X(i.effect),this.#r.delete(r))};ensure(e,n){var r=M,i=tr();if(n&&!this.#t.has(e)&&!this.#r.has(e))if(i){var s=document.createDocumentFragment(),a=be();s.append(a),this.#r.set(e,{effect:Q(()=>n(a)),fragment:s})}else this.#t.set(e,Q(()=>n(this.anchor)));if(this.#e.set(r,e),i){for(const[o,l]of this.#t)o===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[o,l]of this.#r)o===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#s),r.ondiscard(this.#i)}else this.#s()}}function me(t,e,n=!1){var r=new Dr(t),i=n?Re:0;function s(a,o){r.ensure(a,o)}Ft(()=>{var a=!1;e((o,l=!0)=>{a=!0,s(l,o)}),a||s(!1,null)},i)}function ss(t,e,...n){var r=new Dr(t);Ft(()=>{const i=e()??null;r.ensure(i,i&&(s=>i(s,...n)))},Re)}const kn=[...` 	
\r\f \v\uFEFF`];function as(t,e,n){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,a=0;(a=r.indexOf(i,a))>=0;){var o=a+s;(a===0||kn.includes(r[a-1]))&&(o===r.length||kn.includes(r[o]))?r=(a===0?"":r.substring(0,a))+r.substring(o+1):a=o}}return r===""?null:r}function os(t,e){return t==null?null:String(t)}function mn(t,e,n,r,i,s){var a=t.__className;if(a!==n||a===void 0){var o=as(n,r,s);o==null?t.removeAttribute("class"):t.className=o,t.__className=n}else if(s&&i!==s)for(var l in s){var c=!!s[l];(i==null||c!==!!i[l])&&t.classList.toggle(l,c)}return s}function Et(t,e,n,r){var i=t.__style;if(i!==e){var s=os(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const ls=Symbol("is custom element"),cs=Symbol("is html");function At(t,e,n,r){var i=us(t);i[e]!==(i[e]=n)&&(e==="loading"&&(t[ti]=n),n==null?t.removeAttribute(e):typeof n!="string"&&fs(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function us(t){return t.__attributes??={[ls]:t.nodeName.includes("-"),[cs]:t.namespaceURI===yi}}var Ln=new Map;function fs(t){var e=t.getAttribute("is")||t.nodeName,n=Ln.get(e);if(n)return n;Ln.set(e,n=[]);for(var r,i=t,s=Element.prototype;s!==i;){r=Wn(i);for(var a in r)r[a].set&&n.push(a);i=sn(i)}return n}function On(t,e){return t===e||t?.[ze]===e}function Cr(t={},e,n,r){return zi(()=>{var i,s;return Gt(()=>{i=s,s=[],Ge(()=>{t!==n(...s)&&(e(t,...s),i&&On(n(...i),t)&&e(null,...i))})}),()=>{yt(()=>{s&&On(n(...s),t)&&e(null,...s)})}}),t}function Tr(t=!1){const e=P,n=e.l.u;if(!n)return;let r=()=>Ki(e.s);if(t){let i=0,s={};const a=Yt(()=>{let o=!1;const l=e.s;for(const c in l)l[c]!==s[c]&&(s[c]=l[c],o=!0);return o&&i++,i});r=()=>p(a)}n.b.length&&Xi(()=>{Mn(e,r),Ct(n.b)}),Mt(()=>{const i=Ge(()=>n.m.map(Qr));return()=>{for(const s of i)typeof s=="function"&&s()}}),n.a.length&&Mt(()=>{Mn(e,r),Ct(n.a)})}function Mn(t,e){if(t.l.s)for(const n of t.l.s)p(n);e()}let en=Symbol();function ie(t,e,n){const r=n[e]??={store:null,source:hn(void 0),unsubscribe:_e};if(r.store!==t&&!(en in n))if(r.unsubscribe(),r.store=t??null,t==null)r.source.v=void 0,r.unsubscribe=_e;else{var i=!0;r.unsubscribe=yn(t,s=>{i?r.source.v=s:N(r.source,s)}),i=!1}return t&&en in n?xr(t):p(r.source)}function _n(){const t={};function e(){gn(()=>{for(var n in t)t[n].unsubscribe();Kn(t,en,{enumerable:!1,value:!0})})}return[t,e]}function tt(t,e,n,r){var i=r,s=!0,a=()=>(s&&(s=!1,i=r),i),o;o=t[e],o===void 0&&r!==void 0&&(o=a());var l;return l=()=>{var c=t[e];return c===void 0?a():(s=!0,c)},l}function hs(t){P===null&&ni(),pt&&P.l!==null?ds(P).m.push(t):Mt(()=>{const e=Ge(t);if(typeof e=="function")return e})}function ds(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}function yn(t,e,n){if(t==null)return e(void 0),n&&n(void 0),_e;const r=Ge(()=>t.subscribe(e,n));return r.unsubscribe?()=>r.unsubscribe():r}const We=[];function gs(t,e){return{subscribe:ae(t,e).subscribe}}function ae(t,e=_e){let n=null;const r=new Set;function i(o){if(jn(t,o)&&(t=o,n)){const l=!We.length;for(const c of r)c[1](),We.push(c,t);if(l){for(let c=0;c<We.length;c+=2)We[c][0](We[c+1]);We.length=0}}}function s(o){i(o(t))}function a(o,l=_e){const c=[o,l];return r.add(c),r.size===1&&(n=e(i,s)||_e),o(t),()=>{r.delete(c),r.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:a}}function Wt(t,e,n){const r=!Array.isArray(t),i=r?[t]:t;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return gs(n,(a,o)=>{let l=!1;const c=[];let u=0,h=_e;const f=()=>{if(u)return;h();const g=e(r?c[0]:c,a,o);s?a(g):h=typeof g=="function"?g:_e},d=i.map((g,b)=>yn(g,T=>{c[b]=T,u&=~(1<<b),l&&f()},()=>{u|=1<<b}));return l=!0,f(),function(){Ct(d),h(),l=!1}})}function xr(t){let e;return yn(t,n=>e=n)(),e}const tn=ae("cs"),ps=ae("orange"),vs=ae("Forest"),nn=ae(!1),st=ae(!1),kr=ae(!1),Lr=ae(!1),Se={BACKGROUND_BASE:-100,BACKGROUND_LAYER_START:-99,GROUND_REFERENCE:-1,ITEMS_BEHIND:5,PLAYER:10,ITEMS_FRONT:15,SELECTION_GRAPHICS:999,GRID_OVERLAY:1e3};function Or(t){return t==="behind"?Se.ITEMS_BEHIND:Se.ITEMS_FRONT}const pe=["orange","white"];class ms{currentSkin=pe[0];currentIndex=0;setSkin(e){pe.includes(e)&&(this.currentSkin=e,this.currentIndex=pe.indexOf(e),localStorage.setItem("catSkin",e))}getSkin(){const e=localStorage.getItem("catSkin");return e&&pe.includes(e)&&(this.currentSkin=e,this.currentIndex=pe.indexOf(e)),this.currentSkin}toggleSkin(){return this.currentIndex=(this.currentIndex+1)%pe.length,this.currentSkin=pe[this.currentIndex],this.setSkin(this.currentSkin),this.currentSkin}getAllSkins(){return pe}}const Mr=new ms,_s={FAST_VELOCITY_THRESHOLD:100,ROTATION_FULL:15,ROTATION_SLIGHT:8};class ys{scene;currentSkin;constructor(e,n="white"){this.scene=e,this.currentSkin=n}createAll(){Mr.getAllSkins().forEach(n=>{this.createAnimationsForSkin(n)})}createAnimationsForSkin(e){const n=this.scene;n.anims.exists(`cat-idle-${e}`)||n.anims.create({key:`cat-idle-${e}`,frames:n.anims.generateFrameNumbers(`cat-idle-${e}`,{start:0,end:3}),frameRate:6,repeat:-1}),n.anims.exists(`cat-walk-${e}`)||n.anims.create({key:`cat-walk-${e}`,frames:n.anims.generateFrameNumbers(`cat-walk-${e}`,{start:0,end:5}),frameRate:12,repeat:-1}),[{key:`cat-jump-up-${e}`,frame:2},{key:`cat-jump-peak-up-${e}`,frame:3},{key:`cat-jump-peak-down-${e}`,frame:3},{key:`cat-jump-down-${e}`,frame:4}].forEach(({key:i,frame:s})=>{n.anims.exists(i)||n.anims.create({key:i,frames:[{key:`cat-walk-${e}`,frame:s}],frameRate:1,repeat:0})})}getSkin(){return this.currentSkin}setSkin(e){this.currentSkin=e}getAnimationKey(e){return`cat-${e}-${this.currentSkin}`}play(e,n){const r=this.getAnimationKey(n);e.anims.currentAnim?.key!==r&&e.play(r)}getJumpAnimationState(e){const{FAST_VELOCITY_THRESHOLD:n,ROTATION_FULL:r,ROTATION_SLIGHT:i}=_s;return e<-n?{animation:this.getAnimationKey("jump-up"),rotation:r,flipMultiplier:1}:e<-20?{animation:this.getAnimationKey("jump-peak-up"),rotation:i,flipMultiplier:1}:e<=n?{animation:this.getAnimationKey("jump-peak-down"),rotation:i,flipMultiplier:-1}:{animation:this.getAnimationKey("jump-down"),rotation:r,flipMultiplier:-1}}handleSkinChange(e,n){const r=this.currentSkin;this.currentSkin=n;const i=e.anims.currentAnim?.key;if(i){const a=`cat-${i.replace("cat-","").replace(`-${r}`,"")}-${n}`;this.scene.anims.exists(a)&&e.play(a)}}}const xe={THRESHOLD_X:20,LANGUAGE_BUTTON:{width:120,height:60},SKIN_BUTTON:{width:120,height:60,yOffset:60}},Pn={SPEED:350,JUMP_STRENGTH:-500};class ws{scene;getPlayerPosition;cursors;keyA;keyD;keyW;keySpace;touchLeft=!1;touchRight=!1;touchJump=!1;touchHandlers;constructor(e){this.scene=e.scene,this.getPlayerPosition=e.getPlayerPosition,this.setupKeyboardControls(),this.setupTouchControls()}setupKeyboardControls(){this.scene.input.keyboard&&(this.cursors=this.scene.input.keyboard.createCursorKeys(),this.keyA=this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.A),this.keyD=this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.D),this.keyW=this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.W),this.keySpace=this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.SPACE))}setupTouchControls(){const e=this.scene,n=a=>{const o=a.x,l=a.y,c=e.scale.width;if(o>c-xe.LANGUAGE_BUTTON.width&&l<xe.LANGUAGE_BUTTON.height||o>c-xe.SKIN_BUTTON.width&&l>=xe.SKIN_BUTTON.yOffset&&l<xe.SKIN_BUTTON.yOffset+xe.SKIN_BUTTON.height)return;const u=e.cameras.main,h=this.getPlayerPosition(),f=h.x-u.scrollX,d=h.y-u.scrollY,g=o-f,b=l-d;g<-20?(this.touchLeft=!0,this.touchRight=!1):g>xe.THRESHOLD_X?(this.touchRight=!0,this.touchLeft=!1):(this.touchLeft=!1,this.touchRight=!1),this.touchJump=b<-80},r=a=>{n(a)},i=a=>{a.isDown&&n(a)},s=()=>{this.touchLeft=!1,this.touchRight=!1,this.touchJump=!1};e.input.on("pointerdown",r),e.input.on("pointermove",i),e.input.on("pointerup",s),this.touchHandlers={pointerdown:r,pointermove:i,pointerup:s}}getInputState(){const e=this.keyA?.isDown||this.cursors?.left?.isDown||this.touchLeft||!1,n=this.keyD?.isDown||this.cursors?.right?.isDown||this.touchRight||!1,r=this.keySpace?.isDown||this.keyW?.isDown||this.cursors?.space?.isDown||this.cursors?.up?.isDown||this.touchJump||!1;return{left:e,right:n,jump:r}}hasAnyInput(){const e=this.getInputState();return e.left||e.right||e.jump}destroy(){this.touchHandlers&&(this.scene.input.off("pointerdown",this.touchHandlers.pointerdown),this.scene.input.off("pointermove",this.touchHandlers.pointermove),this.scene.input.off("pointerup",this.touchHandlers.pointerup),this.touchHandlers=void 0)}}class bs extends x.Physics.Arcade.Sprite{animations;inputController;animState="idle";hasNotifiedMovement=!1;hasReceivedInput=!1;constructor(e,n,r){const i="white";super(e,n,r,`cat-idle-${i}`),e.add.existing(this),e.physics.add.existing(this),this.animations=new ys(e,i),this.animations.createAll(),this.inputController=new ws({scene:e,getPlayerPosition:()=>({x:this.x,y:this.y})}),this.setCollideWorldBounds(!0),this.setBounce(0),this.setSize(40,40),this.setOffset(4,8),this.setScale(5),this.setDepth(Se.PLAYER),this.animations.play(this,"idle")}changeSkin(e){this.animations.handleSkinChange(this,e)}updateJumpAnimation(e){const{animation:n,rotation:r,flipMultiplier:i}=this.animations.getJumpAnimationState(e);this.anims.currentAnim?.key!==n&&this.play(n);const s=this.flipX?r*i:-r*i;this.setAngle(s)}update(){const e=this.inputController.getInputState(),n=this.body,r=n&&(n.blocked.down||n.touching.down);switch(this.inputController.hasAnyInput()&&!this.hasReceivedInput&&(this.hasReceivedInput=!0),this.hasReceivedInput&&this.inputController.hasAnyInput()&&!this.hasNotifiedMovement&&(this.hasNotifiedMovement=!0,Lr.set(!0)),e.left?(this.setVelocityX(-350),this.setFlipX(!0),r&&(this.animState="running")):e.right?(this.setVelocityX(Pn.SPEED),this.setFlipX(!1),r&&(this.animState="running")):(this.setVelocityX(0),r&&(this.animState="idle")),e.jump&&r&&(this.setVelocityY(Pn.JUMP_STRENGTH),this.animState="jumping"),!r&&n&&n.velocity.y!==0&&(this.animState="jumping"),this.animState){case"idle":this.animations.play(this,"idle"),this.setAngle(0);break;case"running":this.animations.play(this,"walk"),this.setAngle(0);break;case"jumping":this.updateJumpAnimation(n.velocity.y);break}}destroy(e){this.inputController.destroy(),super.destroy(e)}}const ke=[{name:"FOREST",folder:"forest",scrollFactors:[1,.8,.85,.9,.95,1]},{name:"FOREST BLUE",folder:"forest_blue",scrollFactors:[1,.8,.85,.9,.95,1]}];class Ss{currentIndex=0;constructor(){const e=localStorage.getItem("background");if(e){const n=ke.findIndex(r=>r.folder===e);n!==-1&&(this.currentIndex=n)}}getBackground(){return ke[this.currentIndex].folder}getCurrentConfig(){return ke[this.currentIndex]}setBackground(e){const n=ke.findIndex(r=>r.folder===e);n!==-1&&(this.currentIndex=n,localStorage.setItem("background",e))}toggleBackground(){this.currentIndex=(this.currentIndex+1)%ke.length;const e=ke[this.currentIndex];return localStorage.setItem("background",e.folder),e}getAllBackgrounds(){return ke}}const Rt=new Ss;function Pr(t,e){return new Promise(n=>{t.load.image(`bg0-${e.folder}`,`assets/backgrounds/${e.folder}/0.png`);for(let r=0;r<e.scrollFactors.length;r++){const i=r+1;t.load.image(`bg${i}-${e.folder}`,`assets/backgrounds/${e.folder}/${i}.png`)}t.load.once("complete",()=>{n(!0)}),t.load.once("loaderror",r=>{console.error(`Failed to load background asset: ${r.key}`),n(!1)}),t.load.start()})}function Rr(t,e,n,r){const i=Math.max(n,t.scale.height),s=t.add.tileSprite(0,0,e,i,`bg0-${r.folder}`);s.setOrigin(0,0),s.setScrollFactor(1),s.setDepth(Se.BACKGROUND_BASE),s.tilePositionX=0,s.tilePositionY=0;const a=[];for(let o=0;o<r.scrollFactors.length;o++){const c=`bg${o+1}-${r.folder}`;if(t.textures.exists(c)){const u=t.add.image(0,0,c);u.setOrigin(0,0),u.setScrollFactor(r.scrollFactors[o]),u.setDepth(Se.BACKGROUND_LAYER_START+o),u.setDisplaySize(e,n),a.push(u)}}return{baseLayer:s,bgLayers:a}}function Nr(t,e){t&&(t.tilePositionX=e.scrollX)}function Is(t){t.bgLayers.forEach(e=>e.destroy()),t.baseLayer.destroy()}const Es={isActive:!1,config:null,selectedItemId:null,itemDepthLayer:"behind"},z=ae(Es),As=Wt(z,t=>t.isActive),Ds=Wt(z,t=>t.config),Hr=Wt(z,t=>t.selectedItemId),Br=Wt(z,t=>t.itemDepthLayer);function Rn(t,e){z.update(n=>n.config?{...n,config:{...n.config,playerStartX:t,playerStartY:e}}:n)}function Cs(t){z.update(e=>{if(!e.config)return e;const n=e.config.placedItems||[];return{...e,config:{...e.config,placedItems:[...n,t]}}})}function $r(t,e){z.update(n=>!n.config||!n.config.placedItems?n:{...n,config:{...n.config,placedItems:n.config.placedItems.map(r=>r.id===t?{...r,...e}:r)}})}function Yr(t){z.update(e=>!e.config||!e.config.placedItems?e:{...e,config:{...e.config,placedItems:e.config.placedItems.filter(n=>n.id!==t)},selectedItemId:e.selectedItemId===t?null:e.selectedItemId})}function wn(t){z.update(e=>({...e,selectedItemId:t}))}function Gr(){z.update(t=>({...t,selectedItemId:null}))}function Ts(){z.update(t=>({...t,itemDepthLayer:t.itemDepthLayer==="behind"?"front":"behind"}))}function xs(t,e){$r(t,{depth:e})}function ks(t){z.set({isActive:!0,config:{...t,placedItems:t.placedItems||[]},selectedItemId:null,itemDepthLayer:"behind"}),bt.set(!1)}function Ls(){z.update(t=>({...t,isActive:!1,selectedItemId:null})),bt.set(!1)}function Os(){return xr(z).config}const bt=ae(!1);function Nn(t){bt.set(t)}const Fr=ae({scrollX:0,scrollY:0,viewWidth:0,viewHeight:0,worldWidth:0,worldHeight:0,zoom:1,playerX:0,playerY:0});function Ms(t){Fr.update(e=>({...e,...t}))}const bn=[{key:"tent",name:"Tent",path:"assets/ui/tent.png",scale:6,category:"structures"},{key:"lamp",name:"Lamp",path:"assets/ui/lamp.png",scale:8,category:"props"},{key:"sign_left",name:"Sign ←",path:"assets/ui/sign_left.png",scale:7,category:"signs"},{key:"sign_right",name:"Sign →",path:"assets/ui/sign_right.png",scale:7,category:"signs"},{key:"stone_0",name:"Stone 0",path:"assets/ui/stone_0.png",scale:4,category:"nature"},{key:"stone_1",name:"Stone 1",path:"assets/ui/stone_1.png",scale:5,category:"nature"},{key:"stone_2",name:"Stone 2",path:"assets/ui/stone_2.png",scale:4,category:"nature"}];function Ps(t){return bn.find(e=>e.key===t)}function Rs(t){return Ps(t)?.scale||1}class Hn{scene;groundY;constructor(e,n){this.scene=e,this.groundY=n}static preloadAssets(e){bn.forEach(n=>{e.load.image(n.key,n.path)})}createSprite(e){const{id:n,assetKey:r,x:i,scale:s=1,depth:a=5,yOffset:o=0}=e,l=this.groundY+o,c=this.scene.add.sprite(i,l,r);return c.setScale(s),c.setDepth(a),c.setData("itemId",n),c}updatePosition(e,n,r){e.x=n,e.y=this.groundY+r}updateScale(e,n){e.setScale(n)}updateDepth(e,n){e.setDepth(n)}applyUpdates(e,n){n.x!==void 0&&(e.x=n.x),n.yOffset!==void 0&&(e.y=this.groundY+n.yOffset),n.scale!==void 0&&e.setScale(n.scale),n.depth!==void 0&&e.setDepth(n.depth)}worldYToOffset(e){return e-this.groundY}getGroundY(){return this.groundY}}class Ns{scene;groundY;isDragging=!1;callbacks;constructor(e,n,r={}){this.scene=e,this.groundY=n,this.callbacks=r}getIsDragging(){return this.isDragging}makeInteractive(e,n){e.setInteractive({cursor:"pointer"}),this.scene.input.setDraggable(e),e.on("pointerdown",()=>{this.isDragging||wn(n)}),e.on("dragstart",()=>{this.isDragging=!1,e.setTint(4886754),this.scene.data?.set("isDraggingItem",!0),this.callbacks.onDragStart?.(n)}),e.on("drag",(r,i,s)=>{this.isDragging=!0,e.setPosition(i,s),this.callbacks.onDrag?.(n,i,s)}),e.on("dragend",()=>{e.clearTint(),this.scene.data?.set("isDraggingItem",!1);const r=Math.round(e.x),s=Math.round(e.y)-this.groundY;$r(n,{x:r,yOffset:s}),this.callbacks.onDragEnd?.(n,r,s),this.scene.time.delayedCall(50,()=>{this.isDragging=!1})})}removeInteractivity(e){!e||!e.scene||(e.removeInteractive(),e.off("pointerdown"),e.off("dragstart"),e.off("drag"),e.off("dragend"))}}const Hs={lineWidth:3,lineColor:4886754,lineAlpha:1,handleSize:8,handleColor:4886754,padding:5};class Bs{scene;graphics;style;selectedId=null;constructor(e,n={}){this.scene=e,this.style={...Hs,...n},this.graphics=e.add.graphics(),this.graphics.setDepth(Se.SELECTION_GRAPHICS)}setSelectedId(e){this.selectedId=e}getSelectedId(){return this.selectedId}updateVisuals(e){if(this.graphics.clear(),!e||!this.selectedId)return;const n=e.getBounds(),{lineWidth:r,lineColor:i,lineAlpha:s,handleSize:a,handleColor:o,padding:l}=this.style;this.graphics.lineStyle(r,i,s),this.graphics.strokeRect(n.x-l,n.y-l,n.width+l*2,n.height+l*2),this.graphics.fillStyle(o,1),this.graphics.fillCircle(n.x,n.y,a),this.graphics.fillCircle(n.x+n.width,n.y,a),this.graphics.fillCircle(n.x,n.y+n.height,a),this.graphics.fillCircle(n.x+n.width,n.y+n.height,a)}clearVisuals(){this.graphics.clear(),this.selectedId=null}setupBackgroundDeselect(e){this.scene.input.on("pointerdown",n=>{if(e())return;this.scene.input.hitTestPointer(n).find(i=>i.type==="Sprite"&&i.getData("itemId"))||(Gr(),this.clearVisuals())})}destroy(){this.graphics?.destroy()}}class Nt{scene;items=new Map;isBuilderMode=!1;renderer;dragController;selectionManager;constructor(e,n,r=!1){this.scene=e,this.isBuilderMode=r,this.renderer=new Hn(e,n),this.isBuilderMode&&(this.dragController=new Ns(e,n,{onDrag:()=>this.updateSelectionVisuals()}),this.selectionManager=new Bs(e))}static preloadAssets(e){Hn.preloadAssets(e)}createItems(e){e.forEach(n=>{this.createItem(n)})}createItem(e){const n=this.renderer.createSprite(e);this.items.set(e.id,{sprite:n,data:e}),this.isBuilderMode&&this.dragController&&(this.dragController.makeInteractive(n,e.id),n.on("pointerdown",()=>{this.dragController?.getIsDragging()||(wn(e.id),this.updateSelectionVisuals())}))}updateSelectionVisuals(){if(!this.selectionManager)return;const e=this.scene.data.get("selectedItemId");if(this.selectionManager.setSelectedId(e),!e){this.selectionManager.clearVisuals();return}const n=this.items.get(e);this.selectionManager.updateVisuals(n?.sprite??null)}updateItem(e,n){const r=this.items.get(e);r&&(this.renderer.applyUpdates(r.sprite,n),r.data={...r.data,...n})}removeItem(e){const n=this.items.get(e);n&&(this.dragController&&this.dragController.removeInteractivity(n.sprite),n.sprite.destroy(),this.items.delete(e))}removeAllItems(){this.items.forEach(e=>{!e.sprite||!e.sprite.scene||(this.dragController&&this.dragController.removeInteractivity(e.sprite),e.sprite.destroy())}),this.items.clear()}getItem(e){return this.items.get(e)?.data}getAllItems(){return Array.from(this.items.values()).map(e=>e.data)}destroy(){this.removeAllItems(),this.selectionManager?.destroy()}setupBackgroundDeselect(){!this.isBuilderMode||!this.selectionManager||this.selectionManager.setupBackgroundDeselect(()=>this.dragController?.getIsDragging()??!1)}}async function Bn(){const t=await fetch("./config/map.json");if(!t.ok)throw new Error(`Failed to load map config: ${t.status}`);const e=await t.json();if(!e.worldWidth||!e.worldHeight)throw new Error("Invalid map config structure");return e}const Dt={generateId(){return`item_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},create(t){const{assetKey:e,x:n,yOffset:r=0,depthLayer:i="behind",scale:s,dialogConfig:a}=t;return{id:Dt.generateId(),assetKey:e,x:Math.round(n),y:0,scale:s??Rs(e),depth:Or(i),yOffset:Math.round(r),...a&&{dialogConfig:a}}},createAtWorldPosition(t,e,n,r,i="behind"){return Dt.create({assetKey:t,x:e,yOffset:n-r,depthLayer:i})},clone(t,e=50){return{...t,id:Dt.generateId(),x:t.x+e}}},Le={HEIGHT:40,VISUAL:{COLOR:9139029,ALPHA:.3},PHYSICS:{COLOR:0,ALPHA:0}},ht={getGroundY(t,e=Le.HEIGHT){return t-e},createVisualGround(t,e){const n=e.height??Le.HEIGHT,r=ht.getGroundY(e.worldHeight,n),i=t.add.rectangle(0,r,e.worldWidth,n,e.color??Le.VISUAL.COLOR,e.alpha??Le.VISUAL.ALPHA);return i.setOrigin(0,0),i.setDepth(e.depth??Se.GROUND_REFERENCE),{ground:i,groundY:r}},createPhysicsGround(t,e){const n=e.height??Le.HEIGHT,r=ht.getGroundY(e.worldHeight,n),i=t.add.rectangle(0,r,e.worldWidth,n,e.color??Le.PHYSICS.COLOR,e.alpha??Le.PHYSICS.ALPHA);return i.setOrigin(0,0),t.physics.add.existing(i,!0),{ground:i,groundY:r}},addPlayerCollision(t,e,n){return t.physics.add.collider(e,n)}},we={GAME:"GameScene",BUILDER:"BuilderScene"};class $s extends x.Scene{player;mapConfig;parallaxLayers=null;loadedBackgrounds=new Set;itemManager;unsubscribers=[];initData;constructor(){super({key:we.GAME})}init(e){this.initData=e}preload(){pe.forEach(e=>{this.load.spritesheet(`cat-idle-${e}`,`assets/sprites/${e}/Idle.png`,{frameWidth:48,frameHeight:48}),this.load.spritesheet(`cat-walk-${e}`,`assets/sprites/${e}/Walk.png`,{frameWidth:48,frameHeight:48})}),Nt.preloadAssets(this)}create(){this.initializeScene()}async initializeScene(){nn.set(!0);try{await this.loadMapConfiguration();const e=Rt.getCurrentConfig();await this.loadBackgroundIfNeeded(e),this.createParallaxBackground();const{ground:n,groundY:r}=ht.createPhysicsGround(this,{worldWidth:this.mapConfig.worldWidth,worldHeight:this.mapConfig.worldHeight});this.player=new bs(this,this.mapConfig.playerStartX,this.mapConfig.playerStartY),ht.addPlayerCollision(this,this.player,n),this.itemManager=new Nt(this,r,!1),this.mapConfig.placedItems&&this.mapConfig.placedItems.length>0&&this.itemManager.createItems(this.mapConfig.placedItems),this.cameras.main.startFollow(this.player,!0,.1,.1),this.cameras.main.setBounds(0,0,this.mapConfig.worldWidth,this.mapConfig.worldHeight),this.physics.world.setBounds(0,0,this.mapConfig.worldWidth,this.mapConfig.worldHeight),this.scale.on("resize",this.handleResize,this)}catch(e){console.error("[GameScene] Failed to initialize scene:",e)}finally{nn.set(!1)}}async loadMapConfiguration(){try{if(this.initData?.useBuilderConfig){const e=Os();this.mapConfig=e||await Bn()}else this.mapConfig=await Bn()}catch(e){console.error("[GameScene] Failed to load map configuration:",e),this.mapConfig={worldWidth:3200,worldHeight:600,playerStartX:400,playerStartY:300,placedItems:[]}}}createParallaxBackground(){const e=Rt.getCurrentConfig();this.parallaxLayers=Rr(this,this.mapConfig.worldWidth,this.mapConfig.worldHeight,e)}async loadBackgroundIfNeeded(e){if(this.loadedBackgrounds.has(e.folder))return!0;const n=await Pr(this,e);return n&&this.loadedBackgrounds.add(e.folder),n}handleResize(e){if(!(!this.cameras?.main||!this.mapConfig)&&(this.cameras.main.setBounds(0,0,this.mapConfig.worldWidth,this.mapConfig.worldHeight),this.parallaxLayers?.baseLayer)){const n=Math.max(this.mapConfig.worldHeight,e.height);this.parallaxLayers.baseLayer.setSize(this.mapConfig.worldWidth,n)}}shutdown(){this.scale.off("resize",this.handleResize,this),this.unsubscribers.forEach(e=>e()),this.unsubscribers=[],this.itemManager&&this.itemManager.destroy()}update(){this.player&&(this.player.update(),this.parallaxLayers&&Nr(this.parallaxLayers.baseLayer,this.cameras.main))}}const Ys=.3,Gs=1,It=400;class Fs{scene;camera;worldWidth;worldHeight;isPanning=!1;panStartX=0;cameraDragStartX=0;isDraggingToScroll=!1;dragScrollStartX=0;dragScrollStartY=0;dragScrollCameraStartX=0;dragScrollCameraStartY=0;isZoomedOut=!1;isAnimating=!1;savedScrollX=0;savedScrollY=0;constructor(e,n,r){this.scene=e,this.camera=e.cameras.main,this.worldWidth=n,this.worldHeight=r}setup(){this.setupCamera(),this.setupMouseControls(),this.setupKeyboardControls()}setupCamera(){this.camera.setBounds(0,0,this.worldWidth,this.worldHeight),this.camera.setZoom(1)}centerOn(e,n){this.camera.centerOn(e,n)}setupMouseControls(){this.scene.input.on("wheel",(e,n,r,i)=>{if(this.isZoomedOut)return;const s=r!==0?r:i,a=this.camera.scrollX+s;this.camera.setScroll(x.Math.Clamp(a,0,this.worldWidth-this.camera.width),this.camera.scrollY)}),this.scene.input.on("pointerdown",e=>{this.isZoomedOut||(e.rightButtonDown()||e.middleButtonDown()?(this.isPanning=!0,this.panStartX=e.x,this.cameraDragStartX=this.camera.scrollX):e.leftButtonDown()&&!this.isDraggingObject()&&(this.scene.data.get("isDraggingItem")===!0||(this.dragScrollStartX=e.x,this.dragScrollStartY=e.y,this.dragScrollCameraStartX=this.camera.scrollX,this.dragScrollCameraStartY=this.camera.scrollY)))}),this.scene.input.on("pointermove",e=>{if(!this.isZoomedOut){if(this.isPanning){const n=e.x-this.panStartX,r=this.cameraDragStartX-n;this.camera.setScroll(x.Math.Clamp(r,0,this.worldWidth-this.camera.width),this.camera.scrollY)}else if(e.leftButtonDown()&&!this.isDraggingToScroll&&!this.isDraggingObject()&&!(this.scene.data.get("isDraggingItem")===!0)){const r=Math.abs(e.x-this.dragScrollStartX),i=Math.abs(e.y-this.dragScrollStartY);Math.sqrt(r*r+i*i)>10&&(this.isDraggingToScroll=!0,this.scene.input.setDefaultCursor("grabbing"))}if(this.isDraggingToScroll){const n=e.x-this.dragScrollStartX,r=e.y-this.dragScrollStartY,i=this.dragScrollCameraStartX-n,s=this.dragScrollCameraStartY-r;this.camera.setScroll(x.Math.Clamp(i,0,this.worldWidth-this.camera.width),x.Math.Clamp(s,0,this.worldHeight-this.camera.height))}}}),this.scene.input.on("pointerup",e=>{!e.rightButtonDown()&&!e.middleButtonDown()&&(this.isPanning=!1),this.isDraggingToScroll&&(this.isDraggingToScroll=!1,this.scene.input.setDefaultCursor("default"))})}setupKeyboardControls(){const e=this.scene.input.keyboard.createCursorKeys(),n={w:this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.W),a:this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.A),s:this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.S),d:this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.D)};this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.SPACE).on("down",()=>{this.isZoomedOut||this.centerOnPlayer()}),this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.F).on("down",()=>{this.toggleZoomToFit()}),this.scene.events.on("update",()=>{if(this.isZoomedOut)return;const s=10;e.left.isDown||n.a.isDown?this.camera.scrollX=Math.max(0,this.camera.scrollX-s):(e.right.isDown||n.d.isDown)&&(this.camera.scrollX=Math.min(this.worldWidth-this.camera.width,this.camera.scrollX+s)),e.up.isDown||n.w.isDown?this.camera.scrollY=Math.max(0,this.camera.scrollY-s):(e.down.isDown||n.s.isDown)&&(this.camera.scrollY=Math.min(this.worldHeight-this.camera.height,this.camera.scrollY+s))})}centerOnPlayer(){const e=this.scene.data.get("playerSprite");e&&this.camera.centerOn(e.x,e.y)}isDraggingObject(){return this.scene.data.get("isDraggingObject")===!0}getIsZoomedOut(){return this.isZoomedOut}toggleZoomToFit(){this.isZoomedOut?this.resetZoom():this.zoomToFit()}zoomToFit(){if(this.isZoomedOut||this.isAnimating)return;this.savedScrollX=this.camera.scrollX,this.savedScrollY=this.camera.scrollY,this.isZoomedOut=!0,this.isAnimating=!0,Nn(!0);const e=this.camera.width/this.worldWidth,n=this.camera.height/this.worldHeight;let r=Math.min(e,n);r=Math.max(r,Ys);const i=this.worldWidth/2,s=this.worldHeight/2;this.camera.removeBounds(),this.camera.pan(i,s,It,"Sine.easeInOut"),this.camera.zoomTo(r,It,"Sine.easeInOut",!1,(a,o)=>{o===1&&(this.isAnimating=!1)})}resetZoom(){if(!this.isZoomedOut||this.isAnimating)return;this.isZoomedOut=!1,this.isAnimating=!0,Nn(!1);const e=this.savedScrollX+this.camera.width/2,n=this.savedScrollY+this.camera.height/2;this.camera.pan(e,n,It,"Sine.easeInOut"),this.camera.zoomTo(Gs,It,"Sine.easeInOut",!1,(r,i)=>{i===1&&(this.camera.setBounds(0,0,this.worldWidth,this.worldHeight),this.isAnimating=!1)})}destroy(){}}const Ht=40,Ks=48,$n=5,Ws=Se.PLAYER,Yn=100,Xs=4871528,Us=.4,zs=1,Vs=Se.GRID_OVERLAY,Ut=16711680,js=2,Zs=.6,qs=.1,Js=1,Qs=.2,Gn=50,ea=50,ta=10,na=4886754;class ra{scene;player;worldWidth;worldHeight;groundY;constructor(e,n,r){this.scene=e,this.worldWidth=n,this.worldHeight=r,this.groundY=r-Ht}create(e,n){this.player=this.scene.add.sprite(e,n,"cat-idle-white",0),this.player.setScale($n),this.player.setDepth(Ws);const r=new x.Geom.Rectangle(8,4,32,40);return this.player.setInteractive({hitArea:r,hitAreaCallback:x.Geom.Rectangle.Contains,draggable:!0,cursor:"grab"}),this.scene.data.set("playerSprite",this.player),this.setupDragHandlers(),this.player}setupDragHandlers(){this.player.on("dragstart",()=>{this.player.setTint(na),this.scene.data.set("isDraggingObject",!0)}),this.player.on("drag",(e,n,r)=>{const i=x.Math.Clamp(n,Gn,this.worldWidth-Gn),s=x.Math.Clamp(r,ea,this.worldHeight-ta);this.player.setPosition(i,s),Rn(Math.round(i),Math.round(s))}),this.player.on("dragend",()=>{this.player.clearTint(),this.scene.data.set("isDraggingObject",!1);let e=this.player.y;const n=Ks*$n;this.player.y+n/2>this.groundY&&(e=this.groundY-n/2,this.player.setY(e)),Rn(Math.round(this.player.x),Math.round(e))})}getSprite(){return this.player}destroy(){this.player&&this.player.destroy()}}class ia{scene;graphics;worldWidth;worldHeight;constructor(e,n,r){this.scene=e,this.worldWidth=n,this.worldHeight=r}create(){return this.graphics=this.scene.add.graphics(),this.graphics.setDepth(Vs),this.draw(),this.graphics}draw(){this.graphics.clear(),this.graphics.lineStyle(zs,Xs,Us);const e=Math.max(this.worldHeight,this.scene.scale.height);for(let r=0;r<=this.worldWidth;r+=Yn)this.graphics.beginPath(),this.graphics.moveTo(r,0),this.graphics.lineTo(r,e),this.graphics.strokePath();for(let r=0;r<=e;r+=Yn)this.graphics.beginPath(),this.graphics.moveTo(0,r),this.graphics.lineTo(this.worldWidth,r),this.graphics.strokePath();const n=this.worldHeight-Ht;this.graphics.lineStyle(js,Ut,Zs),this.graphics.beginPath(),this.graphics.moveTo(0,n),this.graphics.lineTo(this.worldWidth,n),this.graphics.strokePath(),this.graphics.lineStyle(Js,Ut,Qs),this.graphics.fillStyle(Ut,qs),this.graphics.fillRect(0,n,this.worldWidth,e-n)}getGraphics(){return this.graphics}redraw(){this.draw()}destroy(){this.graphics&&this.graphics.destroy()}}class sa{listeners=new Map;on(e,n){this.listeners.has(e)||this.listeners.set(e,new Set);const r=this.listeners.get(e);return r.add(n),{unsubscribe:()=>{r.delete(n),r.size===0&&this.listeners.delete(e)}}}once(e,n){const r=this.on(e,i=>{r.unsubscribe(),n(i)});return r}emit(e,n){const r=this.listeners.get(e);r&&r.forEach(i=>{try{i(n)}catch(s){console.error(`[EventBus] Error in listener for "${e}":`,s)}})}off(e){this.listeners.delete(e)}clear(){this.listeners.clear()}listenerCount(e){return this.listeners.get(e)?.size??0}}const dt=new sa,gt={ASSET_DROPPED:"asset:dropped",MINIMAP_NAVIGATE:"minimap:navigate"};class aa{scene;groundY;itemManager;unsubscribers=[];constructor(e,n){this.scene=e,this.groundY=n}create(e){return this.itemManager=new Nt(this.scene,this.groundY,!0),e&&e.length>0&&this.itemManager.createItems(e),this.setupBackgroundDeselect(),this.setupStoreSubscriptions(),this.setupAssetDropListener(),this.setupDeleteKeys(),this.itemManager}setupBackgroundDeselect(){this.itemManager.setupBackgroundDeselect()}setupStoreSubscriptions(){const e=Hr.subscribe(i=>{this.scene.data.set("selectedItemId",i),this.itemManager.updateSelectionVisuals()});this.unsubscribers.push(e);let n=[];const r=Ds.subscribe(i=>{if(!i?.placedItems)return;const s=i.placedItems;n.forEach(a=>{s.find(l=>l.id===a.id)||this.itemManager.removeItem(a.id)}),s.forEach(a=>{const o=n.find(l=>l.id===a.id);o&&JSON.stringify(o)!==JSON.stringify(a)&&this.itemManager.updateItem(a.id,a)}),n=s.map(a=>({...a}))});this.unsubscribers.push(r)}setupAssetDropListener(){const e=dt.on(gt.ASSET_DROPPED,n=>{const{assetKey:r,canvasX:i,canvasY:s}=n,o=this.scene.cameras.main.getWorldPoint(i,s),l=o.x,c=o.y;let u="behind";Br.subscribe(d=>{u=d})();const f=Dt.createAtWorldPosition(r,l,c,this.groundY,u);Cs(f),this.itemManager.createItem(f),wn(f.id)});this.unsubscribers.push(()=>e.unsubscribe())}setupDeleteKeys(){const e=this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.DELETE),n=this.scene.input.keyboard.addKey(x.Input.Keyboard.KeyCodes.BACKSPACE),r=()=>{const i=this.scene.data.get("selectedItemId");i&&Yr(i)};e.on("down",r),n.on("down",r)}getManager(){return this.itemManager}destroy(){this.unsubscribers.forEach(e=>e()),this.unsubscribers=[],this.itemManager&&this.itemManager.destroy()}}class oa extends x.Scene{parallaxLayers=null;cameraController;playerController;gridOverlay;itemsController;config;minimapSubscription;isShuttingDown=!1;get itemManager(){return this.itemsController?.getManager()}toggleZoom(){this.cameraController?.toggleZoomToFit()}constructor(){super({key:we.BUILDER})}init(e){this.config=e.config}preload(){this.load.spritesheet("cat-idle-white","assets/sprites/white/Idle.png",{frameWidth:48,frameHeight:48}),Nt.preloadAssets(this)}create(){this.isShuttingDown=!1,this.physics.world.setBounds(0,0,this.config.worldWidth,this.config.worldHeight);const e=this.config.worldHeight-Ht;this.cameraController=new Fs(this,this.config.worldWidth,this.config.worldHeight),this.playerController=new ra(this,this.config.worldWidth,this.config.worldHeight),this.gridOverlay=new ia(this,this.config.worldWidth,this.config.worldHeight),this.itemsController=new aa(this,e),this.createBackground(),this.gridOverlay.create(),this.createGroundReference(),this.playerController.create(this.config.playerStartX,this.config.playerStartY),this.itemsController.create(this.config.placedItems||[]),this.cameraController.setup(),this.cameraController.centerOn(this.config.playerStartX,this.config.playerStartY),this.minimapSubscription=dt.on(gt.MINIMAP_NAVIGATE,n=>{this.navigateToPosition(n.worldX,n.worldY)}),this.scale.on("resize",this.handleResize,this),this.events.on("shutdown",this.shutdown,this)}async createBackground(){const e=Rt.getCurrentConfig();try{await Pr(this,e)}catch(n){console.error("Failed to load background:",n);return}this.parallaxLayers&&(Is(this.parallaxLayers),this.parallaxLayers=null),this.parallaxLayers=Rr(this,this.config.worldWidth,this.config.worldHeight,e)}createGroundReference(){ht.createVisualGround(this,{worldWidth:this.config.worldWidth,worldHeight:this.config.worldHeight,height:Ht})}update(){this.parallaxLayers&&Nr(this.parallaxLayers.baseLayer,this.cameras.main);const e=this.cameras.main,n=this.data.get("playerSprite");Ms({scrollX:e.scrollX,scrollY:e.scrollY,viewWidth:e.width,viewHeight:e.height,worldWidth:this.config.worldWidth,worldHeight:this.config.worldHeight,zoom:e.zoom,playerX:n?.x??this.config.playerStartX,playerY:n?.y??this.config.playerStartY})}navigateToPosition(e,n){this.cameraController.getIsZoomedOut()||this.cameraController.centerOn(e,n)}handleResize(e){if(!(!this.cameras?.main||!this.config)){if(this.cameraController?.getIsZoomedOut()||this.cameras.main.setBounds(0,0,this.config.worldWidth,this.config.worldHeight),this.parallaxLayers?.baseLayer){const n=Math.max(this.config.worldHeight,e.height);this.parallaxLayers.baseLayer.setSize(this.config.worldWidth,n)}this.gridOverlay&&this.gridOverlay.redraw()}}shutdown(){this.isShuttingDown||(this.isShuttingDown=!0,this.scale.off("resize",this.handleResize,this),this.minimapSubscription&&this.minimapSubscription.unsubscribe(),this.cameraController&&this.cameraController.destroy(),this.playerController&&this.playerController.destroy(),this.gridOverlay&&this.gridOverlay.destroy(),this.itemsController&&this.itemsController.destroy())}}const la="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(la);di();class ca{currentLanguage="cs";setLanguage(e){this.currentLanguage=e,localStorage.setItem("language",e)}getLanguage(){const e=localStorage.getItem("language");return(e==="cs"||e==="en")&&(this.currentLanguage=e),this.currentLanguage}toggleLanguage(){return this.currentLanguage=this.currentLanguage==="cs"?"en":"cs",this.setLanguage(this.currentLanguage),this.currentLanguage}}const Kr=new ca;let te=null;function ua(t){te=t}function fa(){if(!te)return console.error("Scene manager not initialized"),null;try{return te.scene.getScene(we.GAME)?.mapConfig||null}catch(t){return console.error("Failed to get map config:",t),null}}function ha(t){if(!te)return console.error("Scene manager not initialized"),!1;try{return te.scene.getScene(we.GAME)?(te.scene.stop(we.GAME),ks(t),te.scene.start(we.BUILDER,{config:t}),!0):(console.error("GameScene not found"),!1)}catch(e){return console.error("Failed to switch to builder:",e),!1}}function da(){if(!te)return console.error("Scene manager not initialized"),!1;try{return te.scene.stop(we.BUILDER),Ls(),te.scene.start(we.GAME,{useBuilderConfig:!0}),!0}catch(t){return console.error("Failed to switch to game:",t),!1}}function ga(){if(te)try{te.scene.getScene(we.BUILDER)?.toggleZoom()}catch(t){console.error("Failed to toggle zoom:",t)}}var pa=ne("<button><!></button>");function Me(t,e){let n=tt(e,"position",3,"top-right"),r=tt(e,"variant",3,"default"),i=tt(e,"disabled",3,!1),s=tt(e,"title",3,""),a=tt(e,"width",3,"100px");const o={default:{base:"#4a90e2",hover:"#357abd",active:"#2a5f8f"},green:{base:"#27ae60",hover:"#229954",active:"#1e8449"},blue:{base:"#3498db",hover:"#2980b9",active:"#21618c"},orange:{base:"#ffa500",hover:"#ff8c00",active:"#e67e00"},red:{base:"#e74c3c",hover:"#c0392b",active:"#a02e22"}},l=rt(()=>o[r()]);var c=pa();let u;c.__click=function(...f){e.onclick?.apply(this,f)};var h=Z(c);ss(h,()=>e.children??_e),$e(()=>{u=mn(c,1,`pixel-btn pixel-btn--${n()??""}`,"svelte-lwc0vq",u,{disabled:i()}),Et(c,`--btn-width: ${a()??""}; --color-base: ${p(l).base??""}; --color-hover: ${p(l).hover??""}; --color-active: ${p(l).active??""}`),c.disabled=i(),At(c,"title",s())}),H(t,c)}Kt(["click"]);var va=ne('<div draggable="true" role="button" tabindex="0"><img class="asset-preview svelte-1ahretz"/> <span class="asset-name svelte-1ahretz"> </span></div>'),ma=ne('<div class="palette-dropdown svelte-1ahretz" role="toolbar" tabindex="-1"><div class="palette-header svelte-1ahretz"><span class="palette-title svelte-1ahretz">Assets</span> <span class="palette-hint svelte-1ahretz">Drag to place</span></div> <div class="palette-grid svelte-1ahretz"></div></div>'),_a=ne('<div class="palette-container svelte-1ahretz"><!> <!></div>');function ya(t,e){vt(e,!0);const n=bn;let r=j(!1),i=j(null),s=j(null);function a(v){v.stopPropagation(),v.preventDefault(),N(r,!p(r))}function o(v,y){if(!v.dataTransfer)return;N(i,y,!0),v.dataTransfer.effectAllowed="copy",v.dataTransfer.setData("assetKey",y);const w=v.target.querySelector("img")?.cloneNode(!0);w&&(w.style.position="absolute",w.style.top="-1000px",document.body.appendChild(w),v.dataTransfer.setDragImage(w,24,24),setTimeout(()=>w.remove(),0))}function l(){N(i,null)}function c(v,y){if(v.touches.length!==1)return;const S=v.touches[0];N(i,y,!0);const A=v.currentTarget.querySelector("img");if(A){const I=document.createElement("div");I.className="touch-drag-preview",I.innerHTML=`<img src="${A.src}" alt="" />`,I.style.cssText=`
        position: fixed;
        top: ${S.clientY-24}px;
        left: ${S.clientX-24}px;
        width: 48px;
        height: 48px;
        pointer-events: none;
        z-index: 10000;
        opacity: 0.9;
        image-rendering: pixelated;
        filter: drop-shadow(3px 3px 0 rgba(0, 0, 0, 0.5));
        border: 2px solid #4a90e2;
        background: rgba(26, 26, 46, 0.9);
      `,I.querySelector("img").style.cssText=`
        width: 100%;
        height: 100%;
        object-fit: contain;
        image-rendering: pixelated;
      `,document.body.appendChild(I),N(s,I,!0)}}function u(v){if(!p(i)||!p(s))return;const y=v.touches[0];p(s).style.top=`${y.clientY-24}px`,p(s).style.left=`${y.clientX-24}px`,v.preventDefault()}function h(v){if(!p(i))return;const y=v.changedTouches[0],S=document.querySelector("canvas");if(p(s)&&(p(s).remove(),N(s,null)),S){const w=S.getBoundingClientRect(),A=y.clientX,I=y.clientY;if(A>=w.left&&A<=w.right&&I>=w.top&&I<=w.bottom){const R=A-w.left,m=I-w.top;dt.emit(gt.ASSET_DROPPED,{assetKey:p(i),canvasX:R,canvasY:m})}}N(i,null)}function f(v){v.stopPropagation()}function d(v){v.preventDefault(),v.dataTransfer&&(v.dataTransfer.dropEffect="copy")}function g(v){v.preventDefault();const y=v.dataTransfer?.getData("assetKey");if(!y)return;const w=v.target.getBoundingClientRect(),A=v.clientX-w.left,I=v.clientY-w.top;dt.emit(gt.ASSET_DROPPED,{assetKey:y,canvasX:A,canvasY:I})}hs(()=>{const v=document.querySelector("canvas");if(v)return v.addEventListener("dragover",d),v.addEventListener("drop",g),()=>{v.removeEventListener("dragover",d),v.removeEventListener("drop",g)}}),Mt(()=>(document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",h),document.addEventListener("touchcancel",h),()=>{document.removeEventListener("touchmove",u),document.removeEventListener("touchend",h),document.removeEventListener("touchcancel",h)}));var b=_a(),T=Z(b);Me(T,{onclick:a,position:"top-right",variant:"blue",width:"140px",title:"Asset Palette",children:(v,y)=>{var S=Oe();$e(()=>ft(S,`${p(r)?"▼":"◀"} ASSETS`)),H(v,S)},$$slots:{default:!0}});var L=B(T,2);{var O=v=>{var y=ma();y.__pointerdown=f;var S=B(Z(y),2);Oi(S,21,()=>n,ki,(w,A)=>{var I=va();let R;I.__touchstart=k=>c(k,p(A).key);var m=Z(I),D=B(m,2),_=Z(D);$e(()=>{R=mn(I,1,"asset-item svelte-1ahretz",null,R,{dragging:p(i)===p(A).key}),At(I,"title",p(A).name),At(m,"src",p(A).path),At(m,"alt",p(A).name),ft(_,p(A).name)}),Qt("dragstart",I,k=>o(k,p(A).key)),Qt("dragend",I,l),H(w,I)}),H(v,y)};me(L,v=>{p(r)&&v(O)})}H(t,b),mt()}Kt(["pointerdown","touchstart"]);var wa=ne('<div><div class="minimap-bg svelte-1ycb7lo"></div> <div class="viewport-indicator svelte-1ycb7lo"></div> <div class="player-marker svelte-1ycb7lo"></div> <div class="minimap-frame svelte-1ycb7lo"></div></div>');function ba(t,e){vt(e,!0);const n=()=>ie(Fr,"$builderCameraInfo",i),r=()=>ie(bt,"$isBuilderZoomedOut",i),[i,s]=_n(),a=120,o=60,l=200,c=100;let u=j(!1),h=null,f=rt(()=>p(u)?l:a),d=rt(()=>p(u)?c:o),g=rt(()=>{const m=n();if(!m||m.worldWidth===0)return"display: none;";const D=p(f)/m.worldWidth,_=p(d)/m.worldHeight,k=m.viewWidth/m.zoom*D,ge=m.viewHeight/m.zoom*_,re=m.scrollX*D,Fe=m.scrollY*_;return`
      left: ${Math.max(0,re)}px;
      top: ${Math.max(0,Fe)}px;
      width: ${Math.min(k,p(f)-re)}px;
      height: ${Math.min(ge,p(d)-Fe)}px;
    `}),b=rt(()=>{const m=n();if(!m||m.worldWidth===0)return"display: none;";const D=p(f)/m.worldWidth,_=p(d)/m.worldHeight,k=m.playerX*D,ge=m.playerY*_;return`
      left: ${k}px;
      top: ${ge}px;
    `});function T(m,D){const _=n();if(!_||_.worldWidth===0||!h)return;const k=h.getBoundingClientRect(),ge=m-k.left,re=D-k.top,Fe=ge/p(f)*_.worldWidth,Ur=re/p(d)*_.worldHeight;dt.emit(gt.MINIMAP_NAVIGATE,{worldX:Fe,worldY:Ur})}function L(m){m.stopPropagation(),m.preventDefault(),N(u,!0),T(m.clientX,m.clientY),window.addEventListener("mousemove",O),window.addEventListener("mouseup",v)}function O(m){p(u)&&(m.preventDefault(),T(m.clientX,m.clientY))}function v(){N(u,!1),window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",v)}function y(m){m.stopPropagation(),m.preventDefault(),N(u,!0);const D=m.touches[0];T(D.clientX,D.clientY),window.addEventListener("touchmove",S,{passive:!1}),window.addEventListener("touchend",w)}function S(m){if(!p(u))return;m.preventDefault();const D=m.touches[0];T(D.clientX,D.clientY)}function w(){N(u,!1),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",w)}var A=Ar(),I=cn(A);{var R=m=>{var D=wa();let _;D.__mousedown=L,D.__touchstart=y;var k=B(Z(D),2),ge=B(k,2);Cr(D,re=>h=re,()=>h),$e(()=>{_=mn(D,1,"minimap-container svelte-1ycb7lo",null,_,{enlarged:p(u)}),Et(D,`width: ${p(f)??""}px; height: ${p(d)??""}px;`),Et(k,p(g)),Et(ge,p(b))}),H(m,D)};me(I,m=>{r()||m(R)})}H(t,A),mt(),s()}Kt(["mousedown","touchstart"]);var Sa=ne('<div class="landscape-hint svelte-ugg786"><div class="hint-content svelte-ugg786"><div class="rotate-icon svelte-ugg786">📱↻</div> <p class="hint-text svelte-ugg786">Rotate your phone for a better experience</p> <button class="dismiss-btn svelte-ugg786">OK</button></div></div>');function Ia(t){let e=j(!1);function n(){N(e,!0)}var r=Ar(),i=cn(r);{var s=a=>{var o=Sa(),l=Z(o),c=B(Z(l),4);c.__click=n,H(a,o)};me(i,a=>{p(e)||a(s)})}H(t,r)}Kt(["click"]);var Ea=ne('<div class="item-controls svelte-1vm8op7"><!> <!></div>'),Aa=ne('<!> <!> <!> <div class="top-left-buttons svelte-1vm8op7"><!> <!></div> <!>',1);function Da(t,e){vt(e,!1);const n=()=>ie(Hr,"$selectedItemId",s),r=()=>ie(Br,"$itemDepthLayer",s),i=()=>ie(bt,"$isBuilderZoomedOut",s),[s,a]=_n();function o(){da()}function l(){ga()}function c(){if(!n())return;const y=r()==="behind"?"front":"behind",S=Or(y);Ts(),xs(n(),S)}function u(){n()&&(Yr(n()),Gr())}Tr();var h=Aa(),f=cn(h);ya(f,{});var d=B(f,2);ba(d,{});var g=B(d,2);Ia(g);var b=B(g,2),T=Z(b);Me(T,{variant:"green",width:"100px",onclick:o,children:(y,S)=>{var w=Oe("SAVE");H(y,w)},$$slots:{default:!0}});var L=B(T,2);{let y=kt(()=>i()?"orange":"blue");Me(L,{get variant(){return p(y)},width:"80px",onclick:l,title:"Toggle zoom (F)",children:(S,w)=>{var A=Oe();$e(()=>ft(A,i()?"1:1":"FIT")),H(S,A)},$$slots:{default:!0}})}var O=B(b,2);{var v=y=>{var S=Ea(),w=Z(S);{let I=kt(()=>r()==="behind"?"blue":"orange");Me(w,{get variant(){return p(I)},title:"Toggle item depth: behind or in front of player",onclick:c,children:(R,m)=>{var D=Oe();$e(()=>ft(D,r()==="behind"?"Behind":"Front")),H(R,D)},$$slots:{default:!0}})}var A=B(w,2);Me(A,{variant:"red",title:"Delete selected item",onclick:u,children:(I,R)=>{var m=Oe("DELETE");H(I,m)},$$slots:{default:!0}}),H(y,S)};me(O,y=>{n()&&y(v)})}H(t,h),mt(),a()}var Ca=ne('<div class="touch-controls"><p class="touch-text">Tap and hold<br/>where you want<br/>to move</p></div>'),Ta=ne('<div class="desktop-controls"><div class="key-row"><div class="pixel-key">A</div> <div class="pixel-key">W</div> <div class="pixel-key">D</div></div> <p class="or-text">or</p> <div class="key-row"><div class="pixel-key">←</div> <div class="pixel-key">↑</div> <div class="pixel-key">→</div></div></div>'),xa=ne('<div class="loader-overlay"><div class="pixel-loader"></div></div>'),ka=ne('<div class="game-ui-wrapper svelte-13dvmla"><!> <!> <!> <dialog class="pixel-dialog"><h1>CONTROLS</h1> <div class="controls-content"><!></div></dialog> <!></div>');function La(t,e){vt(e,!1);const n=()=>ie(st,"$showControlsDialog",l),r=()=>ie(Lr,"$hasPlayerMoved",l),i=()=>ie(As,"$isBuilderMode",l),s=()=>ie(tn,"$currentLanguage",l),a=()=>ie(kr,"$isTouchDevice",l),o=()=>ie(nn,"$isLoading",l),[l,c]=_n();let u=hn();function h(){const _=Kr.toggleLanguage();tn.set(_)}function f(_){!p(u)?.open||_.target.closest(".pixel-button")||st.set(!1)}function d(){const _=fa();if(!_){console.error("Cannot enter builder mode: map config not found");return}ha(_)}Tn(()=>(p(u),n()),()=>{p(u)&&(n()?p(u).showModal():p(u).close())}),Tn(()=>(r(),p(u),st),()=>{r()&&p(u)?.open&&st.set(!1)}),Vi(),Tr();var g=ka();Qt("pointerdown",qn,f);var b=Z(g);{var T=_=>{Da(_,{})};me(b,_=>{i()&&_(T)})}var L=B(b,2);{var O=_=>{Me(_,{position:"top-left",variant:"green",width:"120px",onclick:d,title:"Toggle Builder Mode",children:(k,ge)=>{var re=Oe("BUILD");H(k,re)},$$slots:{default:!0}})};me(L,_=>{i()||_(O)})}var v=B(L,2);{var y=_=>{Me(_,{position:"top-right",variant:"default",width:"100px",onclick:h,title:"Toggle Language (L)",children:(k,ge)=>{var re=Oe();$e(Fe=>ft(re,Fe),[()=>(s(),Ge(()=>s().toUpperCase()))]),H(k,re)},$$slots:{default:!0}})};me(v,_=>{i()||_(y)})}var S=B(v,2),w=B(Z(S),2),A=Z(w);{var I=_=>{var k=Ca();H(_,k)},R=_=>{var k=Ta();H(_,k)};me(A,_=>{a()?_(I):_(R,!1)})}Cr(S,_=>N(u,_),()=>p(u));var m=B(S,2);{var D=_=>{var k=xa();H(_,k)};me(m,_=>{o()&&_(D)})}H(t,g),mt(),c()}const Wr=document.getElementById("game-ui");if(!Wr)throw new Error("game-ui element not found!");ns(La,{target:Wr});tn.set(Kr.getLanguage());ps.set(Mr.getSkin());vs.set(Rt.getCurrentConfig().name);const Oa={type:x.AUTO,width:800,height:600,parent:"game-container",backgroundColor:"#000000",pixelArt:!0,roundPixels:!0,scale:{mode:x.Scale.RESIZE,autoCenter:x.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{y:800,x:0},debug:!1}},audio:{noAudio:!0},scene:[$s,oa]},Xr=new x.Game(Oa);ua(Xr);const Ma=Xr.device.input.touch;kr.set(Ma);const Pa=performance.getEntriesByType("navigation")[0]&&performance.getEntriesByType("navigation")[0].type==="reload",Ra=sessionStorage.getItem("hasSeenControlsHint");(!Ra||Pa)&&(sessionStorage.setItem("hasSeenControlsHint","true"),st.set(!0));
//# sourceMappingURL=index-DN6PRUm0.js.map
