{"version":3,"file":"builder-BRoxqlO5.js","sources":["../../src/scenes/CharacterPreviewScene.ts","../../src/ui/builder/CharacterBuilder.svelte","../../src/builder.ts"],"sourcesContent":["/**\n * CharacterPreviewScene\n * \n * Phaser scene for previewing modular character customization.\n * Renders layered sprites and synchronizes animations.\n * \n * Uses unified ModularCharacterVisual for rendering.\n */\n\nimport Phaser from 'phaser';\nimport {\n  type ModularCharacterSelection,\n} from '../data/modularConfig';\nimport { preloadModularCharacter } from '../utils/ModularCharacterBuilder';\nimport { ModularCharacterVisual } from '../entities/ModularCharacterVisual';\n\nexport default class CharacterPreviewScene extends Phaser.Scene {\n  private character: ModularCharacterVisual | null = null;\n  private currentAnimName: string = 'idle';\n  private currentSelection: ModularCharacterSelection | null = null;\n  \n  constructor() {\n    super({ key: 'CharacterPreviewScene' });\n  }\n  \n  create() {\n    // Listen for resize events\n    this.scale.on('resize', this.onResize, this);\n    \n    // Emit ready event for Svelte\n    this.game.events.emit('ready');\n  }\n  \n  /**\n   * Handle resize - reposition and rescale character\n   */\n  private onResize() {\n    if (this.character) {\n      this.repositionCharacter();\n    }\n  }\n  \n  /**\n   * Calculate display scale based on canvas size\n   */\n  private getDisplayScale(): number {\n    const minDimension = Math.min(this.cameras.main.width, this.cameras.main.height);\n    // Scale to fit ~70% of the canvas height\n    return Math.max(3, Math.floor(minDimension / 64 * 0.65));\n  }\n  \n  /**\n   * Reposition and rescale character\n   */\n  private repositionCharacter() {\n    if (!this.character) return;\n\n    const centerX = this.cameras.main.width / 2;\n    // Offset up by ~10% of height to account for empty space above character's head\n    const centerY = this.cameras.main.height / 2 - (this.cameras.main.height * 0.05);\n    const scale = this.getDisplayScale();\n    \n    this.character.setPosition(centerX, centerY);\n    this.character.setScale(scale);\n  }\n  \n  /**\n   * Update character with new selection (called from Svelte)\n   */\n  public updateCharacter(selection: ModularCharacterSelection) {\n    this.currentSelection = selection;\n    \n    // Preload assets then build/update character\n    preloadModularCharacter(this, selection).then(() => {\n      this.buildOrUpdateCharacter();\n    });\n  }\n  \n  /**\n   * Build or update the visual character\n   */\n  private buildOrUpdateCharacter() {\n    if (!this.currentSelection) return;\n\n    if (this.character) {\n      this.character.updateSelection(this.currentSelection);\n    } else {\n      this.character = new ModularCharacterVisual(\n        this,\n        0, 0, // Position set by repositionCharacter\n        this.currentSelection,\n        {\n          animated: true,\n          animation: this.currentAnimName,\n          scale: this.getDisplayScale()\n        }\n      );\n    }\n\n    // Ensure correct position and animation\n    this.repositionCharacter();\n    this.character.playAnimation(this.currentAnimName);\n  }\n  \n  /**\n   * Play a specific animation (called from Svelte)\n   */\n  public playAnimation(animName: string) {\n    this.currentAnimName = animName;\n    if (this.character) {\n      this.character.playAnimation(animName);\n    }\n  }\n}\n","<script lang=\"ts\">\n  import { onMount, onDestroy } from 'svelte';\n  import Phaser from 'phaser';\n  import PixelButton from '../shared/PixelButton.svelte';\n  import {\n    type Gender,\n    type ModularCategory,\n    type ModularItem,\n    type ModularCharacterSelection,\n    type ClothingSubcategory,\n    LAYER_ORDER,\n    CLOTHING_UI_ORDER,\n    getItemsForGender,\n    getClothingBySubcategory,\n    createDefaultSelection,\n    getModularAssetPath,\n    getItemById,\n  } from '../../data/modularConfig';\n  import { getSavedCharacterSelection } from '../../data/CharacterStorage';\n  import CharacterPreviewScene from '../../scenes/CharacterPreviewScene';\n  \n  // ============================================================================\n  // State\n  // ============================================================================\n  \n  let phaserGame: Phaser.Game | null = $state(null);\n  let gameContainer: HTMLDivElement | null = $state(null);\n  \n  // Character selection state\n  let selection: ModularCharacterSelection = $state(createDefaultSelection('male'));\n  \n  // UI state\n  let activeCategory: ModularCategory = $state('skins');\n  let activeClothingSubcategory: ClothingSubcategory = $state('chest');\n  \n  // Computed items for current gender\n  let currentItems = $derived(getItemsForGender(selection.gender));\n  let currentClothingBySubcategory = $derived(getClothingBySubcategory(selection.gender));\n  \n  // ============================================================================\n  // Lifecycle\n  // ============================================================================\n  \n  onMount(() => {\n    loadSavedSelection();\n    initPhaser();\n  });\n  \n  onDestroy(() => {\n    phaserGame?.destroy(true);\n    phaserGame = null;\n  });\n  \n  // ============================================================================\n  // Phaser initialization\n  // ============================================================================\n  \n  function initPhaser() {\n    if (!gameContainer) return;\n    \n    // Get container size for responsive canvas\n    const rect = gameContainer.getBoundingClientRect();\n    const width = Math.floor(rect.width) || 400;\n    const height = Math.floor(rect.height) || 400;\n    \n    const config: Phaser.Types.Core.GameConfig = {\n      type: Phaser.AUTO,\n      width: width,\n      height: height,\n      parent: gameContainer,\n      transparent: true,\n      pixelArt: true,\n      scale: {\n        mode: Phaser.Scale.RESIZE,\n        autoCenter: Phaser.Scale.CENTER_BOTH,\n      },\n      scene: [CharacterPreviewScene],\n    };\n    \n    phaserGame = new Phaser.Game(config);\n    \n    // Pass initial selection to scene\n    phaserGame.events.once('ready', () => {\n      updatePreview();\n    });\n  }\n  \n  // ============================================================================\n  // Selection management\n  // ============================================================================\n  \n  function setGender(gender: Gender) {\n    if (selection.gender === gender) return;\n    // Reset selection for new gender\n    selection = createDefaultSelection(gender);\n    updatePreview();\n  }\n  \n  function selectSkin(item: ModularItem) {\n    selection.skin = item.id;\n    updatePreview();\n  }\n  \n  function selectHair(item: ModularItem) {\n    // Toggle off if already selected\n    selection.hair = selection.hair === item.id ? null : item.id;\n    updatePreview();\n  }\n\n  function selectClothing(item: ModularItem) {\n    // Only one item per subcategory allowed\n    // Remove any existing item from same subcategory, then add this one (or toggle off)\n    const isCurrentlySelected = selection.clothing.includes(item.id);\n    \n    // Filter out items from the same subcategory\n    const filtered = selection.clothing.filter(id => {\n      const existing = getItemById(id);\n      return existing?.subcategory !== item.subcategory;\n    });\n    \n    if (isCurrentlySelected) {\n      // Toggle off - just use filtered list\n      selection.clothing = filtered;\n    } else {\n      // Select this item\n      selection.clothing = [...filtered, item.id];\n    }\n    updatePreview();\n  }\n  \n  function getSelectedClothingForSubcategory(subcategory: ClothingSubcategory): string | null {\n    for (const id of selection.clothing) {\n      const item = getItemById(id);\n      if (item?.subcategory === subcategory) {\n        return id;\n      }\n    }\n    return null;\n  }\n  \n  function isSelected(item: ModularItem): boolean {\n    switch (item.category) {\n      case 'skins':\n        return selection.skin === item.id;\n      case 'hair':\n        return selection.hair === item.id;\n      case 'clothing':\n        return selection.clothing.includes(item.id);\n      default:\n        return false;\n    }\n  }\n  \n  function handleItemClick(item: ModularItem) {\n    switch (item.category) {\n      case 'skins':\n        selectSkin(item);\n        break;\n      case 'hair':\n        selectHair(item);\n        break;\n      case 'clothing':\n        selectClothing(item);\n        break;\n    }\n  }\n  \n  // Get preview image path for an item (first frame)\n  function getItemPreviewPath(item: ModularItem): string {\n    return getModularAssetPath(item);\n  }  // ============================================================================\n  // Preview & Persistence\n  // ============================================================================\n  \n  function updatePreview() {\n    if (!phaserGame) return;\n    const scene = phaserGame.scene.getScene('CharacterPreviewScene') as CharacterPreviewScene;\n    if (scene && scene.updateCharacter) {\n      scene.updateCharacter(selection);\n    }\n  }\n  \n  function saveSelection() {\n    localStorage.setItem('characterSelection', JSON.stringify(selection));\n  }\n  \n  function loadSavedSelection() {\n    const saved = getSavedCharacterSelection();\n    if (saved) {\n      selection = saved;\n    }\n  }\n  \n  function handleSaveAndPlay() {\n    saveSelection();\n    // Mark that we want to use the modular player\n    localStorage.setItem('useModularPlayer', 'true');\n    // Navigate back to character/background selection\n    window.location.href = '/';\n  }\n  \n  // ============================================================================\n  // Animation controls\n  // ============================================================================\n  \n  let currentAnimation = $state('idle');\n  const animations = ['idle', 'run'];\n  \n  function playAnimation(animName: string) {\n    currentAnimation = animName;\n    if (!phaserGame) return;\n    const scene = phaserGame.scene.getScene('CharacterPreviewScene') as CharacterPreviewScene;\n    if (scene && scene.playAnimation) {\n      scene.playAnimation(animName);\n    }\n  }\n</script>\n\n<div class=\"character-builder\">\n  <!-- Header -->\n  <header class=\"header\">\n    <h1>Character Builder</h1>\n    <PixelButton variant=\"green\" onclick={handleSaveAndPlay}>\n      SAVE & PLAY\n    </PixelButton>\n  </header>\n  \n  <div class=\"main-content\">\n    <!-- Preview section (always visible, on top on mobile) -->\n    <div class=\"preview-section\">\n      <div class=\"preview-container\" bind:this={gameContainer}></div>\n      \n      <!-- Animation buttons -->\n      <div class=\"animation-controls\">\n        {#each animations as anim}\n          <button \n            class=\"anim-btn\"\n            class:active={currentAnimation === anim}\n            onclick={() => playAnimation(anim)}\n          >\n            {anim}\n          </button>\n        {/each}\n      </div>\n    </div>\n    \n    <!-- Selection panel -->\n    <div class=\"selection-panel\">\n      <!-- Gender toggle -->\n        <div class=\"gender-toggle\">\n          <button \n            class=\"gender-btn\"\n            class:active={selection.gender === 'male'}\n            onclick={() => setGender('male')}\n          >\n            Male\n          </button>\n          <button \n            class=\"gender-btn\"\n            class:active={selection.gender === 'female'}\n            onclick={() => setGender('female')}\n          >\n            Female\n          </button>\n        </div>\n        \n        <!-- Category tabs -->\n        <div class=\"category-tabs\">\n          {#each LAYER_ORDER as category}\n            <button \n              class=\"category-tab\"\n              class:active={activeCategory === category}\n              onclick={() => activeCategory = category}\n            >\n              {category}\n            </button>\n          {/each}\n        </div>\n        \n        <!-- Clothing subcategory tabs (only shown when clothing is active) -->\n        {#if activeCategory === 'clothing'}\n          <div class=\"subcategory-tabs\">\n            {#each CLOTHING_UI_ORDER as subcategory}\n              <button \n                class=\"subcategory-tab\"\n                class:active={activeClothingSubcategory === subcategory}\n                onclick={() => activeClothingSubcategory = subcategory}\n              >\n                {subcategory}\n              </button>\n            {/each}\n          </div>\n        {/if}\n        \n        <!-- Items grid -->\n        <div class=\"items-grid\">\n          {#if activeCategory === 'clothing'}\n            {#each currentClothingBySubcategory[activeClothingSubcategory] as item}\n              <button \n                class=\"item-btn\"\n                class:selected={isSelected(item)}\n                onclick={() => handleItemClick(item)}\n                title={item.name}\n              >\n                <div class=\"item-preview\">\n                  <img src={getItemPreviewPath(item)} alt={item.name} class=\"preview-img\" />\n                </div>\n                <span class=\"item-name\">{item.name}</span>\n              </button>\n            {/each}\n          {:else}\n            {#each currentItems[activeCategory] as item}\n              <button \n                class=\"item-btn\"\n                class:selected={isSelected(item)}\n                onclick={() => handleItemClick(item)}\n                title={item.name}\n              >\n                <div class=\"item-preview\">\n                  <img src={getItemPreviewPath(item)} alt={item.name} class=\"preview-img\" />\n                </div>\n                <span class=\"item-name\">{item.name}</span>\n              </button>\n            {/each}\n          {/if}\n        </div>\n    </div>\n  </div>\n</div>\n\n<style>\n  .character-builder {\n    width: 100vw;\n    height: 100vh;\n    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n    color: white;\n    font-family: 'Press Start 2P', monospace;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n  }\n  \n  .header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 15px 20px;\n    background: rgba(0, 0, 0, 0.3);\n    border-bottom: 3px solid #333;\n    flex-shrink: 0;\n  }\n  \n  .header h1 {\n    font-size: 16px;\n    margin: 0;\n    text-shadow: 2px 2px 0 #000;\n  }\n  \n  .main-content {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n    padding: 15px;\n    overflow-y: auto;\n    overflow-x: hidden;\n  }\n  \n  /* Selection panel (now on top) */\n  .selection-panel {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    flex-shrink: 0;\n  }\n  \n  .gender-toggle {\n    display: flex;\n    gap: 10px;\n  }\n  \n  .gender-btn {\n    flex: 1;\n    padding: 12px;\n    background: #2a2a4a;\n    border: 3px solid #444;\n    color: #aaa;\n    font-family: inherit;\n    font-size: 11px;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n  \n  .gender-btn:hover {\n    background: #3a3a5a;\n    color: white;\n  }\n  \n  .gender-btn.active {\n    background: #9b59b6;\n    border-color: #8e44ad;\n    color: white;\n  }\n  \n  .category-tabs {\n    display: flex;\n    gap: 8px;\n  }\n  \n  .category-tab {\n    flex: 1;\n    padding: 10px 8px;\n    background: #2a2a4a;\n    border: 2px solid #444;\n    color: #aaa;\n    font-family: inherit;\n    font-size: 10px;\n    text-transform: uppercase;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n  \n  .category-tab:hover {\n    background: #3a3a5a;\n    color: white;\n  }\n  \n  .category-tab.active {\n    background: #27ae60;\n    border-color: #229954;\n    color: white;\n  }\n  \n  .subcategory-tabs {\n    display: flex;\n    gap: 6px;\n    flex-wrap: wrap;\n  }\n  \n  .subcategory-tab {\n    flex: 1;\n    padding: 8px 6px;\n    background: #1a1a3a;\n    border: 2px solid #383858;\n    color: #888;\n    font-family: inherit;\n    font-size: 9px;\n    text-transform: uppercase;\n    cursor: pointer;\n    transition: all 0.15s ease;\n    min-width: 55px;\n    max-width: 80px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  \n  .subcategory-tab:hover {\n    background: #2a2a4a;\n    color: #bbb;\n  }\n  \n  .subcategory-tab.active {\n    background: #e67e22;\n    border-color: #d35400;\n    color: white;\n  }\n\n  .items-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));\n    gap: 8px;\n    padding: 8px;\n    background: rgba(0, 0, 0, 0.2);\n    border: 2px solid #333;\n    border-radius: 4px;\n    max-height: 280px;\n    overflow-y: auto;\n    align-content: start;\n  }\n  \n  .item-btn {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 4px;\n    padding: 4px;\n    background: #2a2a4a;\n    border: 2px solid #444;\n    color: #ccc;\n    font-family: inherit;\n    font-size: 7px;\n    text-align: center;\n    cursor: pointer;\n    transition: all 0.15s ease;\n    height: fit-content;\n  }\n  \n  .item-btn:hover {\n    background: #3a3a5a;\n    border-color: #555;\n    color: white;\n  }\n  \n  .item-btn.selected {\n    background: #3498db;\n    border-color: #2980b9;\n    color: white;\n  }\n  \n  .item-preview {\n    width: 80px;\n    height: 64px;\n    overflow: hidden;\n    display: flex;\n    align-items: flex-start;\n    justify-content: flex-start;\n    image-rendering: pixelated;\n  }\n  \n  .preview-img {\n    width: 800px;\n    height: 448px;\n    object-fit: none;\n    object-position: 0 0;\n    transform: scale(1);\n    transform-origin: top left;\n    image-rendering: pixelated;\n  }\n  \n  .item-name {\n    word-break: break-word;\n    line-height: 1.3;\n    max-width: 100%;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: normal;\n  }\n\n  /* Preview section */\n  .preview-section {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    flex-shrink: 0;\n  }\n  \n  .preview-container {\n    height: 200px;\n    background: \n      linear-gradient(to right, #2a2a4a 1px, transparent 1px),\n      linear-gradient(to bottom, #2a2a4a 1px, transparent 1px),\n      #1a1a2e;\n    background-size: 16px 16px;\n    border: 4px solid #333;\n    border-radius: 4px;\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  \n  .animation-controls {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px;\n  }\n  \n  .anim-btn {\n    padding: 6px 10px;\n    background: #2a2a4a;\n    border: 2px solid #444;\n    color: #aaa;\n    font-family: inherit;\n    font-size: 9px;\n    text-transform: uppercase;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n  \n  .anim-btn:hover {\n    background: #3a3a5a;\n    color: white;\n  }\n  \n  .anim-btn.active {\n    background: #4a90e2;\n    border-color: #357abd;\n    color: white;\n  }\n  \n  /* Scrollbar styling */\n  .items-grid::-webkit-scrollbar,\n  .main-content::-webkit-scrollbar {\n    width: 8px;\n  }\n  \n  .items-grid::-webkit-scrollbar-track,\n  .main-content::-webkit-scrollbar-track {\n    background: #1a1a2e;\n  }\n  \n  .items-grid::-webkit-scrollbar-thumb,\n  .main-content::-webkit-scrollbar-thumb {\n    background: #444;\n    border-radius: 4px;\n  }\n  \n  .items-grid::-webkit-scrollbar-thumb:hover,\n  .main-content::-webkit-scrollbar-thumb:hover {\n    background: #555;\n  }\n  \n  /* Desktop: side by side layout */\n  @media (min-width: 900px) {\n    .main-content {\n      flex-direction: row;\n      overflow: hidden;\n    }\n    \n    .selection-panel {\n      flex: 1;\n      max-width: 550px;\n      overflow-y: auto;\n    }\n    \n    .items-grid {\n      flex: 1;\n      max-height: none;\n    }\n    \n    .preview-section {\n      width: 300px;\n      flex-shrink: 0;\n    }\n    \n    .preview-container {\n      flex: 1;\n      height: auto;\n      min-height: 200px;\n    }\n    \n    .selection-toggle {\n      display: none !important;\n    }\n  }\n  \n  /* Mobile */\n  @media (max-width: 899px) {\n    .header h1 {\n      font-size: 12px;\n    }\n    \n    .items-grid {\n      max-height: 200px;\n    }\n  }\n  \n  /* Very small screens */\n  @media (max-width: 500px) {\n    .items-grid {\n      grid-template-columns: repeat(auto-fill, minmax(85px, 1fr));\n    }\n    \n    .item-preview {\n      width: 64px;\n      height: 52px;\n    }\n    \n    .preview-img {\n      transform: scale(0.8);\n    }\n    \n    .subcategory-tab {\n      min-width: 45px;\n      font-size: 8px;\n      padding: 6px 4px;\n    }\n  }\n</style>\n","/**\n * Builder Entry Point\n * \n * Separate page for the modular character builder.\n */\n\nimport { mount } from 'svelte';\nimport CharacterBuilder from './ui/builder/CharacterBuilder.svelte';\n\n// Wait for DOM to be ready\nconst builderRoot = document.getElementById('builder-root');\n\nif (!builderRoot) {\n  throw new Error('builder-root element not found!');\n}\n\n// Mount the CharacterBuilder component\nmount(CharacterBuilder, {\n  target: builderRoot,\n});\n"],"names":["CharacterPreviewScene","Phaser","minDimension","centerX","centerY","scale","selection","preloadModularCharacter","ModularCharacterVisual","animName","phaserGame","gameContainer","$.state","$.proxy","createDefaultSelection","activeCategory","activeClothingSubcategory","currentItems","$.derived","getItemsForGender","$.get","currentClothingBySubcategory","getClothingBySubcategory","onMount","loadSavedSelection","initPhaser","onDestroy","$.set","rect","width","height","config","updatePreview","setGender","gender","selectSkin","item","selectHair","selectClothing","isCurrentlySelected","filtered","id","getItemById","isSelected","handleItemClick","getItemPreviewPath","getModularAssetPath","scene","saveSelection","saved","getSavedCharacterSelection","handleSaveAndPlay","currentAnimation","animations","playAnimation","$.bind_this","div_3","$$value","$.each","div_4","anim","button","classes","$.set_class","button_1","button_2","div_7","LAYER_ORDER","category","button_3","classes_3","div_8","CLOTHING_UI_ORDER","subcategory","button_4","$$render","consequent","$.index","$$anchor","button_5","$.set_attribute","img","$.set_text","text_4","button_6","img_1","text_5","consequent_1","alternate","builderRoot","mount","CharacterBuilder"],"mappings":"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"}